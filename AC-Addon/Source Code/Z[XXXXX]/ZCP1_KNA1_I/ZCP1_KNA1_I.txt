REPORT ZAL_ABAP message-id 26 line-size 255
no standard page heading.
* ZCP1_KNA1_I.
PARAMETER DOWNLOAD(1) DEFAULT 'S' lower case. "N-svr,Y-clnt
PARAMETER EXECMODE(1) DEFAULT 'B' lower case. "D-dlg,B-btch
PARAMETER OUT_DIR(48) DEFAULT "output file dir
'/var/load/CQ1/UK/read' lower case.
PARAMETER IN_DIR(48) DEFAULT "input file dir
'/var/load/CQ1/UK/read' lower case.
PARAMETER P_DEST TYPE RFCDES-RFCDEST DEFAULT
'NONE'.
PARAMETER P_PROGID TYPE RFCOPT-RFCEXEC DEFAULT
SPACE.
PARAMETER P_GWHOST TYPE RFCOPT-RFCGWHOST DEFAULT
SPACE.
PARAMETER P_GWSERV TYPE RFCOPT-RFCGWSERV DEFAULT
SPACE.
PARAMETER P_SRVFM(30) DEFAULT "Server Callback function
SPACE.
PARAMETER P_PKGSZ TYPE I DEFAULT "Stream package size
5000.
PARAMETER P_SNC_ON(1) DEFAULT "X-on SPACE-off
SPACE.

PARAMETER P_DF_VK(40) DEFAULT "ABAP data flow object key
'' lower case.
PARAMETER P_DI_GEN(40) DEFAULT "DI version that generated ABAP
'' lower case.

*** Machine generated ABAP. Do not modify.            ***
*** (C)Copyright Business Objects S.A.  All rights reserved. ***
*
* Date Time:
*    04/25/16 06:55:06
* SAP used for generated this ABAP:
*    Release: 701
*    Host   : 10.25.3.82
*
* ABAP Dataflow Name:
*    DF_R3_CTS_LZ_SAP_CP1_KNA1_D_IM23351
* ABAP program name in SAP:
*  ZCP1_KNA1_I
* Generated ABAP file name:
*    //AIRSBEAP0512/D$/Data/SAPLogistics/VAL/ABAP/ZCP1_KNA1_I
TABLES KNA1.
TABLES CDHDR.
TABLES ADRC.

DATA: begin of ITAB3 occurs 0,
MANDT(3) TYPE C,
KUNNR(10) TYPE C,
LAND1(3) TYPE C,
NAME1(35) TYPE C,
NAME2(35) TYPE C,
ORT01(35) TYPE C,
PSTLZ(10) TYPE C,
REGIO(3) TYPE C,
SORTL(10) TYPE C,
STRAS(35) TYPE C,
TELF1(16) TYPE C,
TELFX(31) TYPE C,
XCPDK(1) TYPE C,
ADRNR(10) TYPE C,
MCOD1(25) TYPE C,
MCOD2(25) TYPE C,
MCOD3(25) TYPE C,
ANRED(15) TYPE C,
AUFSD(2) TYPE C,
BAHNE(25) TYPE C,
BAHNS(25) TYPE C,
BBBNR(7) TYPE N,
BBSNR(5) TYPE N,
BEGRU(4) TYPE C,
BRSCH(4) TYPE C,
BUBKZ(1) TYPE N,
DATLT(14) TYPE C,
ERDAT TYPE D,
ERNAM(12) TYPE C,
EXABL(1) TYPE C,
FAKSD(2) TYPE C,
FISKN(10) TYPE C,
KNAZK(2) TYPE C,
KNRZA(10) TYPE C,
KONZS(10) TYPE C,
KTOKD(4) TYPE C,
KUKLA(2) TYPE C,
LIFNR(10) TYPE C,
LIFSD(2) TYPE C,
LOCCO(10) TYPE C,
LOEVM(1) TYPE C,
NAME3(35) TYPE C,
NAME4(35) TYPE C,
NIELS(2) TYPE C,
ORT02(35) TYPE C,
PFACH(10) TYPE C,
PSTL2(10) TYPE C,
COUNC(3) TYPE C,
CITYC(4) TYPE C,
RPMKR(5) TYPE C,
SPERR(1) TYPE C,
SPRAS(1) TYPE C,
STCD1(16) TYPE C,
STCD2(11) TYPE C,
STKZA(1) TYPE C,
STKZU(1) TYPE C,
TELBX(15) TYPE C,
TELF2(16) TYPE C,
TELTX(30) TYPE C,
TELX1(30) TYPE C,
LZONE(10) TYPE C,
XZEMP(1) TYPE C,
VBUND(6) TYPE C,
STCEG(20) TYPE C,
DEAR1(1) TYPE C,
DEAR2(1) TYPE C,
DEAR3(1) TYPE C,
DEAR4(1) TYPE C,
DEAR5(1) TYPE C,
GFORM(2) TYPE C,
BRAN1(10) TYPE C,
BRAN2(10) TYPE C,
BRAN3(10) TYPE C,
BRAN4(10) TYPE C,
BRAN5(10) TYPE C,
EKONT(10) TYPE C,
UMSAT(16) TYPE P DECIMALS 2,
UMJAH(4) TYPE N,
UWAER(5) TYPE C,
JMZAH(6) TYPE N,
JMJAH(4) TYPE N,
KATR1(2) TYPE C,
KATR2(2) TYPE C,
KATR3(2) TYPE C,
KATR4(2) TYPE C,
KATR5(2) TYPE C,
KATR6(3) TYPE C,
KATR7(3) TYPE C,
KATR8(3) TYPE C,
KATR9(3) TYPE C,
KATR10(3) TYPE C,
STKZN(1) TYPE C,
UMSA1(16) TYPE P DECIMALS 2,
TXJCD(15) TYPE C,
PERIV(2) TYPE C,
ABRVW(3) TYPE C,
INSPBYDEBI(1) TYPE C,
INSPATDEBI(1) TYPE C,
KTOCD(4) TYPE C,
PFORT(35) TYPE C,
WERKS(4) TYPE C,
DTAMS(1) TYPE C,
DTAWS(2) TYPE C,
DUEFL(1) TYPE C,
HZUOR(2) TYPE N,
SPERZ(1) TYPE C,
ETIKG(10) TYPE C,
CIVVE(1) TYPE C,
MILVE(1) TYPE C,
KDKG1(2) TYPE C,
KDKG2(2) TYPE C,
KDKG3(2) TYPE C,
KDKG4(2) TYPE C,
KDKG5(2) TYPE C,
XKNZA(1) TYPE C,
FITYP(2) TYPE C,
STCDT(2) TYPE C,
STCD3(18) TYPE C,
STCD4(18) TYPE C,
XICMS(1) TYPE C,
XXIPI(1) TYPE C,
XSUBT(3) TYPE C,
CFOPC(2) TYPE C,
TXLW1(3) TYPE C,
TXLW2(3) TYPE C,
CCC01(1) TYPE C,
CCC02(1) TYPE C,
CCC03(1) TYPE C,
CCC04(1) TYPE C,
CASSD(2) TYPE C,
KNURL(132) TYPE C,
J_1KFREPRE(10) TYPE C,
J_1KFTBUS(30) TYPE C,
J_1KFTIND(30) TYPE C,
CONFS(1) TYPE C,
UPDAT TYPE D,
UPTIM(24) TYPE C,
NODEL(1) TYPE C,
DEAR6(1) TYPE C,
/VSO/R_PALHGT(16) TYPE P DECIMALS 3,
/VSO/R_PAL_UL(3) TYPE C,
/VSO/R_PK_MAT(1) TYPE C,
/VSO/R_MATPAL(18) TYPE C,
/VSO/R_I_NO_LYR(2) TYPE N,
/VSO/R_ONE_MAT(1) TYPE C,
/VSO/R_ONE_SORT(1) TYPE C,
/VSO/R_ULD_SIDE(1) TYPE N,
/VSO/R_LOAD_PREF(1) TYPE N,
/VSO/R_DPOINT(10) TYPE C,
ALC(8) TYPE C,
PMT_OFFICE(5) TYPE C,
PSOFG(10) TYPE C,
PSOIS(20) TYPE C,
PSON1(35) TYPE C,
PSON2(35) TYPE C,
PSON3(35) TYPE C,
PSOVN(35) TYPE C,
PSOTL(20) TYPE C,
PSOHS(6) TYPE C,
PSOST(28) TYPE C,
PSOO1(50) TYPE C,
PSOO2(50) TYPE C,
PSOO3(50) TYPE C,
PSOO4(50) TYPE C,
PSOO5(50) TYPE C,
CHANGE_IND(1) TYPE C,
UDATE TYPE D,
UTIME(24) TYPE C.
DATA: end of ITAB3.

DATA: begin of ITAB5 occurs 0,
MANDT(3) TYPE C,
KUNNR(10) TYPE C,
LAND1(3) TYPE C,
NAME1(35) TYPE C,
NAME2(35) TYPE C,
ORT01(35) TYPE C,
PSTLZ(10) TYPE C,
REGIO(3) TYPE C,
SORTL(10) TYPE C,
STRAS(35) TYPE C,
TELF1(16) TYPE C,
TELFX(31) TYPE C,
XCPDK(1) TYPE C,
ADRNR(10) TYPE C,
MCOD1(25) TYPE C,
MCOD2(25) TYPE C,
MCOD3(25) TYPE C,
ANRED(15) TYPE C,
AUFSD(2) TYPE C,
BAHNE(25) TYPE C,
BAHNS(25) TYPE C,
BBBNR(7) TYPE N,
BBSNR(5) TYPE N,
BEGRU(4) TYPE C,
BRSCH(4) TYPE C,
BUBKZ(1) TYPE N,
DATLT(14) TYPE C,
ERDAT TYPE D,
ERNAM(12) TYPE C,
EXABL(1) TYPE C,
FAKSD(2) TYPE C,
FISKN(10) TYPE C,
KNAZK(2) TYPE C,
KNRZA(10) TYPE C,
KONZS(10) TYPE C,
KTOKD(4) TYPE C,
KUKLA(2) TYPE C,
LIFNR(10) TYPE C,
LIFSD(2) TYPE C,
LOCCO(10) TYPE C,
LOEVM(1) TYPE C,
NAME3(35) TYPE C,
NAME4(35) TYPE C,
NIELS(2) TYPE C,
ORT02(35) TYPE C,
PFACH(10) TYPE C,
PSTL2(10) TYPE C,
COUNC(3) TYPE C,
CITYC(4) TYPE C,
RPMKR(5) TYPE C,
SPERR(1) TYPE C,
SPRAS(1) TYPE C,
STCD1(16) TYPE C,
STCD2(11) TYPE C,
STKZA(1) TYPE C,
STKZU(1) TYPE C,
TELBX(15) TYPE C,
TELF2(16) TYPE C,
TELTX(30) TYPE C,
TELX1(30) TYPE C,
LZONE(10) TYPE C,
XZEMP(1) TYPE C,
VBUND(6) TYPE C,
STCEG(20) TYPE C,
DEAR1(1) TYPE C,
DEAR2(1) TYPE C,
DEAR3(1) TYPE C,
DEAR4(1) TYPE C,
DEAR5(1) TYPE C,
GFORM(2) TYPE C,
BRAN1(10) TYPE C,
BRAN2(10) TYPE C,
BRAN3(10) TYPE C,
BRAN4(10) TYPE C,
BRAN5(10) TYPE C,
EKONT(10) TYPE C,
UMSAT(16) TYPE P DECIMALS 2,
UMJAH(4) TYPE N,
UWAER(5) TYPE C,
JMZAH(6) TYPE N,
JMJAH(4) TYPE N,
KATR1(2) TYPE C,
KATR2(2) TYPE C,
KATR3(2) TYPE C,
KATR4(2) TYPE C,
KATR5(2) TYPE C,
KATR6(3) TYPE C,
KATR7(3) TYPE C,
KATR8(3) TYPE C,
KATR9(3) TYPE C,
KATR10(3) TYPE C,
STKZN(1) TYPE C,
UMSA1(16) TYPE P DECIMALS 2,
TXJCD(15) TYPE C,
PERIV(2) TYPE C,
ABRVW(3) TYPE C,
INSPBYDEBI(1) TYPE C,
INSPATDEBI(1) TYPE C,
KTOCD(4) TYPE C,
PFORT(35) TYPE C,
WERKS(4) TYPE C,
DTAMS(1) TYPE C,
DTAWS(2) TYPE C,
DUEFL(1) TYPE C,
HZUOR(2) TYPE N,
SPERZ(1) TYPE C,
ETIKG(10) TYPE C,
CIVVE(1) TYPE C,
MILVE(1) TYPE C,
KDKG1(2) TYPE C,
KDKG2(2) TYPE C,
KDKG3(2) TYPE C,
KDKG4(2) TYPE C,
KDKG5(2) TYPE C,
XKNZA(1) TYPE C,
FITYP(2) TYPE C,
STCDT(2) TYPE C,
STCD3(18) TYPE C,
STCD4(18) TYPE C,
XICMS(1) TYPE C,
XXIPI(1) TYPE C,
XSUBT(3) TYPE C,
CFOPC(2) TYPE C,
TXLW1(3) TYPE C,
TXLW2(3) TYPE C,
CCC01(1) TYPE C,
CCC02(1) TYPE C,
CCC03(1) TYPE C,
CCC04(1) TYPE C,
CASSD(2) TYPE C,
KNURL(132) TYPE C,
J_1KFREPRE(10) TYPE C,
J_1KFTBUS(30) TYPE C,
J_1KFTIND(30) TYPE C,
CONFS(1) TYPE C,
UPDAT TYPE D,
UPTIM(24) TYPE C,
NODEL(1) TYPE C,
DEAR6(1) TYPE C,
/VSO/R_PALHGT(16) TYPE P DECIMALS 3,
/VSO/R_PAL_UL(3) TYPE C,
/VSO/R_PK_MAT(1) TYPE C,
/VSO/R_MATPAL(18) TYPE C,
/VSO/R_I_NO_LYR(2) TYPE N,
/VSO/R_ONE_MAT(1) TYPE C,
/VSO/R_ONE_SORT(1) TYPE C,
/VSO/R_ULD_SIDE(1) TYPE N,
/VSO/R_LOAD_PREF(1) TYPE N,
/VSO/R_DPOINT(10) TYPE C,
ALC(8) TYPE C,
PMT_OFFICE(5) TYPE C,
PSOFG(10) TYPE C,
PSOIS(20) TYPE C,
PSON1(35) TYPE C,
PSON2(35) TYPE C,
PSON3(35) TYPE C,
PSOVN(35) TYPE C,
PSOTL(20) TYPE C,
PSOHS(6) TYPE C,
PSOST(28) TYPE C,
PSOO1(50) TYPE C,
PSOO2(50) TYPE C,
PSOO3(50) TYPE C,
PSOO4(50) TYPE C,
PSOO5(50) TYPE C,
CHANGE_IND(1) TYPE C,
UDATE TYPE D,
UTIME(24) TYPE C,
SORT1(20) TYPE C,
SORT2(20) TYPE C.
DATA: end of ITAB5.

data: append_flag(1) value ' ',
      cntbuf type i,
      delimleng type i,last_batch(1) value ' '.

CONSTANTS C_DF_VK(40) VALUE '3489'.
CONSTANTS C_DI_GEN(40) VALUE '14.2.3.660'.
DATA WARN_MSG(50).


DATA: gv_directory     TYPE epsdirnam  VALUE '/var/load/xxx/UK/read/',
      gv_logsys        LIKE tbdlst-logsys.

start-of-selection.
* Logical system
  CALL FUNCTION 'OWN_LOGICAL_SYSTEM_GET'
    IMPORTING
      own_logical_system             = gv_logsys
    EXCEPTIONS
      own_logical_system_not_defined = 1
      OTHERS                         = 2.
  IF sy-subrc <> 0.
    MESSAGE ID sy-msgid TYPE 'E' NUMBER sy-msgno
         WITH sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4.
    STOP.
  ENDIF.
  REPLACE 'xxx' IN out_dir WITH gv_logsys(3).
  REPLACE 'xxx' IN in_dir WITH gv_logsys(3).


  IF DOWNLOAD = 'S' OR
     DOWNLOAD = 'N' OR
     DOWNLOAD = 'Y'.
      .
  ELSE.
     DATA: m_xfer_err_msg(700).
     CONCATENATE
'ABAP program does not recognize this new '
'data transfer method: ' DOWNLOAD
'. Regenerate the ABAP program and upload to this system.'
     INTO m_xfer_err_msg.
     MESSAGE  E240(S#) WITH m_xfer_err_msg.
  ENDIF.

  IF EXECMODE = 'B' OR
     EXECMODE = 'D'.
      .
  ELSE.
     DATA: m_exec_err_msg(700).
     CONCATENATE
'ABAP program does not recognize this new '
'execution option: ' EXECMODE
'. Regenerate the ABAP program and upload to this system.'
     INTO m_exec_err_msg.
     MESSAGE  E240(S#) WITH m_exec_err_msg.
  ENDIF.

  IF DOWNLOAD = 'S'.
     PERFORM CONNECT_RFCDEST_TO_PROGID.
  ENDIF.



PERFORM FORM3.
PERFORM FORM5.
FREE ITAB3.
last_batch = 'X'.
PERFORM FORM6.
FREE ITAB5.
  IF DOWNLOAD = 'S'.
     PERFORM DISCONNECT_RFCDEST_FROM_PROGID.
  ENDIF.


end-of-selection.

CLEAR WARN_MSG.

IF NOT P_DF_VK IS INITIAL.
  IF P_DF_VK <> C_DF_VK.
     CONCATENATE '$$Warning$'
                 C_DF_VK
                 '$' INTO WARN_MSG.
  ENDIF.
ENDIF.
IF NOT P_DI_GEN IS INITIAL.
  IF P_DI_GEN <> C_DI_GEN.
     IF WARN_MSG IS INITIAL.
       CONCATENATE '$$Warning$$'
                   C_DI_GEN
                   INTO WARN_MSG.
     ELSE.
       CONCATENATE WARN_MSG
                   C_DI_GEN
                   INTO WARN_MSG.
     ENDIF.
  ENDIF.
ENDIF.

IF NOT WARN_MSG IS INITIAL.
  IF EXECMODE = 'D'.
    WRITE WARN_MSG.
    NEW-LINE.
  ELSE.
    MESSAGE S240(S#) with WARN_MSG.
  ENDIF.
ENDIF.


write  '* Program Complete *'.
write  '(C)Copyright Business Objects S.A.  All rights reserved.'.

FORM FORM3.
STATICS rowCount TYPE i VALUE 0.
DATA ALTMP339(3) TYPE C.
DATA ALTMP340(10) TYPE C.
DATA ALTMP341(3) TYPE C.
DATA ALTMP342(35) TYPE C.
DATA ALTMP343(35) TYPE C.
DATA ALTMP344(35) TYPE C.
DATA ALTMP345(10) TYPE C.
DATA ALTMP346(3) TYPE C.
DATA ALTMP347(10) TYPE C.
DATA ALTMP348(35) TYPE C.
DATA ALTMP349(16) TYPE C.
DATA ALTMP350(31) TYPE C.
DATA ALTMP351(1) TYPE C.
DATA ALTMP352(10) TYPE C.
DATA ALTMP353(25) TYPE C.
DATA ALTMP354(25) TYPE C.
DATA ALTMP355(25) TYPE C.
DATA ALTMP356(15) TYPE C.
DATA ALTMP357(2) TYPE C.
DATA ALTMP358(25) TYPE C.
DATA ALTMP359(25) TYPE C.
DATA ALTMP360(7) TYPE N.
DATA ALTMP361(5) TYPE N.
DATA ALTMP362(4) TYPE C.
DATA ALTMP363(4) TYPE C.
DATA ALTMP364(1) TYPE N.
DATA ALTMP365(14) TYPE C.
DATA ALTMP366 TYPE D.
DATA ALTMP367(12) TYPE C.
DATA ALTMP368(1) TYPE C.
DATA ALTMP369(2) TYPE C.
DATA ALTMP370(10) TYPE C.
DATA ALTMP371(2) TYPE C.
DATA ALTMP372(10) TYPE C.
DATA ALTMP373(10) TYPE C.
DATA ALTMP374(4) TYPE C.
DATA ALTMP375(2) TYPE C.
DATA ALTMP376(10) TYPE C.
DATA ALTMP377(2) TYPE C.
DATA ALTMP378(10) TYPE C.
DATA ALTMP379(1) TYPE C.
DATA ALTMP380(35) TYPE C.
DATA ALTMP381(35) TYPE C.
DATA ALTMP382(2) TYPE C.
DATA ALTMP383(35) TYPE C.
DATA ALTMP384(10) TYPE C.
DATA ALTMP385(10) TYPE C.
DATA ALTMP386(3) TYPE C.
DATA ALTMP387(4) TYPE C.
DATA ALTMP388(5) TYPE C.
DATA ALTMP389(1) TYPE C.
DATA ALTMP390(1) TYPE C.
DATA ALTMP391(16) TYPE C.
DATA ALTMP392(11) TYPE C.
DATA ALTMP393(1) TYPE C.
DATA ALTMP394(1) TYPE C.
DATA ALTMP395(15) TYPE C.
DATA ALTMP396(16) TYPE C.
DATA ALTMP397(30) TYPE C.
DATA ALTMP398(30) TYPE C.
DATA ALTMP399(10) TYPE C.
DATA ALTMP400(1) TYPE C.
DATA ALTMP401(6) TYPE C.
DATA ALTMP402(20) TYPE C.
DATA ALTMP403(1) TYPE C.
DATA ALTMP404(1) TYPE C.
DATA ALTMP405(1) TYPE C.
DATA ALTMP406(1) TYPE C.
DATA ALTMP407(1) TYPE C.
DATA ALTMP408(2) TYPE C.
DATA ALTMP409(10) TYPE C.
DATA ALTMP410(10) TYPE C.
DATA ALTMP411(10) TYPE C.
DATA ALTMP412(10) TYPE C.
DATA ALTMP413(10) TYPE C.
DATA ALTMP414(10) TYPE C.
DATA ALTMP415(16) TYPE P DECIMALS 2.
DATA ALTMP416(4) TYPE N.
DATA ALTMP417(5) TYPE C.
DATA ALTMP418(6) TYPE N.
DATA ALTMP419(4) TYPE N.
DATA ALTMP420(2) TYPE C.
DATA ALTMP421(2) TYPE C.
DATA ALTMP422(2) TYPE C.
DATA ALTMP423(2) TYPE C.
DATA ALTMP424(2) TYPE C.
DATA ALTMP425(3) TYPE C.
DATA ALTMP426(3) TYPE C.
DATA ALTMP427(3) TYPE C.
DATA ALTMP428(3) TYPE C.
DATA ALTMP429(3) TYPE C.
DATA ALTMP430(1) TYPE C.
DATA ALTMP431(16) TYPE P DECIMALS 2.
DATA ALTMP432(15) TYPE C.
DATA ALTMP433(2) TYPE C.
DATA ALTMP434(3) TYPE C.
DATA ALTMP435(1) TYPE C.
DATA ALTMP436(1) TYPE C.
DATA ALTMP437(4) TYPE C.
DATA ALTMP438(35) TYPE C.
DATA ALTMP439(4) TYPE C.
DATA ALTMP440(1) TYPE C.
DATA ALTMP441(2) TYPE C.
DATA ALTMP442(1) TYPE C.
DATA ALTMP443(2) TYPE N.
DATA ALTMP444(1) TYPE C.
DATA ALTMP445(10) TYPE C.
DATA ALTMP446(1) TYPE C.
DATA ALTMP447(1) TYPE C.
DATA ALTMP448(2) TYPE C.
DATA ALTMP449(2) TYPE C.
DATA ALTMP450(2) TYPE C.
DATA ALTMP451(2) TYPE C.
DATA ALTMP452(2) TYPE C.
DATA ALTMP453(1) TYPE C.
DATA ALTMP454(2) TYPE C.
DATA ALTMP455(2) TYPE C.
DATA ALTMP456(18) TYPE C.
DATA ALTMP457(18) TYPE C.
DATA ALTMP458(1) TYPE C.
DATA ALTMP459(1) TYPE C.
DATA ALTMP460(3) TYPE C.
DATA ALTMP461(2) TYPE C.
DATA ALTMP462(3) TYPE C.
DATA ALTMP463(3) TYPE C.
DATA ALTMP464(1) TYPE C.
DATA ALTMP465(1) TYPE C.
DATA ALTMP466(1) TYPE C.
DATA ALTMP467(1) TYPE C.
DATA ALTMP468(2) TYPE C.
DATA ALTMP469(132) TYPE C.
DATA ALTMP470(10) TYPE C.
DATA ALTMP471(30) TYPE C.
DATA ALTMP472(30) TYPE C.
DATA ALTMP473(1) TYPE C.
DATA ALTMP474 TYPE D.
DATA ALTMP475 TYPE T.
DATA ALTMP476(1) TYPE C.
DATA ALTMP477(1) TYPE C.
DATA ALTMP478(16) TYPE P DECIMALS 3.
DATA ALTMP479(3) TYPE C.
DATA ALTMP480(1) TYPE C.
DATA ALTMP481(18) TYPE C.
DATA ALTMP482(2) TYPE N.
DATA ALTMP483(1) TYPE C.
DATA ALTMP484(1) TYPE C.
DATA ALTMP485(1) TYPE N.
DATA ALTMP486(1) TYPE N.
DATA ALTMP487(10) TYPE C.
DATA ALTMP488(8) TYPE C.
DATA ALTMP489(5) TYPE C.
DATA ALTMP490(10) TYPE C.
DATA ALTMP491(20) TYPE C.
DATA ALTMP492(35) TYPE C.
DATA ALTMP493(35) TYPE C.
DATA ALTMP494(35) TYPE C.
DATA ALTMP495(35) TYPE C.
DATA ALTMP496(20) TYPE C.
DATA ALTMP497(6) TYPE C.
DATA ALTMP498(28) TYPE C.
DATA ALTMP499(50) TYPE C.
DATA ALTMP500(50) TYPE C.
DATA ALTMP501(50) TYPE C.
DATA ALTMP502(50) TYPE C.
DATA ALTMP503(50) TYPE C.
DATA ALTMP504(1) TYPE C.
DATA ALTMP505 TYPE D.
DATA ALTMP506 TYPE T.

DATA KNA19MANDT LIKE KNA1-MANDT.
DATA KNA19KUNNR LIKE KNA1-KUNNR.
DATA KNA19LAND1 LIKE KNA1-LAND1.
DATA KNA19NAME1 LIKE KNA1-NAME1.
DATA KNA19NAME2 LIKE KNA1-NAME2.
DATA KNA19ORT01 LIKE KNA1-ORT01.
DATA KNA19PSTLZ LIKE KNA1-PSTLZ.
DATA KNA19REGIO LIKE KNA1-REGIO.
DATA KNA19SORTL LIKE KNA1-SORTL.
DATA KNA19STRAS LIKE KNA1-STRAS.
DATA KNA19TELF1 LIKE KNA1-TELF1.
DATA KNA19TELFX LIKE KNA1-TELFX.
DATA KNA19XCPDK LIKE KNA1-XCPDK.
DATA KNA19ADRNR LIKE KNA1-ADRNR.
DATA KNA19MCOD1 LIKE KNA1-MCOD1.
DATA KNA19MCOD2 LIKE KNA1-MCOD2.
DATA KNA19MCOD3 LIKE KNA1-MCOD3.
DATA KNA19ANRED LIKE KNA1-ANRED.
DATA KNA19AUFSD LIKE KNA1-AUFSD.
DATA KNA19BAHNE LIKE KNA1-BAHNE.
DATA KNA19BAHNS LIKE KNA1-BAHNS.
DATA KNA19BBBNR LIKE KNA1-BBBNR.
DATA KNA19BBSNR LIKE KNA1-BBSNR.
DATA KNA19BEGRU LIKE KNA1-BEGRU.
DATA KNA19BRSCH LIKE KNA1-BRSCH.
DATA KNA19BUBKZ LIKE KNA1-BUBKZ.
DATA KNA19DATLT LIKE KNA1-DATLT.
DATA KNA19ERDAT LIKE KNA1-ERDAT.
DATA KNA19ERNAM LIKE KNA1-ERNAM.
DATA KNA19EXABL LIKE KNA1-EXABL.
DATA KNA19FAKSD LIKE KNA1-FAKSD.
DATA KNA19FISKN LIKE KNA1-FISKN.
DATA KNA19KNAZK LIKE KNA1-KNAZK.
DATA KNA19KNRZA LIKE KNA1-KNRZA.
DATA KNA19KONZS LIKE KNA1-KONZS.
DATA KNA19KTOKD LIKE KNA1-KTOKD.
DATA KNA19KUKLA LIKE KNA1-KUKLA.
DATA KNA19LIFNR LIKE KNA1-LIFNR.
DATA KNA19LIFSD LIKE KNA1-LIFSD.
DATA KNA19LOCCO LIKE KNA1-LOCCO.
DATA KNA19LOEVM LIKE KNA1-LOEVM.
DATA KNA19NAME3 LIKE KNA1-NAME3.
DATA KNA19NAME4 LIKE KNA1-NAME4.
DATA KNA19NIELS LIKE KNA1-NIELS.
DATA KNA19ORT02 LIKE KNA1-ORT02.
DATA KNA19PFACH LIKE KNA1-PFACH.
DATA KNA19PSTL2 LIKE KNA1-PSTL2.
DATA KNA19COUNC LIKE KNA1-COUNC.
DATA KNA19CITYC LIKE KNA1-CITYC.
DATA KNA19RPMKR LIKE KNA1-RPMKR.
DATA KNA19SPERR LIKE KNA1-SPERR.
DATA KNA19SPRAS LIKE KNA1-SPRAS.
DATA KNA19STCD1 LIKE KNA1-STCD1.
DATA KNA19STCD2 LIKE KNA1-STCD2.
DATA KNA19STKZA LIKE KNA1-STKZA.
DATA KNA19STKZU LIKE KNA1-STKZU.
DATA KNA19TELBX LIKE KNA1-TELBX.
DATA KNA19TELF2 LIKE KNA1-TELF2.
DATA KNA19TELTX LIKE KNA1-TELTX.
DATA KNA19TELX1 LIKE KNA1-TELX1.
DATA KNA19LZONE LIKE KNA1-LZONE.
DATA KNA19XZEMP LIKE KNA1-XZEMP.
DATA KNA19VBUND LIKE KNA1-VBUND.
DATA KNA19STCEG LIKE KNA1-STCEG.
DATA KNA19DEAR1 LIKE KNA1-DEAR1.
DATA KNA19DEAR2 LIKE KNA1-DEAR2.
DATA KNA19DEAR3 LIKE KNA1-DEAR3.
DATA KNA19DEAR4 LIKE KNA1-DEAR4.
DATA KNA19DEAR5 LIKE KNA1-DEAR5.
DATA KNA19GFORM LIKE KNA1-GFORM.
DATA KNA19BRAN1 LIKE KNA1-BRAN1.
DATA KNA19BRAN2 LIKE KNA1-BRAN2.
DATA KNA19BRAN3 LIKE KNA1-BRAN3.
DATA KNA19BRAN4 LIKE KNA1-BRAN4.
DATA KNA19BRAN5 LIKE KNA1-BRAN5.
DATA KNA19EKONT LIKE KNA1-EKONT.
DATA KNA19UMSAT LIKE KNA1-UMSAT.
DATA KNA19UMJAH LIKE KNA1-UMJAH.
DATA KNA19UWAER LIKE KNA1-UWAER.
DATA KNA19JMZAH LIKE KNA1-JMZAH.
DATA KNA19JMJAH LIKE KNA1-JMJAH.
DATA KNA19KATR1 LIKE KNA1-KATR1.
DATA KNA19KATR2 LIKE KNA1-KATR2.
DATA KNA19KATR3 LIKE KNA1-KATR3.
DATA KNA19KATR4 LIKE KNA1-KATR4.
DATA KNA19KATR5 LIKE KNA1-KATR5.
DATA KNA19KATR6 LIKE KNA1-KATR6.
DATA KNA19KATR7 LIKE KNA1-KATR7.
DATA KNA19KATR8 LIKE KNA1-KATR8.
DATA KNA19KATR9 LIKE KNA1-KATR9.
DATA KNA19KATR10 LIKE KNA1-KATR10.
DATA KNA19STKZN LIKE KNA1-STKZN.
DATA KNA19UMSA1 LIKE KNA1-UMSA1.
DATA KNA19TXJCD LIKE KNA1-TXJCD.
DATA KNA19PERIV LIKE KNA1-PERIV.
DATA KNA19ABRVW LIKE KNA1-ABRVW.
DATA KNA19INSPBYDEBI LIKE KNA1-INSPBYDEBI.
DATA KNA19INSPATDEBI LIKE KNA1-INSPATDEBI.
DATA KNA19KTOCD LIKE KNA1-KTOCD.
DATA KNA19PFORT LIKE KNA1-PFORT.
DATA KNA19WERKS LIKE KNA1-WERKS.
DATA KNA19DTAMS LIKE KNA1-DTAMS.
DATA KNA19DTAWS LIKE KNA1-DTAWS.
DATA KNA19DUEFL LIKE KNA1-DUEFL.
DATA KNA19HZUOR LIKE KNA1-HZUOR.
DATA KNA19SPERZ LIKE KNA1-SPERZ.
DATA KNA19ETIKG LIKE KNA1-ETIKG.
DATA KNA19CIVVE LIKE KNA1-CIVVE.
DATA KNA19MILVE LIKE KNA1-MILVE.
DATA KNA19KDKG1 LIKE KNA1-KDKG1.
DATA KNA19KDKG2 LIKE KNA1-KDKG2.
DATA KNA19KDKG3 LIKE KNA1-KDKG3.
DATA KNA19KDKG4 LIKE KNA1-KDKG4.
DATA KNA19KDKG5 LIKE KNA1-KDKG5.
DATA KNA19XKNZA LIKE KNA1-XKNZA.
DATA KNA19FITYP LIKE KNA1-FITYP.
DATA KNA19STCDT LIKE KNA1-STCDT.
DATA KNA19STCD3 LIKE KNA1-STCD3.
DATA KNA19STCD4 LIKE KNA1-STCD4.
DATA KNA19XICMS LIKE KNA1-XICMS.
DATA KNA19XXIPI LIKE KNA1-XXIPI.
DATA KNA19XSUBT LIKE KNA1-XSUBT.
DATA KNA19CFOPC LIKE KNA1-CFOPC.
DATA KNA19TXLW1 LIKE KNA1-TXLW1.
DATA KNA19TXLW2 LIKE KNA1-TXLW2.
DATA KNA19CCC01 LIKE KNA1-CCC01.
DATA KNA19CCC02 LIKE KNA1-CCC02.
DATA KNA19CCC03 LIKE KNA1-CCC03.
DATA KNA19CCC04 LIKE KNA1-CCC04.
DATA KNA19CASSD LIKE KNA1-CASSD.
DATA KNA19KNURL LIKE KNA1-KNURL.
DATA KNA19J_1KFREPRE LIKE KNA1-J_1KFREPRE.
DATA KNA19J_1KFTBUS LIKE KNA1-J_1KFTBUS.
DATA KNA19J_1KFTIND LIKE KNA1-J_1KFTIND.
DATA KNA19CONFS LIKE KNA1-CONFS.
DATA KNA19UPDAT LIKE KNA1-UPDAT.
DATA KNA19UPTIM LIKE KNA1-UPTIM.
DATA KNA19NODEL LIKE KNA1-NODEL.
DATA KNA19DEAR6 LIKE KNA1-DEAR6.
DATA KNA19/VSO/R_PALHGT LIKE KNA1-/VSO/R_PALHGT.
DATA KNA19/VSO/R_PAL_UL LIKE KNA1-/VSO/R_PAL_UL.
DATA KNA19/VSO/R_PK_MAT LIKE KNA1-/VSO/R_PK_MAT.
DATA KNA19/VSO/R_MATPAL LIKE KNA1-/VSO/R_MATPAL.
DATA KNA19/VSO/R_I_NO_LYR LIKE KNA1-/VSO/R_I_NO_LYR.
DATA KNA19/VSO/R_ONE_MAT LIKE KNA1-/VSO/R_ONE_MAT.
DATA KNA19/VSO/R_ONE_SORT LIKE KNA1-/VSO/R_ONE_SORT.
DATA KNA19/VSO/R_ULD_SIDE LIKE KNA1-/VSO/R_ULD_SIDE.
DATA KNA19/VSO/R_LOAD_PREF LIKE KNA1-/VSO/R_LOAD_PREF.
DATA KNA19/VSO/R_DPOINT LIKE KNA1-/VSO/R_DPOINT.
DATA KNA19ALC LIKE KNA1-ALC.
DATA KNA19PMT_OFFICE LIKE KNA1-PMT_OFFICE.
DATA KNA19PSOFG LIKE KNA1-PSOFG.
DATA KNA19PSOIS LIKE KNA1-PSOIS.
DATA KNA19PSON1 LIKE KNA1-PSON1.
DATA KNA19PSON2 LIKE KNA1-PSON2.
DATA KNA19PSON3 LIKE KNA1-PSON3.
DATA KNA19PSOVN LIKE KNA1-PSOVN.
DATA KNA19PSOTL LIKE KNA1-PSOTL.
DATA KNA19PSOHS LIKE KNA1-PSOHS.
DATA KNA19PSOST LIKE KNA1-PSOST.
DATA KNA19PSOO1 LIKE KNA1-PSOO1.
DATA KNA19PSOO2 LIKE KNA1-PSOO2.
DATA KNA19PSOO3 LIKE KNA1-PSOO3.
DATA KNA19PSOO4 LIKE KNA1-PSOO4.
DATA KNA19PSOO5 LIKE KNA1-PSOO5.
DATA CDHDR9CHANGE_IND LIKE CDHDR-CHANGE_IND.
DATA CDHDR9UDATE LIKE CDHDR-UDATE.
DATA CDHDR9UTIME LIKE CDHDR-UTIME.
DATA CDHDR9OBJECTCLAS LIKE CDHDR-OBJECTCLAS.
DATA CDHDR9OBJECTID LIKE CDHDR-OBJECTID.



SELECT
  KNA19~MANDT
  KNA19~KUNNR
  KNA19~LAND1
  KNA19~NAME1
  KNA19~NAME2
  KNA19~ORT01
  KNA19~PSTLZ
  KNA19~REGIO
  KNA19~SORTL
  KNA19~STRAS
  KNA19~TELF1
  KNA19~TELFX
  KNA19~XCPDK
  KNA19~ADRNR
  KNA19~MCOD1
  KNA19~MCOD2
  KNA19~MCOD3
  KNA19~ANRED
  KNA19~AUFSD
  KNA19~BAHNE
  KNA19~BAHNS
  KNA19~BBBNR
  KNA19~BBSNR
  KNA19~BEGRU
  KNA19~BRSCH
  KNA19~BUBKZ
  KNA19~DATLT
  KNA19~ERDAT
  KNA19~ERNAM
  KNA19~EXABL
  KNA19~FAKSD
  KNA19~FISKN
  KNA19~KNAZK
  KNA19~KNRZA
  KNA19~KONZS
  KNA19~KTOKD
  KNA19~KUKLA
  KNA19~LIFNR
  KNA19~LIFSD
  KNA19~LOCCO
  KNA19~LOEVM
  KNA19~NAME3
  KNA19~NAME4
  KNA19~NIELS
  KNA19~ORT02
  KNA19~PFACH
  KNA19~PSTL2
  KNA19~COUNC
  KNA19~CITYC
  KNA19~RPMKR
  KNA19~SPERR
  KNA19~SPRAS
  KNA19~STCD1
  KNA19~STCD2
  KNA19~STKZA
  KNA19~STKZU
  KNA19~TELBX
  KNA19~TELF2
  KNA19~TELTX
  KNA19~TELX1
  KNA19~LZONE
  KNA19~XZEMP
  KNA19~VBUND
  KNA19~STCEG
  KNA19~DEAR1
  KNA19~DEAR2
  KNA19~DEAR3
  KNA19~DEAR4
  KNA19~DEAR5
  KNA19~GFORM
  KNA19~BRAN1
  KNA19~BRAN2
  KNA19~BRAN3
  KNA19~BRAN4
  KNA19~BRAN5
  KNA19~EKONT
  KNA19~UMSAT
  KNA19~UMJAH
  KNA19~UWAER
  KNA19~JMZAH
  KNA19~JMJAH
  KNA19~KATR1
  KNA19~KATR2
  KNA19~KATR3
  KNA19~KATR4
  KNA19~KATR5
  KNA19~KATR6
  KNA19~KATR7
  KNA19~KATR8
  KNA19~KATR9
  KNA19~KATR10
  KNA19~STKZN
  KNA19~UMSA1
  KNA19~TXJCD
  KNA19~PERIV
  KNA19~ABRVW
  KNA19~INSPBYDEBI
  KNA19~INSPATDEBI
  KNA19~KTOCD
  KNA19~PFORT
  KNA19~WERKS
  KNA19~DTAMS
  KNA19~DTAWS
  KNA19~DUEFL
  KNA19~HZUOR
  KNA19~SPERZ
  KNA19~ETIKG
  KNA19~CIVVE
  KNA19~MILVE
  KNA19~KDKG1
  KNA19~KDKG2
  KNA19~KDKG3
  KNA19~KDKG4
  KNA19~KDKG5
  KNA19~XKNZA
  KNA19~FITYP
  KNA19~STCDT
  KNA19~STCD3
  KNA19~STCD4
  KNA19~XICMS
  KNA19~XXIPI
  KNA19~XSUBT
  KNA19~CFOPC
  KNA19~TXLW1
  KNA19~TXLW2
  KNA19~CCC01
  KNA19~CCC02
  KNA19~CCC03
  KNA19~CCC04
  KNA19~CASSD
  KNA19~KNURL
  KNA19~J_1KFREPRE
  KNA19~J_1KFTBUS
  KNA19~J_1KFTIND
  KNA19~CONFS
  KNA19~UPDAT
  KNA19~UPTIM
  KNA19~NODEL
  KNA19~DEAR6
  KNA19~/VSO/R_PALHGT
  KNA19~/VSO/R_PAL_UL
  KNA19~/VSO/R_PK_MAT
  KNA19~/VSO/R_MATPAL
  KNA19~/VSO/R_I_NO_LYR
  KNA19~/VSO/R_ONE_MAT
  KNA19~/VSO/R_ONE_SORT
  KNA19~/VSO/R_ULD_SIDE
  KNA19~/VSO/R_LOAD_PREF
  KNA19~/VSO/R_DPOINT
  KNA19~ALC
  KNA19~PMT_OFFICE
  KNA19~PSOFG
  KNA19~PSOIS
  KNA19~PSON1
  KNA19~PSON2
  KNA19~PSON3
  KNA19~PSOVN
  KNA19~PSOTL
  KNA19~PSOHS
  KNA19~PSOST
  KNA19~PSOO1
  KNA19~PSOO2
  KNA19~PSOO3
  KNA19~PSOO4
  KNA19~PSOO5
  CDHDR9~CHANGE_IND
  CDHDR9~UDATE
  CDHDR9~UTIME
  CDHDR9~OBJECTCLAS
  CDHDR9~OBJECTID
into (KNA19MANDT,
  KNA19KUNNR,
  KNA19LAND1,
  KNA19NAME1,
  KNA19NAME2,
  KNA19ORT01,
  KNA19PSTLZ,
  KNA19REGIO,
  KNA19SORTL,
  KNA19STRAS,
  KNA19TELF1,
  KNA19TELFX,
  KNA19XCPDK,
  KNA19ADRNR,
  KNA19MCOD1,
  KNA19MCOD2,
  KNA19MCOD3,
  KNA19ANRED,
  KNA19AUFSD,
  KNA19BAHNE,
  KNA19BAHNS,
  KNA19BBBNR,
  KNA19BBSNR,
  KNA19BEGRU,
  KNA19BRSCH,
  KNA19BUBKZ,
  KNA19DATLT,
  KNA19ERDAT,
  KNA19ERNAM,
  KNA19EXABL,
  KNA19FAKSD,
  KNA19FISKN,
  KNA19KNAZK,
  KNA19KNRZA,
  KNA19KONZS,
  KNA19KTOKD,
  KNA19KUKLA,
  KNA19LIFNR,
  KNA19LIFSD,
  KNA19LOCCO,
  KNA19LOEVM,
  KNA19NAME3,
  KNA19NAME4,
  KNA19NIELS,
  KNA19ORT02,
  KNA19PFACH,
  KNA19PSTL2,
  KNA19COUNC,
  KNA19CITYC,
  KNA19RPMKR,
  KNA19SPERR,
  KNA19SPRAS,
  KNA19STCD1,
  KNA19STCD2,
  KNA19STKZA,
  KNA19STKZU,
  KNA19TELBX,
  KNA19TELF2,
  KNA19TELTX,
  KNA19TELX1,
  KNA19LZONE,
  KNA19XZEMP,
  KNA19VBUND,
  KNA19STCEG,
  KNA19DEAR1,
  KNA19DEAR2,
  KNA19DEAR3,
  KNA19DEAR4,
  KNA19DEAR5,
  KNA19GFORM,
  KNA19BRAN1,
  KNA19BRAN2,
  KNA19BRAN3,
  KNA19BRAN4,
  KNA19BRAN5,
  KNA19EKONT,
  KNA19UMSAT,
  KNA19UMJAH,
  KNA19UWAER,
  KNA19JMZAH,
  KNA19JMJAH,
  KNA19KATR1,
  KNA19KATR2,
  KNA19KATR3,
  KNA19KATR4,
  KNA19KATR5,
  KNA19KATR6,
  KNA19KATR7,
  KNA19KATR8,
  KNA19KATR9,
  KNA19KATR10,
  KNA19STKZN,
  KNA19UMSA1,
  KNA19TXJCD,
  KNA19PERIV,
  KNA19ABRVW,
  KNA19INSPBYDEBI,
  KNA19INSPATDEBI,
  KNA19KTOCD,
  KNA19PFORT,
  KNA19WERKS,
  KNA19DTAMS,
  KNA19DTAWS,
  KNA19DUEFL,
  KNA19HZUOR,
  KNA19SPERZ,
  KNA19ETIKG,
  KNA19CIVVE,
  KNA19MILVE,
  KNA19KDKG1,
  KNA19KDKG2,
  KNA19KDKG3,
  KNA19KDKG4,
  KNA19KDKG5,
  KNA19XKNZA,
  KNA19FITYP,
  KNA19STCDT,
  KNA19STCD3,
  KNA19STCD4,
  KNA19XICMS,
  KNA19XXIPI,
  KNA19XSUBT,
  KNA19CFOPC,
  KNA19TXLW1,
  KNA19TXLW2,
  KNA19CCC01,
  KNA19CCC02,
  KNA19CCC03,
  KNA19CCC04,
  KNA19CASSD,
  KNA19KNURL,
  KNA19J_1KFREPRE,
  KNA19J_1KFTBUS,
  KNA19J_1KFTIND,
  KNA19CONFS,
  KNA19UPDAT,
  KNA19UPTIM,
  KNA19NODEL,
  KNA19DEAR6,
  KNA19/VSO/R_PALHGT,
  KNA19/VSO/R_PAL_UL,
  KNA19/VSO/R_PK_MAT,
  KNA19/VSO/R_MATPAL,
  KNA19/VSO/R_I_NO_LYR,
  KNA19/VSO/R_ONE_MAT,
  KNA19/VSO/R_ONE_SORT,
  KNA19/VSO/R_ULD_SIDE,
  KNA19/VSO/R_LOAD_PREF,
  KNA19/VSO/R_DPOINT,
  KNA19ALC,
  KNA19PMT_OFFICE,
  KNA19PSOFG,
  KNA19PSOIS,
  KNA19PSON1,
  KNA19PSON2,
  KNA19PSON3,
  KNA19PSOVN,
  KNA19PSOTL,
  KNA19PSOHS,
  KNA19PSOST,
  KNA19PSOO1,
  KNA19PSOO2,
  KNA19PSOO3,
  KNA19PSOO4,
  KNA19PSOO5,
  CDHDR9CHANGE_IND,
  CDHDR9UDATE,
  CDHDR9UTIME,
  CDHDR9OBJECTCLAS,
  CDHDR9OBJECTID)
FROM CDHDR AS CDHDR9
 INNER JOIN KNA1 AS KNA19
 ON ( CDHDR9~OBJECTID = KNA19~KUNNR )
WHERE ( CDHDR9~OBJECTCLAS = 'DEBI' ).
ALTMP339 = KNA19MANDT.
ALTMP340 = KNA19KUNNR.
ALTMP341 = KNA19LAND1.
ALTMP342 = KNA19NAME1.
ALTMP343 = KNA19NAME2.
ALTMP344 = KNA19ORT01.
ALTMP345 = KNA19PSTLZ.
ALTMP346 = KNA19REGIO.
ALTMP347 = KNA19SORTL.
ALTMP348 = KNA19STRAS.
ALTMP349 = KNA19TELF1.
ALTMP350 = KNA19TELFX.
ALTMP351 = KNA19XCPDK.
ALTMP352 = KNA19ADRNR.
ALTMP353 = KNA19MCOD1.
ALTMP354 = KNA19MCOD2.
ALTMP355 = KNA19MCOD3.
ALTMP356 = KNA19ANRED.
ALTMP357 = KNA19AUFSD.
ALTMP358 = KNA19BAHNE.
ALTMP359 = KNA19BAHNS.
ALTMP360 = KNA19BBBNR.
ALTMP361 = KNA19BBSNR.
ALTMP362 = KNA19BEGRU.
ALTMP363 = KNA19BRSCH.
ALTMP364 = KNA19BUBKZ.
ALTMP365 = KNA19DATLT.
ALTMP366 = KNA19ERDAT.
ALTMP367 = KNA19ERNAM.
ALTMP368 = KNA19EXABL.
ALTMP369 = KNA19FAKSD.
ALTMP370 = KNA19FISKN.
ALTMP371 = KNA19KNAZK.
ALTMP372 = KNA19KNRZA.
ALTMP373 = KNA19KONZS.
ALTMP374 = KNA19KTOKD.
ALTMP375 = KNA19KUKLA.
ALTMP376 = KNA19LIFNR.
ALTMP377 = KNA19LIFSD.
ALTMP378 = KNA19LOCCO.
ALTMP379 = KNA19LOEVM.
ALTMP380 = KNA19NAME3.
ALTMP381 = KNA19NAME4.
ALTMP382 = KNA19NIELS.
ALTMP383 = KNA19ORT02.
ALTMP384 = KNA19PFACH.
ALTMP385 = KNA19PSTL2.
ALTMP386 = KNA19COUNC.
ALTMP387 = KNA19CITYC.
ALTMP388 = KNA19RPMKR.
ALTMP389 = KNA19SPERR.
ALTMP390 = KNA19SPRAS.
ALTMP391 = KNA19STCD1.
ALTMP392 = KNA19STCD2.
ALTMP393 = KNA19STKZA.
ALTMP394 = KNA19STKZU.
ALTMP395 = KNA19TELBX.
ALTMP396 = KNA19TELF2.
ALTMP397 = KNA19TELTX.
ALTMP398 = KNA19TELX1.
ALTMP399 = KNA19LZONE.
ALTMP400 = KNA19XZEMP.
ALTMP401 = KNA19VBUND.
ALTMP402 = KNA19STCEG.
ALTMP403 = KNA19DEAR1.
ALTMP404 = KNA19DEAR2.
ALTMP405 = KNA19DEAR3.
ALTMP406 = KNA19DEAR4.
ALTMP407 = KNA19DEAR5.
ALTMP408 = KNA19GFORM.
ALTMP409 = KNA19BRAN1.
ALTMP410 = KNA19BRAN2.
ALTMP411 = KNA19BRAN3.
ALTMP412 = KNA19BRAN4.
ALTMP413 = KNA19BRAN5.
ALTMP414 = KNA19EKONT.
ALTMP415 = KNA19UMSAT.
ALTMP416 = KNA19UMJAH.
ALTMP417 = KNA19UWAER.
ALTMP418 = KNA19JMZAH.
ALTMP419 = KNA19JMJAH.
ALTMP420 = KNA19KATR1.
ALTMP421 = KNA19KATR2.
ALTMP422 = KNA19KATR3.
ALTMP423 = KNA19KATR4.
ALTMP424 = KNA19KATR5.
ALTMP425 = KNA19KATR6.
ALTMP426 = KNA19KATR7.
ALTMP427 = KNA19KATR8.
ALTMP428 = KNA19KATR9.
ALTMP429 = KNA19KATR10.
ALTMP430 = KNA19STKZN.
ALTMP431 = KNA19UMSA1.
ALTMP432 = KNA19TXJCD.
ALTMP433 = KNA19PERIV.
ALTMP434 = KNA19ABRVW.
ALTMP435 = KNA19INSPBYDEBI.
ALTMP436 = KNA19INSPATDEBI.
ALTMP437 = KNA19KTOCD.
ALTMP438 = KNA19PFORT.
ALTMP439 = KNA19WERKS.
ALTMP440 = KNA19DTAMS.
ALTMP441 = KNA19DTAWS.
ALTMP442 = KNA19DUEFL.
ALTMP443 = KNA19HZUOR.
ALTMP444 = KNA19SPERZ.
ALTMP445 = KNA19ETIKG.
ALTMP446 = KNA19CIVVE.
ALTMP447 = KNA19MILVE.
ALTMP448 = KNA19KDKG1.
ALTMP449 = KNA19KDKG2.
ALTMP450 = KNA19KDKG3.
ALTMP451 = KNA19KDKG4.
ALTMP452 = KNA19KDKG5.
ALTMP453 = KNA19XKNZA.
ALTMP454 = KNA19FITYP.
ALTMP455 = KNA19STCDT.
ALTMP456 = KNA19STCD3.
ALTMP457 = KNA19STCD4.
ALTMP458 = KNA19XICMS.
ALTMP459 = KNA19XXIPI.
ALTMP460 = KNA19XSUBT.
ALTMP461 = KNA19CFOPC.
ALTMP462 = KNA19TXLW1.
ALTMP463 = KNA19TXLW2.
ALTMP464 = KNA19CCC01.
ALTMP465 = KNA19CCC02.
ALTMP466 = KNA19CCC03.
ALTMP467 = KNA19CCC04.
ALTMP468 = KNA19CASSD.
ALTMP469 = KNA19KNURL.
ALTMP470 = KNA19J_1KFREPRE.
ALTMP471 = KNA19J_1KFTBUS.
ALTMP472 = KNA19J_1KFTIND.
ALTMP473 = KNA19CONFS.
ALTMP474 = KNA19UPDAT.
ALTMP475 = KNA19UPTIM.
ALTMP476 = KNA19NODEL.
ALTMP477 = KNA19DEAR6.
ALTMP478 = KNA19/VSO/R_PALHGT.
ALTMP479 = KNA19/VSO/R_PAL_UL.
ALTMP480 = KNA19/VSO/R_PK_MAT.
ALTMP481 = KNA19/VSO/R_MATPAL.
ALTMP482 = KNA19/VSO/R_I_NO_LYR.
ALTMP483 = KNA19/VSO/R_ONE_MAT.
ALTMP484 = KNA19/VSO/R_ONE_SORT.
ALTMP485 = KNA19/VSO/R_ULD_SIDE.
ALTMP486 = KNA19/VSO/R_LOAD_PREF.
ALTMP487 = KNA19/VSO/R_DPOINT.
ALTMP488 = KNA19ALC.
ALTMP489 = KNA19PMT_OFFICE.
ALTMP490 = KNA19PSOFG.
ALTMP491 = KNA19PSOIS.
ALTMP492 = KNA19PSON1.
ALTMP493 = KNA19PSON2.
ALTMP494 = KNA19PSON3.
ALTMP495 = KNA19PSOVN.
ALTMP496 = KNA19PSOTL.
ALTMP497 = KNA19PSOHS.
ALTMP498 = KNA19PSOST.
ALTMP499 = KNA19PSOO1.
ALTMP500 = KNA19PSOO2.
ALTMP501 = KNA19PSOO3.
ALTMP502 = KNA19PSOO4.
ALTMP503 = KNA19PSOO5.
ALTMP504 = CDHDR9CHANGE_IND.
ALTMP505 = CDHDR9UDATE.
ALTMP506 = CDHDR9UTIME.
 move ALTMP339 to ITAB3-MANDT.
 move ALTMP340 to ITAB3-KUNNR.
 move ALTMP341 to ITAB3-LAND1.
 move ALTMP342 to ITAB3-NAME1.
 move ALTMP343 to ITAB3-NAME2.
 move ALTMP344 to ITAB3-ORT01.
 move ALTMP345 to ITAB3-PSTLZ.
 move ALTMP346 to ITAB3-REGIO.
 move ALTMP347 to ITAB3-SORTL.
 move ALTMP348 to ITAB3-STRAS.
 move ALTMP349 to ITAB3-TELF1.
 move ALTMP350 to ITAB3-TELFX.
 move ALTMP351 to ITAB3-XCPDK.
 move ALTMP352 to ITAB3-ADRNR.
 move ALTMP353 to ITAB3-MCOD1.
 move ALTMP354 to ITAB3-MCOD2.
 move ALTMP355 to ITAB3-MCOD3.
 move ALTMP356 to ITAB3-ANRED.
 move ALTMP357 to ITAB3-AUFSD.
 move ALTMP358 to ITAB3-BAHNE.
 move ALTMP359 to ITAB3-BAHNS.
 move ALTMP360 to ITAB3-BBBNR.
 move ALTMP361 to ITAB3-BBSNR.
 move ALTMP362 to ITAB3-BEGRU.
 move ALTMP363 to ITAB3-BRSCH.
 move ALTMP364 to ITAB3-BUBKZ.
 move ALTMP365 to ITAB3-DATLT.
 move ALTMP366 to ITAB3-ERDAT.
 move ALTMP367 to ITAB3-ERNAM.
 move ALTMP368 to ITAB3-EXABL.
 move ALTMP369 to ITAB3-FAKSD.
 move ALTMP370 to ITAB3-FISKN.
 move ALTMP371 to ITAB3-KNAZK.
 move ALTMP372 to ITAB3-KNRZA.
 move ALTMP373 to ITAB3-KONZS.
 move ALTMP374 to ITAB3-KTOKD.
 move ALTMP375 to ITAB3-KUKLA.
 move ALTMP376 to ITAB3-LIFNR.
 move ALTMP377 to ITAB3-LIFSD.
 move ALTMP378 to ITAB3-LOCCO.
 move ALTMP379 to ITAB3-LOEVM.
 move ALTMP380 to ITAB3-NAME3.
 move ALTMP381 to ITAB3-NAME4.
 move ALTMP382 to ITAB3-NIELS.
 move ALTMP383 to ITAB3-ORT02.
 move ALTMP384 to ITAB3-PFACH.
 move ALTMP385 to ITAB3-PSTL2.
 move ALTMP386 to ITAB3-COUNC.
 move ALTMP387 to ITAB3-CITYC.
 move ALTMP388 to ITAB3-RPMKR.
 move ALTMP389 to ITAB3-SPERR.
 move ALTMP390 to ITAB3-SPRAS.
 move ALTMP391 to ITAB3-STCD1.
 move ALTMP392 to ITAB3-STCD2.
 move ALTMP393 to ITAB3-STKZA.
 move ALTMP394 to ITAB3-STKZU.
 move ALTMP395 to ITAB3-TELBX.
 move ALTMP396 to ITAB3-TELF2.
 move ALTMP397 to ITAB3-TELTX.
 move ALTMP398 to ITAB3-TELX1.
 move ALTMP399 to ITAB3-LZONE.
 move ALTMP400 to ITAB3-XZEMP.
 move ALTMP401 to ITAB3-VBUND.
 move ALTMP402 to ITAB3-STCEG.
 move ALTMP403 to ITAB3-DEAR1.
 move ALTMP404 to ITAB3-DEAR2.
 move ALTMP405 to ITAB3-DEAR3.
 move ALTMP406 to ITAB3-DEAR4.
 move ALTMP407 to ITAB3-DEAR5.
 move ALTMP408 to ITAB3-GFORM.
 move ALTMP409 to ITAB3-BRAN1.
 move ALTMP410 to ITAB3-BRAN2.
 move ALTMP411 to ITAB3-BRAN3.
 move ALTMP412 to ITAB3-BRAN4.
 move ALTMP413 to ITAB3-BRAN5.
 move ALTMP414 to ITAB3-EKONT.
 move ALTMP415 to ITAB3-UMSAT.
 move ALTMP416 to ITAB3-UMJAH.
 move ALTMP417 to ITAB3-UWAER.
 move ALTMP418 to ITAB3-JMZAH.
 move ALTMP419 to ITAB3-JMJAH.
 move ALTMP420 to ITAB3-KATR1.
 move ALTMP421 to ITAB3-KATR2.
 move ALTMP422 to ITAB3-KATR3.
 move ALTMP423 to ITAB3-KATR4.
 move ALTMP424 to ITAB3-KATR5.
 move ALTMP425 to ITAB3-KATR6.
 move ALTMP426 to ITAB3-KATR7.
 move ALTMP427 to ITAB3-KATR8.
 move ALTMP428 to ITAB3-KATR9.
 move ALTMP429 to ITAB3-KATR10.
 move ALTMP430 to ITAB3-STKZN.
 move ALTMP431 to ITAB3-UMSA1.
 move ALTMP432 to ITAB3-TXJCD.
 move ALTMP433 to ITAB3-PERIV.
 move ALTMP434 to ITAB3-ABRVW.
 move ALTMP435 to ITAB3-INSPBYDEBI.
 move ALTMP436 to ITAB3-INSPATDEBI.
 move ALTMP437 to ITAB3-KTOCD.
 move ALTMP438 to ITAB3-PFORT.
 move ALTMP439 to ITAB3-WERKS.
 move ALTMP440 to ITAB3-DTAMS.
 move ALTMP441 to ITAB3-DTAWS.
 move ALTMP442 to ITAB3-DUEFL.
 move ALTMP443 to ITAB3-HZUOR.
 move ALTMP444 to ITAB3-SPERZ.
 move ALTMP445 to ITAB3-ETIKG.
 move ALTMP446 to ITAB3-CIVVE.
 move ALTMP447 to ITAB3-MILVE.
 move ALTMP448 to ITAB3-KDKG1.
 move ALTMP449 to ITAB3-KDKG2.
 move ALTMP450 to ITAB3-KDKG3.
 move ALTMP451 to ITAB3-KDKG4.
 move ALTMP452 to ITAB3-KDKG5.
 move ALTMP453 to ITAB3-XKNZA.
 move ALTMP454 to ITAB3-FITYP.
 move ALTMP455 to ITAB3-STCDT.
 move ALTMP456 to ITAB3-STCD3.
 move ALTMP457 to ITAB3-STCD4.
 move ALTMP458 to ITAB3-XICMS.
 move ALTMP459 to ITAB3-XXIPI.
 move ALTMP460 to ITAB3-XSUBT.
 move ALTMP461 to ITAB3-CFOPC.
 move ALTMP462 to ITAB3-TXLW1.
 move ALTMP463 to ITAB3-TXLW2.
 move ALTMP464 to ITAB3-CCC01.
 move ALTMP465 to ITAB3-CCC02.
 move ALTMP466 to ITAB3-CCC03.
 move ALTMP467 to ITAB3-CCC04.
 move ALTMP468 to ITAB3-CASSD.
 move ALTMP469 to ITAB3-KNURL.
 move ALTMP470 to ITAB3-J_1KFREPRE.
 move ALTMP471 to ITAB3-J_1KFTBUS.
 move ALTMP472 to ITAB3-J_1KFTIND.
 move ALTMP473 to ITAB3-CONFS.
 move ALTMP474 to ITAB3-UPDAT.
 move ALTMP475 to ITAB3-UPTIM.
 move ALTMP476 to ITAB3-NODEL.
 move ALTMP477 to ITAB3-DEAR6.
 move ALTMP478 to ITAB3-/VSO/R_PALHGT.
 move ALTMP479 to ITAB3-/VSO/R_PAL_UL.
 move ALTMP480 to ITAB3-/VSO/R_PK_MAT.
 move ALTMP481 to ITAB3-/VSO/R_MATPAL.
 move ALTMP482 to ITAB3-/VSO/R_I_NO_LYR.
 move ALTMP483 to ITAB3-/VSO/R_ONE_MAT.
 move ALTMP484 to ITAB3-/VSO/R_ONE_SORT.
 move ALTMP485 to ITAB3-/VSO/R_ULD_SIDE.
 move ALTMP486 to ITAB3-/VSO/R_LOAD_PREF.
 move ALTMP487 to ITAB3-/VSO/R_DPOINT.
 move ALTMP488 to ITAB3-ALC.
 move ALTMP489 to ITAB3-PMT_OFFICE.
 move ALTMP490 to ITAB3-PSOFG.
 move ALTMP491 to ITAB3-PSOIS.
 move ALTMP492 to ITAB3-PSON1.
 move ALTMP493 to ITAB3-PSON2.
 move ALTMP494 to ITAB3-PSON3.
 move ALTMP495 to ITAB3-PSOVN.
 move ALTMP496 to ITAB3-PSOTL.
 move ALTMP497 to ITAB3-PSOHS.
 move ALTMP498 to ITAB3-PSOST.
 move ALTMP499 to ITAB3-PSOO1.
 move ALTMP500 to ITAB3-PSOO2.
 move ALTMP501 to ITAB3-PSOO3.
 move ALTMP502 to ITAB3-PSOO4.
 move ALTMP503 to ITAB3-PSOO5.
 move ALTMP504 to ITAB3-CHANGE_IND.
 move ALTMP505 to ITAB3-UDATE.
 move ALTMP506 to ITAB3-UTIME.
 append ITAB3.
rowCount = rowCount + 1.
IF ( download = 'S' ).
 IF ( rowCount = P_PKGSZ ).
   PERFORM FORM5.
   REFRESH ITAB3.
   rowCount = 0.
 ENDIF.
ELSE.
 IF ( rowCount = 5000 ).
   PERFORM FORM5.
   REFRESH ITAB3.
   rowCount = 0.
 ENDIF.
ENDIF.
ENDSELECT.
ENDFORM.

FORM FORM5.
STATICS firstRun(1) TYPE C VALUE 'Y'.
DATA ALTMP507(3) TYPE C.
DATA ALTMP508(10) TYPE C.
DATA ALTMP509(3) TYPE C.
DATA ALTMP510(35) TYPE C.
DATA ALTMP511(35) TYPE C.
DATA ALTMP512(35) TYPE C.
DATA ALTMP513(10) TYPE C.
DATA ALTMP514(3) TYPE C.
DATA ALTMP515(10) TYPE C.
DATA ALTMP516(35) TYPE C.
DATA ALTMP517(16) TYPE C.
DATA ALTMP518(31) TYPE C.
DATA ALTMP519(1) TYPE C.
DATA ALTMP520(10) TYPE C.
DATA ALTMP521(25) TYPE C.
DATA ALTMP522(25) TYPE C.
DATA ALTMP523(25) TYPE C.
DATA ALTMP524(15) TYPE C.
DATA ALTMP525(2) TYPE C.
DATA ALTMP526(25) TYPE C.
DATA ALTMP527(25) TYPE C.
DATA ALTMP528(7) TYPE N.
DATA ALTMP529(5) TYPE N.
DATA ALTMP530(4) TYPE C.
DATA ALTMP531(4) TYPE C.
DATA ALTMP532(1) TYPE N.
DATA ALTMP533(14) TYPE C.
DATA ALTMP534 TYPE D.
DATA ALTMP535(12) TYPE C.
DATA ALTMP536(1) TYPE C.
DATA ALTMP537(2) TYPE C.
DATA ALTMP538(10) TYPE C.
DATA ALTMP539(2) TYPE C.
DATA ALTMP540(10) TYPE C.
DATA ALTMP541(10) TYPE C.
DATA ALTMP542(4) TYPE C.
DATA ALTMP543(2) TYPE C.
DATA ALTMP544(10) TYPE C.
DATA ALTMP545(2) TYPE C.
DATA ALTMP546(10) TYPE C.
DATA ALTMP547(1) TYPE C.
DATA ALTMP548(35) TYPE C.
DATA ALTMP549(35) TYPE C.
DATA ALTMP550(2) TYPE C.
DATA ALTMP551(35) TYPE C.
DATA ALTMP552(10) TYPE C.
DATA ALTMP553(10) TYPE C.
DATA ALTMP554(3) TYPE C.
DATA ALTMP555(4) TYPE C.
DATA ALTMP556(5) TYPE C.
DATA ALTMP557(1) TYPE C.
DATA ALTMP558(1) TYPE C.
DATA ALTMP559(16) TYPE C.
DATA ALTMP560(11) TYPE C.
DATA ALTMP561(1) TYPE C.
DATA ALTMP562(1) TYPE C.
DATA ALTMP563(15) TYPE C.
DATA ALTMP564(16) TYPE C.
DATA ALTMP565(30) TYPE C.
DATA ALTMP566(30) TYPE C.
DATA ALTMP567(10) TYPE C.
DATA ALTMP568(1) TYPE C.
DATA ALTMP569(6) TYPE C.
DATA ALTMP570(20) TYPE C.
DATA ALTMP571(1) TYPE C.
DATA ALTMP572(1) TYPE C.
DATA ALTMP573(1) TYPE C.
DATA ALTMP574(1) TYPE C.
DATA ALTMP575(1) TYPE C.
DATA ALTMP576(2) TYPE C.
DATA ALTMP577(10) TYPE C.
DATA ALTMP578(10) TYPE C.
DATA ALTMP579(10) TYPE C.
DATA ALTMP580(10) TYPE C.
DATA ALTMP581(10) TYPE C.
DATA ALTMP582(10) TYPE C.
DATA ALTMP583(16) TYPE P DECIMALS 2.
DATA ALTMP584(4) TYPE N.
DATA ALTMP585(5) TYPE C.
DATA ALTMP586(6) TYPE N.
DATA ALTMP587(4) TYPE N.
DATA ALTMP588(2) TYPE C.
DATA ALTMP589(2) TYPE C.
DATA ALTMP590(2) TYPE C.
DATA ALTMP591(2) TYPE C.
DATA ALTMP592(2) TYPE C.
DATA ALTMP593(3) TYPE C.
DATA ALTMP594(3) TYPE C.
DATA ALTMP595(3) TYPE C.
DATA ALTMP596(3) TYPE C.
DATA ALTMP597(3) TYPE C.
DATA ALTMP598(1) TYPE C.
DATA ALTMP599(16) TYPE P DECIMALS 2.
DATA ALTMP600(15) TYPE C.
DATA ALTMP601(2) TYPE C.
DATA ALTMP602(3) TYPE C.
DATA ALTMP603(1) TYPE C.
DATA ALTMP604(1) TYPE C.
DATA ALTMP605(4) TYPE C.
DATA ALTMP606(35) TYPE C.
DATA ALTMP607(4) TYPE C.
DATA ALTMP608(1) TYPE C.
DATA ALTMP609(2) TYPE C.
DATA ALTMP610(1) TYPE C.
DATA ALTMP611(2) TYPE N.
DATA ALTMP612(1) TYPE C.
DATA ALTMP613(10) TYPE C.
DATA ALTMP614(1) TYPE C.
DATA ALTMP615(1) TYPE C.
DATA ALTMP616(2) TYPE C.
DATA ALTMP617(2) TYPE C.
DATA ALTMP618(2) TYPE C.
DATA ALTMP619(2) TYPE C.
DATA ALTMP620(2) TYPE C.
DATA ALTMP621(1) TYPE C.
DATA ALTMP622(2) TYPE C.
DATA ALTMP623(2) TYPE C.
DATA ALTMP624(18) TYPE C.
DATA ALTMP625(18) TYPE C.
DATA ALTMP626(1) TYPE C.
DATA ALTMP627(1) TYPE C.
DATA ALTMP628(3) TYPE C.
DATA ALTMP629(2) TYPE C.
DATA ALTMP630(3) TYPE C.
DATA ALTMP631(3) TYPE C.
DATA ALTMP632(1) TYPE C.
DATA ALTMP633(1) TYPE C.
DATA ALTMP634(1) TYPE C.
DATA ALTMP635(1) TYPE C.
DATA ALTMP636(2) TYPE C.
DATA ALTMP637(132) TYPE C.
DATA ALTMP638(10) TYPE C.
DATA ALTMP639(30) TYPE C.
DATA ALTMP640(30) TYPE C.
DATA ALTMP641(1) TYPE C.
DATA ALTMP642 TYPE D.
DATA ALTMP643(24) TYPE C.
DATA ALTMP644(1) TYPE C.
DATA ALTMP645(1) TYPE C.
DATA ALTMP646(16) TYPE P DECIMALS 3.
DATA ALTMP647(3) TYPE C.
DATA ALTMP648(1) TYPE C.
DATA ALTMP649(18) TYPE C.
DATA ALTMP650(2) TYPE N.
DATA ALTMP651(1) TYPE C.
DATA ALTMP652(1) TYPE C.
DATA ALTMP653(1) TYPE N.
DATA ALTMP654(1) TYPE N.
DATA ALTMP655(10) TYPE C.
DATA ALTMP656(8) TYPE C.
DATA ALTMP657(5) TYPE C.
DATA ALTMP658(10) TYPE C.
DATA ALTMP659(20) TYPE C.
DATA ALTMP660(35) TYPE C.
DATA ALTMP661(35) TYPE C.
DATA ALTMP662(35) TYPE C.
DATA ALTMP663(35) TYPE C.
DATA ALTMP664(20) TYPE C.
DATA ALTMP665(6) TYPE C.
DATA ALTMP666(28) TYPE C.
DATA ALTMP667(50) TYPE C.
DATA ALTMP668(50) TYPE C.
DATA ALTMP669(50) TYPE C.
DATA ALTMP670(50) TYPE C.
DATA ALTMP671(50) TYPE C.
DATA ALTMP672(1) TYPE C.
DATA ALTMP673 TYPE D.
DATA ALTMP674(24) TYPE C.
DATA ALTMP675(20) TYPE C.
DATA ALTMP676(20) TYPE C.
DATA ALOJF0 TYPE C.
DATA ALOJF1 TYPE C.



LOOP AT ITAB3.
ALTMP507 = ITAB3-MANDT.
ALTMP508 = ITAB3-KUNNR.
ALTMP509 = ITAB3-LAND1.
ALTMP510 = ITAB3-NAME1.
ALTMP511 = ITAB3-NAME2.
ALTMP512 = ITAB3-ORT01.
ALTMP513 = ITAB3-PSTLZ.
ALTMP514 = ITAB3-REGIO.
ALTMP515 = ITAB3-SORTL.
ALTMP516 = ITAB3-STRAS.
ALTMP517 = ITAB3-TELF1.
ALTMP518 = ITAB3-TELFX.
ALTMP519 = ITAB3-XCPDK.
ALTMP520 = ITAB3-ADRNR.
ALTMP521 = ITAB3-MCOD1.
ALTMP522 = ITAB3-MCOD2.
ALTMP523 = ITAB3-MCOD3.
ALTMP524 = ITAB3-ANRED.
ALTMP525 = ITAB3-AUFSD.
ALTMP526 = ITAB3-BAHNE.
ALTMP527 = ITAB3-BAHNS.
ALTMP528 = ITAB3-BBBNR.
ALTMP529 = ITAB3-BBSNR.
ALTMP530 = ITAB3-BEGRU.
ALTMP531 = ITAB3-BRSCH.
ALTMP532 = ITAB3-BUBKZ.
ALTMP533 = ITAB3-DATLT.
ALTMP534 = ITAB3-ERDAT.
ALTMP535 = ITAB3-ERNAM.
ALTMP536 = ITAB3-EXABL.
ALTMP537 = ITAB3-FAKSD.
ALTMP538 = ITAB3-FISKN.
ALTMP539 = ITAB3-KNAZK.
ALTMP540 = ITAB3-KNRZA.
ALTMP541 = ITAB3-KONZS.
ALTMP542 = ITAB3-KTOKD.
ALTMP543 = ITAB3-KUKLA.
ALTMP544 = ITAB3-LIFNR.
ALTMP545 = ITAB3-LIFSD.
ALTMP546 = ITAB3-LOCCO.
ALTMP547 = ITAB3-LOEVM.
ALTMP548 = ITAB3-NAME3.
ALTMP549 = ITAB3-NAME4.
ALTMP550 = ITAB3-NIELS.
ALTMP551 = ITAB3-ORT02.
ALTMP552 = ITAB3-PFACH.
ALTMP553 = ITAB3-PSTL2.
ALTMP554 = ITAB3-COUNC.
ALTMP555 = ITAB3-CITYC.
ALTMP556 = ITAB3-RPMKR.
ALTMP557 = ITAB3-SPERR.
ALTMP558 = ITAB3-SPRAS.
ALTMP559 = ITAB3-STCD1.
ALTMP560 = ITAB3-STCD2.
ALTMP561 = ITAB3-STKZA.
ALTMP562 = ITAB3-STKZU.
ALTMP563 = ITAB3-TELBX.
ALTMP564 = ITAB3-TELF2.
ALTMP565 = ITAB3-TELTX.
ALTMP566 = ITAB3-TELX1.
ALTMP567 = ITAB3-LZONE.
ALTMP568 = ITAB3-XZEMP.
ALTMP569 = ITAB3-VBUND.
ALTMP570 = ITAB3-STCEG.
ALTMP571 = ITAB3-DEAR1.
ALTMP572 = ITAB3-DEAR2.
ALTMP573 = ITAB3-DEAR3.
ALTMP574 = ITAB3-DEAR4.
ALTMP575 = ITAB3-DEAR5.
ALTMP576 = ITAB3-GFORM.
ALTMP577 = ITAB3-BRAN1.
ALTMP578 = ITAB3-BRAN2.
ALTMP579 = ITAB3-BRAN3.
ALTMP580 = ITAB3-BRAN4.
ALTMP581 = ITAB3-BRAN5.
ALTMP582 = ITAB3-EKONT.
ALTMP583 = ITAB3-UMSAT.
ALTMP584 = ITAB3-UMJAH.
ALTMP585 = ITAB3-UWAER.
ALTMP586 = ITAB3-JMZAH.
ALTMP587 = ITAB3-JMJAH.
ALTMP588 = ITAB3-KATR1.
ALTMP589 = ITAB3-KATR2.
ALTMP590 = ITAB3-KATR3.
ALTMP591 = ITAB3-KATR4.
ALTMP592 = ITAB3-KATR5.
ALTMP593 = ITAB3-KATR6.
ALTMP594 = ITAB3-KATR7.
ALTMP595 = ITAB3-KATR8.
ALTMP596 = ITAB3-KATR9.
ALTMP597 = ITAB3-KATR10.
ALTMP598 = ITAB3-STKZN.
ALTMP599 = ITAB3-UMSA1.
ALTMP600 = ITAB3-TXJCD.
ALTMP601 = ITAB3-PERIV.
ALTMP602 = ITAB3-ABRVW.
ALTMP603 = ITAB3-INSPBYDEBI.
ALTMP604 = ITAB3-INSPATDEBI.
ALTMP605 = ITAB3-KTOCD.
ALTMP606 = ITAB3-PFORT.
ALTMP607 = ITAB3-WERKS.
ALTMP608 = ITAB3-DTAMS.
ALTMP609 = ITAB3-DTAWS.
ALTMP610 = ITAB3-DUEFL.
ALTMP611 = ITAB3-HZUOR.
ALTMP612 = ITAB3-SPERZ.
ALTMP613 = ITAB3-ETIKG.
ALTMP614 = ITAB3-CIVVE.
ALTMP615 = ITAB3-MILVE.
ALTMP616 = ITAB3-KDKG1.
ALTMP617 = ITAB3-KDKG2.
ALTMP618 = ITAB3-KDKG3.
ALTMP619 = ITAB3-KDKG4.
ALTMP620 = ITAB3-KDKG5.
ALTMP621 = ITAB3-XKNZA.
ALTMP622 = ITAB3-FITYP.
ALTMP623 = ITAB3-STCDT.
ALTMP624 = ITAB3-STCD3.
ALTMP625 = ITAB3-STCD4.
ALTMP626 = ITAB3-XICMS.
ALTMP627 = ITAB3-XXIPI.
ALTMP628 = ITAB3-XSUBT.
ALTMP629 = ITAB3-CFOPC.
ALTMP630 = ITAB3-TXLW1.
ALTMP631 = ITAB3-TXLW2.
ALTMP632 = ITAB3-CCC01.
ALTMP633 = ITAB3-CCC02.
ALTMP634 = ITAB3-CCC03.
ALTMP635 = ITAB3-CCC04.
ALTMP636 = ITAB3-CASSD.
ALTMP637 = ITAB3-KNURL.
ALTMP638 = ITAB3-J_1KFREPRE.
ALTMP639 = ITAB3-J_1KFTBUS.
ALTMP640 = ITAB3-J_1KFTIND.
ALTMP641 = ITAB3-CONFS.
ALTMP642 = ITAB3-UPDAT.
ALTMP643 = ITAB3-UPTIM.
ALTMP644 = ITAB3-NODEL.
ALTMP645 = ITAB3-DEAR6.
ALTMP646 = ITAB3-/VSO/R_PALHGT.
ALTMP647 = ITAB3-/VSO/R_PAL_UL.
ALTMP648 = ITAB3-/VSO/R_PK_MAT.
ALTMP649 = ITAB3-/VSO/R_MATPAL.
ALTMP650 = ITAB3-/VSO/R_I_NO_LYR.
ALTMP651 = ITAB3-/VSO/R_ONE_MAT.
ALTMP652 = ITAB3-/VSO/R_ONE_SORT.
ALTMP653 = ITAB3-/VSO/R_ULD_SIDE.
ALTMP654 = ITAB3-/VSO/R_LOAD_PREF.
ALTMP655 = ITAB3-/VSO/R_DPOINT.
ALTMP656 = ITAB3-ALC.
ALTMP657 = ITAB3-PMT_OFFICE.
ALTMP658 = ITAB3-PSOFG.
ALTMP659 = ITAB3-PSOIS.
ALTMP660 = ITAB3-PSON1.
ALTMP661 = ITAB3-PSON2.
ALTMP662 = ITAB3-PSON3.
ALTMP663 = ITAB3-PSOVN.
ALTMP664 = ITAB3-PSOTL.
ALTMP665 = ITAB3-PSOHS.
ALTMP666 = ITAB3-PSOST.
ALTMP667 = ITAB3-PSOO1.
ALTMP668 = ITAB3-PSOO2.
ALTMP669 = ITAB3-PSOO3.
ALTMP670 = ITAB3-PSOO4.
ALTMP671 = ITAB3-PSOO5.
ALTMP672 = ITAB3-CHANGE_IND.
ALTMP673 = ITAB3-UDATE.
ALTMP674 = ITAB3-UTIME.
ALOJF0 = 'Y'.
ALOJF1 = 'N'.
IF ( ALOJF0 = 'Y' ).

SELECT
  SORT1
  SORT2
  ADDRNUMBER
INTO CORRESPONDING FIELDS OF ADRC
FROM ADRC
WHERE ( ADDRNUMBER = ITAB3-ADRNR ).
ALTMP675 = ADRC-SORT1.
ALTMP676 = ADRC-SORT2.
ALOJF1 = 'Y'.
 move ALTMP507 to ITAB5-MANDT.
 move ALTMP508 to ITAB5-KUNNR.
 move ALTMP509 to ITAB5-LAND1.
 move ALTMP510 to ITAB5-NAME1.
 move ALTMP511 to ITAB5-NAME2.
 move ALTMP512 to ITAB5-ORT01.
 move ALTMP513 to ITAB5-PSTLZ.
 move ALTMP514 to ITAB5-REGIO.
 move ALTMP515 to ITAB5-SORTL.
 move ALTMP516 to ITAB5-STRAS.
 move ALTMP517 to ITAB5-TELF1.
 move ALTMP518 to ITAB5-TELFX.
 move ALTMP519 to ITAB5-XCPDK.
 move ALTMP520 to ITAB5-ADRNR.
 move ALTMP521 to ITAB5-MCOD1.
 move ALTMP522 to ITAB5-MCOD2.
 move ALTMP523 to ITAB5-MCOD3.
 move ALTMP524 to ITAB5-ANRED.
 move ALTMP525 to ITAB5-AUFSD.
 move ALTMP526 to ITAB5-BAHNE.
 move ALTMP527 to ITAB5-BAHNS.
 move ALTMP528 to ITAB5-BBBNR.
 move ALTMP529 to ITAB5-BBSNR.
 move ALTMP530 to ITAB5-BEGRU.
 move ALTMP531 to ITAB5-BRSCH.
 move ALTMP532 to ITAB5-BUBKZ.
 move ALTMP533 to ITAB5-DATLT.
 move ALTMP534 to ITAB5-ERDAT.
 move ALTMP535 to ITAB5-ERNAM.
 move ALTMP536 to ITAB5-EXABL.
 move ALTMP537 to ITAB5-FAKSD.
 move ALTMP538 to ITAB5-FISKN.
 move ALTMP539 to ITAB5-KNAZK.
 move ALTMP540 to ITAB5-KNRZA.
 move ALTMP541 to ITAB5-KONZS.
 move ALTMP542 to ITAB5-KTOKD.
 move ALTMP543 to ITAB5-KUKLA.
 move ALTMP544 to ITAB5-LIFNR.
 move ALTMP545 to ITAB5-LIFSD.
 move ALTMP546 to ITAB5-LOCCO.
 move ALTMP547 to ITAB5-LOEVM.
 move ALTMP548 to ITAB5-NAME3.
 move ALTMP549 to ITAB5-NAME4.
 move ALTMP550 to ITAB5-NIELS.
 move ALTMP551 to ITAB5-ORT02.
 move ALTMP552 to ITAB5-PFACH.
 move ALTMP553 to ITAB5-PSTL2.
 move ALTMP554 to ITAB5-COUNC.
 move ALTMP555 to ITAB5-CITYC.
 move ALTMP556 to ITAB5-RPMKR.
 move ALTMP557 to ITAB5-SPERR.
 move ALTMP558 to ITAB5-SPRAS.
 move ALTMP559 to ITAB5-STCD1.
 move ALTMP560 to ITAB5-STCD2.
 move ALTMP561 to ITAB5-STKZA.
 move ALTMP562 to ITAB5-STKZU.
 move ALTMP563 to ITAB5-TELBX.
 move ALTMP564 to ITAB5-TELF2.
 move ALTMP565 to ITAB5-TELTX.
 move ALTMP566 to ITAB5-TELX1.
 move ALTMP567 to ITAB5-LZONE.
 move ALTMP568 to ITAB5-XZEMP.
 move ALTMP569 to ITAB5-VBUND.
 move ALTMP570 to ITAB5-STCEG.
 move ALTMP571 to ITAB5-DEAR1.
 move ALTMP572 to ITAB5-DEAR2.
 move ALTMP573 to ITAB5-DEAR3.
 move ALTMP574 to ITAB5-DEAR4.
 move ALTMP575 to ITAB5-DEAR5.
 move ALTMP576 to ITAB5-GFORM.
 move ALTMP577 to ITAB5-BRAN1.
 move ALTMP578 to ITAB5-BRAN2.
 move ALTMP579 to ITAB5-BRAN3.
 move ALTMP580 to ITAB5-BRAN4.
 move ALTMP581 to ITAB5-BRAN5.
 move ALTMP582 to ITAB5-EKONT.
 move ALTMP583 to ITAB5-UMSAT.
 move ALTMP584 to ITAB5-UMJAH.
 move ALTMP585 to ITAB5-UWAER.
 move ALTMP586 to ITAB5-JMZAH.
 move ALTMP587 to ITAB5-JMJAH.
 move ALTMP588 to ITAB5-KATR1.
 move ALTMP589 to ITAB5-KATR2.
 move ALTMP590 to ITAB5-KATR3.
 move ALTMP591 to ITAB5-KATR4.
 move ALTMP592 to ITAB5-KATR5.
 move ALTMP593 to ITAB5-KATR6.
 move ALTMP594 to ITAB5-KATR7.
 move ALTMP595 to ITAB5-KATR8.
 move ALTMP596 to ITAB5-KATR9.
 move ALTMP597 to ITAB5-KATR10.
 move ALTMP598 to ITAB5-STKZN.
 move ALTMP599 to ITAB5-UMSA1.
 move ALTMP600 to ITAB5-TXJCD.
 move ALTMP601 to ITAB5-PERIV.
 move ALTMP602 to ITAB5-ABRVW.
 move ALTMP603 to ITAB5-INSPBYDEBI.
 move ALTMP604 to ITAB5-INSPATDEBI.
 move ALTMP605 to ITAB5-KTOCD.
 move ALTMP606 to ITAB5-PFORT.
 move ALTMP607 to ITAB5-WERKS.
 move ALTMP608 to ITAB5-DTAMS.
 move ALTMP609 to ITAB5-DTAWS.
 move ALTMP610 to ITAB5-DUEFL.
 move ALTMP611 to ITAB5-HZUOR.
 move ALTMP612 to ITAB5-SPERZ.
 move ALTMP613 to ITAB5-ETIKG.
 move ALTMP614 to ITAB5-CIVVE.
 move ALTMP615 to ITAB5-MILVE.
 move ALTMP616 to ITAB5-KDKG1.
 move ALTMP617 to ITAB5-KDKG2.
 move ALTMP618 to ITAB5-KDKG3.
 move ALTMP619 to ITAB5-KDKG4.
 move ALTMP620 to ITAB5-KDKG5.
 move ALTMP621 to ITAB5-XKNZA.
 move ALTMP622 to ITAB5-FITYP.
 move ALTMP623 to ITAB5-STCDT.
 move ALTMP624 to ITAB5-STCD3.
 move ALTMP625 to ITAB5-STCD4.
 move ALTMP626 to ITAB5-XICMS.
 move ALTMP627 to ITAB5-XXIPI.
 move ALTMP628 to ITAB5-XSUBT.
 move ALTMP629 to ITAB5-CFOPC.
 move ALTMP630 to ITAB5-TXLW1.
 move ALTMP631 to ITAB5-TXLW2.
 move ALTMP632 to ITAB5-CCC01.
 move ALTMP633 to ITAB5-CCC02.
 move ALTMP634 to ITAB5-CCC03.
 move ALTMP635 to ITAB5-CCC04.
 move ALTMP636 to ITAB5-CASSD.
 move ALTMP637 to ITAB5-KNURL.
 move ALTMP638 to ITAB5-J_1KFREPRE.
 move ALTMP639 to ITAB5-J_1KFTBUS.
 move ALTMP640 to ITAB5-J_1KFTIND.
 move ALTMP641 to ITAB5-CONFS.
 move ALTMP642 to ITAB5-UPDAT.
 move ALTMP643 to ITAB5-UPTIM.
 move ALTMP644 to ITAB5-NODEL.
 move ALTMP645 to ITAB5-DEAR6.
 move ALTMP646 to ITAB5-/VSO/R_PALHGT.
 move ALTMP647 to ITAB5-/VSO/R_PAL_UL.
 move ALTMP648 to ITAB5-/VSO/R_PK_MAT.
 move ALTMP649 to ITAB5-/VSO/R_MATPAL.
 move ALTMP650 to ITAB5-/VSO/R_I_NO_LYR.
 move ALTMP651 to ITAB5-/VSO/R_ONE_MAT.
 move ALTMP652 to ITAB5-/VSO/R_ONE_SORT.
 move ALTMP653 to ITAB5-/VSO/R_ULD_SIDE.
 move ALTMP654 to ITAB5-/VSO/R_LOAD_PREF.
 move ALTMP655 to ITAB5-/VSO/R_DPOINT.
 move ALTMP656 to ITAB5-ALC.
 move ALTMP657 to ITAB5-PMT_OFFICE.
 move ALTMP658 to ITAB5-PSOFG.
 move ALTMP659 to ITAB5-PSOIS.
 move ALTMP660 to ITAB5-PSON1.
 move ALTMP661 to ITAB5-PSON2.
 move ALTMP662 to ITAB5-PSON3.
 move ALTMP663 to ITAB5-PSOVN.
 move ALTMP664 to ITAB5-PSOTL.
 move ALTMP665 to ITAB5-PSOHS.
 move ALTMP666 to ITAB5-PSOST.
 move ALTMP667 to ITAB5-PSOO1.
 move ALTMP668 to ITAB5-PSOO2.
 move ALTMP669 to ITAB5-PSOO3.
 move ALTMP670 to ITAB5-PSOO4.
 move ALTMP671 to ITAB5-PSOO5.
 move ALTMP672 to ITAB5-CHANGE_IND.
 move ALTMP673 to ITAB5-UDATE.
 move ALTMP674 to ITAB5-UTIME.
 move ALTMP675 to ITAB5-SORT1.
 move ALTMP676 to ITAB5-SORT2.
 append ITAB5.
firstRun = 'N' .
 cntbuf = cntbuf + 1.
 if download = 'N'.
  if cntbuf > 5000.
    perform FORM6.
    clear cntbuf.
    refresh ITAB5.
    append_flag = 'A'.
  endif.
 endif.
 if download = 'S'.
  if cntbuf > P_PKGSZ.
    perform FORM6.
    clear cntbuf.
    refresh ITAB5.
  endif.
 endif.
ENDSELECT.
ENDIF.
IF ( ALOJF1 = 'N' ).
clear ADRC-SORT1.
clear ADRC-SORT2.
clear ADRC-ADDRNUMBER.
clear ALTMP675.
clear ALTMP676.
 move ALTMP507 to ITAB5-MANDT.
 move ALTMP508 to ITAB5-KUNNR.
 move ALTMP509 to ITAB5-LAND1.
 move ALTMP510 to ITAB5-NAME1.
 move ALTMP511 to ITAB5-NAME2.
 move ALTMP512 to ITAB5-ORT01.
 move ALTMP513 to ITAB5-PSTLZ.
 move ALTMP514 to ITAB5-REGIO.
 move ALTMP515 to ITAB5-SORTL.
 move ALTMP516 to ITAB5-STRAS.
 move ALTMP517 to ITAB5-TELF1.
 move ALTMP518 to ITAB5-TELFX.
 move ALTMP519 to ITAB5-XCPDK.
 move ALTMP520 to ITAB5-ADRNR.
 move ALTMP521 to ITAB5-MCOD1.
 move ALTMP522 to ITAB5-MCOD2.
 move ALTMP523 to ITAB5-MCOD3.
 move ALTMP524 to ITAB5-ANRED.
 move ALTMP525 to ITAB5-AUFSD.
 move ALTMP526 to ITAB5-BAHNE.
 move ALTMP527 to ITAB5-BAHNS.
 move ALTMP528 to ITAB5-BBBNR.
 move ALTMP529 to ITAB5-BBSNR.
 move ALTMP530 to ITAB5-BEGRU.
 move ALTMP531 to ITAB5-BRSCH.
 move ALTMP532 to ITAB5-BUBKZ.
 move ALTMP533 to ITAB5-DATLT.
 move ALTMP534 to ITAB5-ERDAT.
 move ALTMP535 to ITAB5-ERNAM.
 move ALTMP536 to ITAB5-EXABL.
 move ALTMP537 to ITAB5-FAKSD.
 move ALTMP538 to ITAB5-FISKN.
 move ALTMP539 to ITAB5-KNAZK.
 move ALTMP540 to ITAB5-KNRZA.
 move ALTMP541 to ITAB5-KONZS.
 move ALTMP542 to ITAB5-KTOKD.
 move ALTMP543 to ITAB5-KUKLA.
 move ALTMP544 to ITAB5-LIFNR.
 move ALTMP545 to ITAB5-LIFSD.
 move ALTMP546 to ITAB5-LOCCO.
 move ALTMP547 to ITAB5-LOEVM.
 move ALTMP548 to ITAB5-NAME3.
 move ALTMP549 to ITAB5-NAME4.
 move ALTMP550 to ITAB5-NIELS.
 move ALTMP551 to ITAB5-ORT02.
 move ALTMP552 to ITAB5-PFACH.
 move ALTMP553 to ITAB5-PSTL2.
 move ALTMP554 to ITAB5-COUNC.
 move ALTMP555 to ITAB5-CITYC.
 move ALTMP556 to ITAB5-RPMKR.
 move ALTMP557 to ITAB5-SPERR.
 move ALTMP558 to ITAB5-SPRAS.
 move ALTMP559 to ITAB5-STCD1.
 move ALTMP560 to ITAB5-STCD2.
 move ALTMP561 to ITAB5-STKZA.
 move ALTMP562 to ITAB5-STKZU.
 move ALTMP563 to ITAB5-TELBX.
 move ALTMP564 to ITAB5-TELF2.
 move ALTMP565 to ITAB5-TELTX.
 move ALTMP566 to ITAB5-TELX1.
 move ALTMP567 to ITAB5-LZONE.
 move ALTMP568 to ITAB5-XZEMP.
 move ALTMP569 to ITAB5-VBUND.
 move ALTMP570 to ITAB5-STCEG.
 move ALTMP571 to ITAB5-DEAR1.
 move ALTMP572 to ITAB5-DEAR2.
 move ALTMP573 to ITAB5-DEAR3.
 move ALTMP574 to ITAB5-DEAR4.
 move ALTMP575 to ITAB5-DEAR5.
 move ALTMP576 to ITAB5-GFORM.
 move ALTMP577 to ITAB5-BRAN1.
 move ALTMP578 to ITAB5-BRAN2.
 move ALTMP579 to ITAB5-BRAN3.
 move ALTMP580 to ITAB5-BRAN4.
 move ALTMP581 to ITAB5-BRAN5.
 move ALTMP582 to ITAB5-EKONT.
 move ALTMP583 to ITAB5-UMSAT.
 move ALTMP584 to ITAB5-UMJAH.
 move ALTMP585 to ITAB5-UWAER.
 move ALTMP586 to ITAB5-JMZAH.
 move ALTMP587 to ITAB5-JMJAH.
 move ALTMP588 to ITAB5-KATR1.
 move ALTMP589 to ITAB5-KATR2.
 move ALTMP590 to ITAB5-KATR3.
 move ALTMP591 to ITAB5-KATR4.
 move ALTMP592 to ITAB5-KATR5.
 move ALTMP593 to ITAB5-KATR6.
 move ALTMP594 to ITAB5-KATR7.
 move ALTMP595 to ITAB5-KATR8.
 move ALTMP596 to ITAB5-KATR9.
 move ALTMP597 to ITAB5-KATR10.
 move ALTMP598 to ITAB5-STKZN.
 move ALTMP599 to ITAB5-UMSA1.
 move ALTMP600 to ITAB5-TXJCD.
 move ALTMP601 to ITAB5-PERIV.
 move ALTMP602 to ITAB5-ABRVW.
 move ALTMP603 to ITAB5-INSPBYDEBI.
 move ALTMP604 to ITAB5-INSPATDEBI.
 move ALTMP605 to ITAB5-KTOCD.
 move ALTMP606 to ITAB5-PFORT.
 move ALTMP607 to ITAB5-WERKS.
 move ALTMP608 to ITAB5-DTAMS.
 move ALTMP609 to ITAB5-DTAWS.
 move ALTMP610 to ITAB5-DUEFL.
 move ALTMP611 to ITAB5-HZUOR.
 move ALTMP612 to ITAB5-SPERZ.
 move ALTMP613 to ITAB5-ETIKG.
 move ALTMP614 to ITAB5-CIVVE.
 move ALTMP615 to ITAB5-MILVE.
 move ALTMP616 to ITAB5-KDKG1.
 move ALTMP617 to ITAB5-KDKG2.
 move ALTMP618 to ITAB5-KDKG3.
 move ALTMP619 to ITAB5-KDKG4.
 move ALTMP620 to ITAB5-KDKG5.
 move ALTMP621 to ITAB5-XKNZA.
 move ALTMP622 to ITAB5-FITYP.
 move ALTMP623 to ITAB5-STCDT.
 move ALTMP624 to ITAB5-STCD3.
 move ALTMP625 to ITAB5-STCD4.
 move ALTMP626 to ITAB5-XICMS.
 move ALTMP627 to ITAB5-XXIPI.
 move ALTMP628 to ITAB5-XSUBT.
 move ALTMP629 to ITAB5-CFOPC.
 move ALTMP630 to ITAB5-TXLW1.
 move ALTMP631 to ITAB5-TXLW2.
 move ALTMP632 to ITAB5-CCC01.
 move ALTMP633 to ITAB5-CCC02.
 move ALTMP634 to ITAB5-CCC03.
 move ALTMP635 to ITAB5-CCC04.
 move ALTMP636 to ITAB5-CASSD.
 move ALTMP637 to ITAB5-KNURL.
 move ALTMP638 to ITAB5-J_1KFREPRE.
 move ALTMP639 to ITAB5-J_1KFTBUS.
 move ALTMP640 to ITAB5-J_1KFTIND.
 move ALTMP641 to ITAB5-CONFS.
 move ALTMP642 to ITAB5-UPDAT.
 move ALTMP643 to ITAB5-UPTIM.
 move ALTMP644 to ITAB5-NODEL.
 move ALTMP645 to ITAB5-DEAR6.
 move ALTMP646 to ITAB5-/VSO/R_PALHGT.
 move ALTMP647 to ITAB5-/VSO/R_PAL_UL.
 move ALTMP648 to ITAB5-/VSO/R_PK_MAT.
 move ALTMP649 to ITAB5-/VSO/R_MATPAL.
 move ALTMP650 to ITAB5-/VSO/R_I_NO_LYR.
 move ALTMP651 to ITAB5-/VSO/R_ONE_MAT.
 move ALTMP652 to ITAB5-/VSO/R_ONE_SORT.
 move ALTMP653 to ITAB5-/VSO/R_ULD_SIDE.
 move ALTMP654 to ITAB5-/VSO/R_LOAD_PREF.
 move ALTMP655 to ITAB5-/VSO/R_DPOINT.
 move ALTMP656 to ITAB5-ALC.
 move ALTMP657 to ITAB5-PMT_OFFICE.
 move ALTMP658 to ITAB5-PSOFG.
 move ALTMP659 to ITAB5-PSOIS.
 move ALTMP660 to ITAB5-PSON1.
 move ALTMP661 to ITAB5-PSON2.
 move ALTMP662 to ITAB5-PSON3.
 move ALTMP663 to ITAB5-PSOVN.
 move ALTMP664 to ITAB5-PSOTL.
 move ALTMP665 to ITAB5-PSOHS.
 move ALTMP666 to ITAB5-PSOST.
 move ALTMP667 to ITAB5-PSOO1.
 move ALTMP668 to ITAB5-PSOO2.
 move ALTMP669 to ITAB5-PSOO3.
 move ALTMP670 to ITAB5-PSOO4.
 move ALTMP671 to ITAB5-PSOO5.
 move ALTMP672 to ITAB5-CHANGE_IND.
 move ALTMP673 to ITAB5-UDATE.
 move ALTMP674 to ITAB5-UTIME.
 move ALTMP675 to ITAB5-SORT1.
 move ALTMP676 to ITAB5-SORT2.
 append ITAB5.
firstRun = 'N' .
 cntbuf = cntbuf + 1.
 if download = 'N'.
  if cntbuf > 5000.
    perform FORM6.
    clear cntbuf.
    refresh ITAB5.
    append_flag = 'A'.
  endif.
 endif.
 if download = 'S'.
  if cntbuf > P_PKGSZ.
    perform FORM6.
    clear cntbuf.
    refresh ITAB5.
  endif.
 endif.
ENDIF.
ENDLOOP.
ENDFORM.

FORM FORM6.
data: outfile(512), ldfile(50).
ldfile = 'CTS_LZ_SAP_CP1_KNA1_I'.
concatenate out_dir ldfile into outfile
  separated by '/'.
  IF DOWNLOAD = 'S'.
     DATA: error_message(700),mtext(800),iEOP(1).
     CALL FUNCTION P_SRVFM
          DESTINATION P_DEST
          KEEPING LOGICAL UNIT OF WORK
          EXPORTING
            EOS = last_batch
          IMPORTING
            EOP = iEOP
          TABLES
            E_TABLE = ITAB5
          EXCEPTIONS
            READ_ERROR = 1
            SYSTEM_FAILURE = 2
            MESSAGE error_message
            COMMUNICATION_FAILURE = 3
            MESSAGE error_message
            OTHERS = 4.

     IF sy-subrc ne 0.
        Case sy-subrc.
        when 1.
        CONCATENATE
        'Data Services read error. '
        'Check Data Services error log.'
        INTO mtext.
        MESSAGE  E240(S#) WITH mtext.
        when 2.
        CONCATENATE
'SAP System Failure while calling DS remote function: '
      error_message INTO mtext.
        MESSAGE  E240(S#) WITH mtext.
        when 3.
        CONCATENATE
'SAP System Failure while calling DS remote function: '
      error_message INTO mtext.
        MESSAGE  E240(S#) WITH mtext.
        when 4.
        MESSAGE  E240(S#) WITH
'Other SAP System Failure while calling DS remote function.'.
        endcase.
      ENDIF.
      IF iEOP = 'X'.
         PERFORM DISCONNECT_RFCDEST_FROM_PROGID.
         LEAVE PROGRAM.
       ENDIF.
  ELSE.
data  dlmtlen type i value '1'.
data xdlmtlen type i value '1'.
data:
  ht(1) type c,
  xht(1) type x,
  conv type ref to cl_abap_conv_in_ce.
xht = '7F'.
conv = cl_abap_conv_in_ce=>create(
  encoding = '1100'
  input = xht
).
call method conv->read(
  exporting n    = xdlmtlen
  importing data = ht
            len = dlmtlen
).
data return_code type i.
 perform write_delimited_file
           tables   ITAB5
           using    outfile
                    append_flag
                    ht
                    dlmtlen
                    download
           changing return_code.

  case return_code.
    when 1.
      IF EXECMODE = 'D'.
        WRITE: /5 'No line selected'.
      ELSE.
        MESSAGE E047(S#).
      ENDIF.
    when 2.
      IF EXECMODE = 'D'.
        WRITE: /5 'Open File Error -- ', 25 OUTFILE.
      ELSE.
        MESSAGE  E084(E0) WITH OUTFILE.
      ENDIF.
    when 3.
      IF EXECMODE = 'D'.
        WRITE: /5 'Data exceed length limit (8192) '.
      ELSE.
        MESSAGE  E240(S#) WITH
             'Data exceed length limit (8192) '.
      ENDIF.
    when 4.
      IF EXECMODE = 'D'.
        WRITE: /5 'Call function WS_DOWNLOAD error'.
      ELSE.
        MESSAGE  E240(S#) WITH
             'Call function WS_DOWNLOAD error'.
      ENDIF.
  endcase.
 ENDIF.
ENDFORM.

FORM SUBSTRING USING SRC BEG LEN CHANGING RET.

DATA: VA1 TYPE I.
DATA: VA2 TYPE I.
DATA: VA3 TYPE I.

VA3 = STRLEN( SRC ).

IF  BEG = 0.   VA1 = 0.
ELSE.
  IF  BEG < 0.
    VA1 = VA3 + BEG.
    IF  VA1 < 0.   VA1 = 0.
    ENDIF.
  ELSE.          VA1 = BEG - 1.
  ENDIF.
ENDIF.

IF  LEN < 0.   VA2 = 0.
ELSE.          VA2 = VA3 - VA1.
ENDIF.

IF  VA2 > LEN. VA2 = LEN.
ENDIF.

IF  VA2 < 1.   MOVE ''           TO RET.
ELSE.          MOVE SRC+VA1(VA2) TO RET.
ENDIF.

ENDFORM.

form write_delimited_file
           tables   datatab
           using    file
                    append
                    delimit
                    dlength
                    dwnload
          changing rc.

  data: type1,
        appd(1),
        temp(32),
        time1(8),
        date1(10),
        output(8192),
        rcount type i,
        offset type i,
        tablen type i,
        maxlen type i value '8192'.

  data: begin of clientab occurs 0,
             output(8192),
          end of clientab.

  field-symbols: <f>.
  field-symbols <delim1>.
  data delim2(16).
  data l_filename type string.

  appd = append.
  if appd is not initial.
     appd = 'X'.
  endif.
  move file to l_filename.
  describe table datatab lines tablen.


  if dwnload = 'Y'.
     clear clientab. refresh clientab.
     rcount = 0.
  else.
     if appd = space.
   open dataset file for output in text mode ENCODING UTF-8.
     else.
    open dataset file for appending in text mode ENCODING UTF-8.
     endif.
     if sy-subrc <> 0.
         rc = 2. exit.
     endif.
  endif.

  loop at datatab.
    clear: tablen, offset, output.
    do.
      assign component sy-index of
         structure datatab to <f>.
      if sy-subrc <> 0. exit. endif.
      if sy-index > 1.
         assign delimit(dlength) TO <delim1> CASTING TYPE C.
         delim2 = <delim1>.
         write delim2(dlength) to output+offset(dlength).
         add dlength to offset.
      endif.

      describe field <f> type type1.

      if type1 = 'I' or type1 = 'N'.
          type1 = 'P'.
      endif.

      case type1.
        when 'D'.
          if <f> = '00000000'.
             <f> = ' '.
          else.
             move <f> to time1.
             assign time1 to <f>.
          endif.
        when 'F'.
          if <f> = '0.0'.
            temp = '0.0'.
          else.
             write <f> to temp exponent 0.
          endif.
          condense temp no-gaps.
          translate temp using ',.'.
          assign temp to <f>.
        when 'P'.
          if <f> < 0.
             write '-' to output+offset(1).
             add 1 to offset.
             <f> = <f> * ( -1 ).
          endif.
          move <f> to temp.
          condense temp no-gaps.
          translate temp using ',.'.
          assign temp to <f>.
      endcase.

      sy-fdpos = strlen( <f> ).

      tablen = offset + sy-fdpos.
      if tablen > maxlen.
         rc = 3. exit.
      endif.
      write <f> to output+offset(sy-fdpos).
      add sy-fdpos to offset.
    enddo.

    if dwnload = 'Y'.
       clientab-output = output.
       append clientab.
       rcount = rcount + 1.
       if rcount >= 50.
          SY-BATCH = SPACE.
          CALL FUNCTION 'GUI_DOWNLOAD'
            EXPORTING
              FILENAME = l_filename
              FILETYPE = 'ASC'
              CODEPAGE = '4110'
              APPEND   = appd
              WRITE_FIELD_SEPARATOR = 'X'
*            IMPORTING
*              FILELENGTH =
            TABLES
              DATA_TAB = clientab
            EXCEPTIONS
              OTHERS = 1.
          if sy-subrc <> 0.
             rc = 4.
          endif.
          clear clientab. refresh clientab.
          rcount = 0. appd = 'A'.
       endif.
    else.
       transfer output to file.
    endif.
  endloop.

  if dwnload = 'Y'.
       SY-BATCH = SPACE.
       CALL FUNCTION 'GUI_DOWNLOAD'
         EXPORTING
           FILENAME = l_filename
           FILETYPE = 'ASC'
              CODEPAGE = '4110'
           APPEND   = appd
           WRITE_FIELD_SEPARATOR = 'X'
*         IMPORTING
*           FILELENGTH =
         TABLES
           DATA_TAB = clientab
         EXCEPTIONS
           OTHERS = 1.
          if sy-subrc <> 0.
             rc = 4.
          endif.
  else.
       close dataset file.
  endif.
endform.

FORM CONNECT_RFCDEST_TO_PROGID.
 INCLUDE rfctypes.

 DATA: len     type i,
       R3NAME(4),
       SYSTNR(2),
       uid     LIKE SYS_UID,
       options LIKE RFCOPT,
       isunicode  TYPE n.

 DATA: NTOTAL     LIKE GWY_STRUCT-NOREG,
       GWY_GWHOST LIKE GWY_STRUCT-GWHOST,
       GWY_GWSERV LIKE GWY_STRUCT-GWSERV,
       GWY_TPNAME LIKE GWY_SYSTEM-TPNAME.

 TABLES: RFCSI.

* Check program ID
 IF P_PROGID = SPACE.							
    RAISE INVALID_PROGRAM_ID.
 ENDIF.

* determine if the RFC destination authority
  CALL FUNCTION 'RFC_READ_TCPIP_DESTINATION'
       EXPORTING destination = P_DEST
                 authority_check = 'X'
  IMPORTING rfcunicode = isunicode.

* Use current gateway if no info exits
 IF P_GWHOST = SPACE OR P_GWSERV = SPACE.
  CALL FUNCTION 'RFC_SYSTEM_INFO'
      IMPORTING
          RFCSI_EXPORT = RFCSI.

  len = strlen( rfcsi-rfcdest ) - 2.
  systnr = rfcsi-rfcdest+len.
  len = len - 1 - 3.
  r3name = rfcsi-rfcdest+len(3).
  len = len - 1.
  options-rfcgwhost = rfcsi-rfcdest(len).
  CONCATENATE 'sapgw' SYSTNR INTO options-rfcgwserv.
 ELSE.
   options-rfcgwhost = P_GWHOST.
   options-rfcgwserv = P_GWSERV.
 ENDIF.

* Parameters for GWY function call
  GWY_GWHOST = OPTIONS-RFCGWHOST.
  GWY_GWSERV = OPTIONS-RFCGWSERV.
  GWY_TPNAME = P_PROGID.

* Check gateway and server program registered
  CALL FUNCTION 'GWY_GET_NO_REG_PROGRAMS'
     EXPORTING
        GWHOST      = GWY_GWHOST
        GWSERV      = GWY_GWSERV
        TPNAME      = GWY_TPNAME
     IMPORTING
        NOREG_TOTAL = NTOTAL
     EXCEPTIONS
        OTHERS      = 1.

  IF sy-subrc NE 0.
     raise CONNECT_TO_GATEWAY_FAILED.
  ENDIF.

  IF NTOTAL = 0.
     raise SERVER_NOT_REGISTERED.
  ENDIF.

  IF NTOTAL GT 1.
     raise DUPLICATE_REG_PROGRAMS.
  ENDIF.

* build new connection to a registered server
  options-rfcexec   = gwy_tpname.
  options-rfcgwhost = gwy_gwhost.
  options-rfcgwserv = gwy_gwserv.
  options-rfchost   = '%%RFCSERVER%%'.
  IF P_SNC_ON = 'X'.
    options-rfcsnc  = 'X'.
  ENDIF.

  CALL 'RFCControl' ID 'CODE' FIELD 'O'
                    ID 'DESTINATION' FIELD P_DEST
                    ID 'TYPE' FIELD rfctype_external_tcp
                    ID 'OPTIONS' FIELD options.

  IF sy-subrc NE 0.
     RAISE CONNECT_TO_REG_SERVER_FAILED.
   ENDIF.

* and set exclusive mode to keep server owned
  CALL FUNCTION 'SYSTEM_SET_REG_SERVER_PROPERTY'
      EXPORTING  destination = P_DEST
                 exclusiv    = 'Y'
      EXCEPTIONS connect_to_reg_server_failed = 1
                 exclusiv_not_supported       = 2.

  IF SY-SUBRC NE 0.
     CASE SY-SUBRC.
          WHEN 1.
              RAISE CONNECT_TO_REG_SERVER_FAILED.
          WHEN 2.
              RAISE EXCLUSIV_NOT_SUPPORTED.
     ENDCASE.
  ENDIF.

ENDFORM.

FORM DISCONNECT_RFCDEST_FROM_PROGID.
* set exclusive mode to E to end the session
  CALL FUNCTION 'SYSTEM_SET_REG_SERVER_PROPERTY'
     EXPORTING
         destination = P_DEST
         exclusiv    = 'E'
     EXCEPTIONS
         connect_to_reg_server_failed = 1				
         exclusiv_not_supported       = 2.
ENDFORM.
