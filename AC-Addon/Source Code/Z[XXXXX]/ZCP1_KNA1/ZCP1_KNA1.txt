REPORT ZAL_ABAP message-id 26 line-size 255
no standard page heading.
* ZCP1_KNA1.
PARAMETER DOWNLOAD(1) DEFAULT 'S' lower case. "N-svr,Y-clnt
PARAMETER EXECMODE(1) DEFAULT 'B' lower case. "D-dlg,B-btch
PARAMETER OUT_DIR(48) DEFAULT "output file dir
'/var/load/CQ1/UK/read' lower case.
PARAMETER IN_DIR(48) DEFAULT "input file dir
'/var/load/CQ1/UK/read' lower case.
PARAMETER P_DEST TYPE RFCDES-RFCDEST DEFAULT
'NONE'.
PARAMETER P_PROGID TYPE RFCOPT-RFCEXEC DEFAULT
SPACE.
PARAMETER P_GWHOST TYPE RFCOPT-RFCGWHOST DEFAULT
SPACE.
PARAMETER P_GWSERV TYPE RFCOPT-RFCGWSERV DEFAULT
SPACE.
PARAMETER P_SRVFM(30) DEFAULT "Server Callback function
SPACE.
PARAMETER P_PKGSZ TYPE I DEFAULT "Stream package size
5000.
PARAMETER P_SNC_ON(1) DEFAULT "X-on SPACE-off
SPACE.

PARAMETER $PARAM1 TYPE D.

PARAMETER P_DF_VK(40) DEFAULT "ABAP data flow object key
'' lower case.
PARAMETER P_DI_GEN(40) DEFAULT "DI version that generated ABAP
'' lower case.

*** Machine generated ABAP. Do not modify.            ***
*** (C)Copyright Business Objects S.A.  All rights reserved. ***
*
* Date Time:
*    04/21/16 16:09:52
* SAP used for generated this ABAP:
*    Release: 701
*    Host   : 10.25.3.82
*
* ABAP Dataflow Name:
*    DF_R3_CTS_LZ_SAP_CP1_KNA1_D
* ABAP program name in SAP:
*  ZCP1_KNA1
* Generated ABAP file name:
*    //AIRSBEAP0512/D$/Data/SAPLogistics/VAL/ABAP/ZCP1_KNA1
TABLES KNA1.
TABLES CDHDR.
TABLES ADRC.

DATA: begin of ITAB3 occurs 0,
MANDT(3) TYPE C,
KUNNR(10) TYPE C,
LAND1(3) TYPE C,
NAME1(35) TYPE C,
NAME2(35) TYPE C,
ORT01(35) TYPE C,
PSTLZ(10) TYPE C,
REGIO(3) TYPE C,
SORTL(10) TYPE C,
STRAS(35) TYPE C,
TELF1(16) TYPE C,
TELFX(31) TYPE C,
XCPDK(1) TYPE C,
ADRNR(10) TYPE C,
MCOD1(25) TYPE C,
MCOD2(25) TYPE C,
MCOD3(25) TYPE C,
ANRED(15) TYPE C,
AUFSD(2) TYPE C,
BAHNE(25) TYPE C,
BAHNS(25) TYPE C,
BBBNR(7) TYPE N,
BBSNR(5) TYPE N,
BEGRU(4) TYPE C,
BRSCH(4) TYPE C,
BUBKZ(1) TYPE N,
DATLT(14) TYPE C,
ERDAT TYPE D,
ERNAM(12) TYPE C,
EXABL(1) TYPE C,
FAKSD(2) TYPE C,
FISKN(10) TYPE C,
KNAZK(2) TYPE C,
KNRZA(10) TYPE C,
KONZS(10) TYPE C,
KTOKD(4) TYPE C,
KUKLA(2) TYPE C,
LIFNR(10) TYPE C,
LIFSD(2) TYPE C,
LOCCO(10) TYPE C,
LOEVM(1) TYPE C,
NAME3(35) TYPE C,
NAME4(35) TYPE C,
NIELS(2) TYPE C,
ORT02(35) TYPE C,
PFACH(10) TYPE C,
PSTL2(10) TYPE C,
COUNC(3) TYPE C,
CITYC(4) TYPE C,
RPMKR(5) TYPE C,
SPERR(1) TYPE C,
SPRAS(1) TYPE C,
STCD1(16) TYPE C,
STCD2(11) TYPE C,
STKZA(1) TYPE C,
STKZU(1) TYPE C,
TELBX(15) TYPE C,
TELF2(16) TYPE C,
TELTX(30) TYPE C,
TELX1(30) TYPE C,
LZONE(10) TYPE C,
XZEMP(1) TYPE C,
VBUND(6) TYPE C,
STCEG(20) TYPE C,
DEAR1(1) TYPE C,
DEAR2(1) TYPE C,
DEAR3(1) TYPE C,
DEAR4(1) TYPE C,
DEAR5(1) TYPE C,
GFORM(2) TYPE C,
BRAN1(10) TYPE C,
BRAN2(10) TYPE C,
BRAN3(10) TYPE C,
BRAN4(10) TYPE C,
BRAN5(10) TYPE C,
EKONT(10) TYPE C,
UMSAT(16) TYPE P DECIMALS 2,
UMJAH(4) TYPE N,
UWAER(5) TYPE C,
JMZAH(6) TYPE N,
JMJAH(4) TYPE N,
KATR1(2) TYPE C,
KATR2(2) TYPE C,
KATR3(2) TYPE C,
KATR4(2) TYPE C,
KATR5(2) TYPE C,
KATR6(3) TYPE C,
KATR7(3) TYPE C,
KATR8(3) TYPE C,
KATR9(3) TYPE C,
KATR10(3) TYPE C,
STKZN(1) TYPE C,
UMSA1(16) TYPE P DECIMALS 2,
TXJCD(15) TYPE C,
PERIV(2) TYPE C,
ABRVW(3) TYPE C,
INSPBYDEBI(1) TYPE C,
INSPATDEBI(1) TYPE C,
KTOCD(4) TYPE C,
PFORT(35) TYPE C,
WERKS(4) TYPE C,
DTAMS(1) TYPE C,
DTAWS(2) TYPE C,
DUEFL(1) TYPE C,
HZUOR(2) TYPE N,
SPERZ(1) TYPE C,
ETIKG(10) TYPE C,
CIVVE(1) TYPE C,
MILVE(1) TYPE C,
KDKG1(2) TYPE C,
KDKG2(2) TYPE C,
KDKG3(2) TYPE C,
KDKG4(2) TYPE C,
KDKG5(2) TYPE C,
XKNZA(1) TYPE C,
FITYP(2) TYPE C,
STCDT(2) TYPE C,
STCD3(18) TYPE C,
STCD4(18) TYPE C,
XICMS(1) TYPE C,
XXIPI(1) TYPE C,
XSUBT(3) TYPE C,
CFOPC(2) TYPE C,
TXLW1(3) TYPE C,
TXLW2(3) TYPE C,
CCC01(1) TYPE C,
CCC02(1) TYPE C,
CCC03(1) TYPE C,
CCC04(1) TYPE C,
CASSD(2) TYPE C,
KNURL(132) TYPE C,
J_1KFREPRE(10) TYPE C,
J_1KFTBUS(30) TYPE C,
J_1KFTIND(30) TYPE C,
CONFS(1) TYPE C,
UPDAT TYPE D,
UPTIM(24) TYPE C,
NODEL(1) TYPE C,
DEAR6(1) TYPE C,
/VSO/R_PALHGT(16) TYPE P DECIMALS 3,
/VSO/R_PAL_UL(3) TYPE C,
/VSO/R_PK_MAT(1) TYPE C,
/VSO/R_MATPAL(18) TYPE C,
/VSO/R_I_NO_LYR(2) TYPE N,
/VSO/R_ONE_MAT(1) TYPE C,
/VSO/R_ONE_SORT(1) TYPE C,
/VSO/R_ULD_SIDE(1) TYPE N,
/VSO/R_LOAD_PREF(1) TYPE N,
/VSO/R_DPOINT(10) TYPE C,
ALC(8) TYPE C,
PMT_OFFICE(5) TYPE C,
PSOFG(10) TYPE C,
PSOIS(20) TYPE C,
PSON1(35) TYPE C,
PSON2(35) TYPE C,
PSON3(35) TYPE C,
PSOVN(35) TYPE C,
PSOTL(20) TYPE C,
PSOHS(6) TYPE C,
PSOST(28) TYPE C,
PSOO1(50) TYPE C,
PSOO2(50) TYPE C,
PSOO3(50) TYPE C,
PSOO4(50) TYPE C,
PSOO5(50) TYPE C,
CHANGE_IND(1) TYPE C,
UDATE TYPE D,
UTIME(24) TYPE C.
DATA: end of ITAB3.

DATA: begin of ITAB5 occurs 0,
MANDT(3) TYPE C,
KUNNR(10) TYPE C,
LAND1(3) TYPE C,
NAME1(35) TYPE C,
NAME2(35) TYPE C,
ORT01(35) TYPE C,
PSTLZ(10) TYPE C,
REGIO(3) TYPE C,
SORTL(10) TYPE C,
STRAS(35) TYPE C,
TELF1(16) TYPE C,
TELFX(31) TYPE C,
XCPDK(1) TYPE C,
ADRNR(10) TYPE C,
MCOD1(25) TYPE C,
MCOD2(25) TYPE C,
MCOD3(25) TYPE C,
ANRED(15) TYPE C,
AUFSD(2) TYPE C,
BAHNE(25) TYPE C,
BAHNS(25) TYPE C,
BBBNR(7) TYPE N,
BBSNR(5) TYPE N,
BEGRU(4) TYPE C,
BRSCH(4) TYPE C,
BUBKZ(1) TYPE N,
DATLT(14) TYPE C,
ERDAT TYPE D,
ERNAM(12) TYPE C,
EXABL(1) TYPE C,
FAKSD(2) TYPE C,
FISKN(10) TYPE C,
KNAZK(2) TYPE C,
KNRZA(10) TYPE C,
KONZS(10) TYPE C,
KTOKD(4) TYPE C,
KUKLA(2) TYPE C,
LIFNR(10) TYPE C,
LIFSD(2) TYPE C,
LOCCO(10) TYPE C,
LOEVM(1) TYPE C,
NAME3(35) TYPE C,
NAME4(35) TYPE C,
NIELS(2) TYPE C,
ORT02(35) TYPE C,
PFACH(10) TYPE C,
PSTL2(10) TYPE C,
COUNC(3) TYPE C,
CITYC(4) TYPE C,
RPMKR(5) TYPE C,
SPERR(1) TYPE C,
SPRAS(1) TYPE C,
STCD1(16) TYPE C,
STCD2(11) TYPE C,
STKZA(1) TYPE C,
STKZU(1) TYPE C,
TELBX(15) TYPE C,
TELF2(16) TYPE C,
TELTX(30) TYPE C,
TELX1(30) TYPE C,
LZONE(10) TYPE C,
XZEMP(1) TYPE C,
VBUND(6) TYPE C,
STCEG(20) TYPE C,
DEAR1(1) TYPE C,
DEAR2(1) TYPE C,
DEAR3(1) TYPE C,
DEAR4(1) TYPE C,
DEAR5(1) TYPE C,
GFORM(2) TYPE C,
BRAN1(10) TYPE C,
BRAN2(10) TYPE C,
BRAN3(10) TYPE C,
BRAN4(10) TYPE C,
BRAN5(10) TYPE C,
EKONT(10) TYPE C,
UMSAT(16) TYPE P DECIMALS 2,
UMJAH(4) TYPE N,
UWAER(5) TYPE C,
JMZAH(6) TYPE N,
JMJAH(4) TYPE N,
KATR1(2) TYPE C,
KATR2(2) TYPE C,
KATR3(2) TYPE C,
KATR4(2) TYPE C,
KATR5(2) TYPE C,
KATR6(3) TYPE C,
KATR7(3) TYPE C,
KATR8(3) TYPE C,
KATR9(3) TYPE C,
KATR10(3) TYPE C,
STKZN(1) TYPE C,
UMSA1(16) TYPE P DECIMALS 2,
TXJCD(15) TYPE C,
PERIV(2) TYPE C,
ABRVW(3) TYPE C,
INSPBYDEBI(1) TYPE C,
INSPATDEBI(1) TYPE C,
KTOCD(4) TYPE C,
PFORT(35) TYPE C,
WERKS(4) TYPE C,
DTAMS(1) TYPE C,
DTAWS(2) TYPE C,
DUEFL(1) TYPE C,
HZUOR(2) TYPE N,
SPERZ(1) TYPE C,
ETIKG(10) TYPE C,
CIVVE(1) TYPE C,
MILVE(1) TYPE C,
KDKG1(2) TYPE C,
KDKG2(2) TYPE C,
KDKG3(2) TYPE C,
KDKG4(2) TYPE C,
KDKG5(2) TYPE C,
XKNZA(1) TYPE C,
FITYP(2) TYPE C,
STCDT(2) TYPE C,
STCD3(18) TYPE C,
STCD4(18) TYPE C,
XICMS(1) TYPE C,
XXIPI(1) TYPE C,
XSUBT(3) TYPE C,
CFOPC(2) TYPE C,
TXLW1(3) TYPE C,
TXLW2(3) TYPE C,
CCC01(1) TYPE C,
CCC02(1) TYPE C,
CCC03(1) TYPE C,
CCC04(1) TYPE C,
CASSD(2) TYPE C,
KNURL(132) TYPE C,
J_1KFREPRE(10) TYPE C,
J_1KFTBUS(30) TYPE C,
J_1KFTIND(30) TYPE C,
CONFS(1) TYPE C,
UPDAT TYPE D,
UPTIM(24) TYPE C,
NODEL(1) TYPE C,
DEAR6(1) TYPE C,
/VSO/R_PALHGT(16) TYPE P DECIMALS 3,
/VSO/R_PAL_UL(3) TYPE C,
/VSO/R_PK_MAT(1) TYPE C,
/VSO/R_MATPAL(18) TYPE C,
/VSO/R_I_NO_LYR(2) TYPE N,
/VSO/R_ONE_MAT(1) TYPE C,
/VSO/R_ONE_SORT(1) TYPE C,
/VSO/R_ULD_SIDE(1) TYPE N,
/VSO/R_LOAD_PREF(1) TYPE N,
/VSO/R_DPOINT(10) TYPE C,
ALC(8) TYPE C,
PMT_OFFICE(5) TYPE C,
PSOFG(10) TYPE C,
PSOIS(20) TYPE C,
PSON1(35) TYPE C,
PSON2(35) TYPE C,
PSON3(35) TYPE C,
PSOVN(35) TYPE C,
PSOTL(20) TYPE C,
PSOHS(6) TYPE C,
PSOST(28) TYPE C,
PSOO1(50) TYPE C,
PSOO2(50) TYPE C,
PSOO3(50) TYPE C,
PSOO4(50) TYPE C,
PSOO5(50) TYPE C,
CHANGE_IND(1) TYPE C,
UDATE TYPE D,
UTIME(24) TYPE C,
SORT1(20) TYPE C,
SORT2(20) TYPE C.
DATA: end of ITAB5.

data: append_flag(1) value ' ',
      cntbuf type i,
      delimleng type i,last_batch(1) value ' '.

CONSTANTS C_DF_VK(40) VALUE '827'.
CONSTANTS C_DI_GEN(40) VALUE '14.2.3.660'.
DATA WARN_MSG(50).


DATA: gv_directory     TYPE epsdirnam  VALUE '/var/load/xxx/UK/read/',
      gv_logsys        LIKE tbdlst-logsys.

start-of-selection.
* Logical system
  CALL FUNCTION 'OWN_LOGICAL_SYSTEM_GET'
    IMPORTING
      own_logical_system             = gv_logsys
    EXCEPTIONS
      own_logical_system_not_defined = 1
      OTHERS                         = 2.
  IF sy-subrc <> 0.
    MESSAGE ID sy-msgid TYPE 'E' NUMBER sy-msgno
         WITH sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4.
    STOP.
  ENDIF.
  REPLACE 'xxx' IN out_dir WITH gv_logsys(3).
  REPLACE 'xxx' IN in_dir WITH gv_logsys(3).


  IF DOWNLOAD = 'S' OR
     DOWNLOAD = 'N' OR
     DOWNLOAD = 'Y'.
      .
  ELSE.
     DATA: m_xfer_err_msg(700).
     CONCATENATE
'ABAP program does not recognize this new '
'data transfer method: ' DOWNLOAD
'. Regenerate the ABAP program and upload to this system.'
     INTO m_xfer_err_msg.
     MESSAGE  E240(S#) WITH m_xfer_err_msg.
  ENDIF.

  IF EXECMODE = 'B' OR
     EXECMODE = 'D'.
      .
  ELSE.
     DATA: m_exec_err_msg(700).
     CONCATENATE
'ABAP program does not recognize this new '
'execution option: ' EXECMODE
'. Regenerate the ABAP program and upload to this system.'
     INTO m_exec_err_msg.
     MESSAGE  E240(S#) WITH m_exec_err_msg.
  ENDIF.

  IF DOWNLOAD = 'S'.
     PERFORM CONNECT_RFCDEST_TO_PROGID.
  ENDIF.



PERFORM FORM3.
PERFORM FORM5.
FREE ITAB3.
last_batch = 'X'.
PERFORM FORM6.
FREE ITAB5.
  IF DOWNLOAD = 'S'.
     PERFORM DISCONNECT_RFCDEST_FROM_PROGID.
  ENDIF.


end-of-selection.

CLEAR WARN_MSG.

IF NOT P_DF_VK IS INITIAL.
  IF P_DF_VK <> C_DF_VK.
     CONCATENATE '$$Warning$'
                 C_DF_VK
                 '$' INTO WARN_MSG.
  ENDIF.
ENDIF.
IF NOT P_DI_GEN IS INITIAL.
  IF P_DI_GEN <> C_DI_GEN.
     IF WARN_MSG IS INITIAL.
       CONCATENATE '$$Warning$$'
                   C_DI_GEN
                   INTO WARN_MSG.
     ELSE.
       CONCATENATE WARN_MSG
                   C_DI_GEN
                   INTO WARN_MSG.
     ENDIF.
  ENDIF.
ENDIF.

IF NOT WARN_MSG IS INITIAL.
  IF EXECMODE = 'D'.
    WRITE WARN_MSG.
    NEW-LINE.
  ELSE.
    MESSAGE S240(S#) with WARN_MSG.
  ENDIF.
ENDIF.


write  '* Program Complete *'.
write  '(C)Copyright Business Objects S.A.  All rights reserved.'.

FORM FORM3.
STATICS rowCount TYPE i VALUE 0.
DATA ALTMP491(3) TYPE C.
DATA ALTMP492(10) TYPE C.
DATA ALTMP493(3) TYPE C.
DATA ALTMP494(35) TYPE C.
DATA ALTMP495(35) TYPE C.
DATA ALTMP496(35) TYPE C.
DATA ALTMP497(10) TYPE C.
DATA ALTMP498(3) TYPE C.
DATA ALTMP499(10) TYPE C.
DATA ALTMP500(35) TYPE C.
DATA ALTMP501(16) TYPE C.
DATA ALTMP502(31) TYPE C.
DATA ALTMP503(1) TYPE C.
DATA ALTMP504(10) TYPE C.
DATA ALTMP505(25) TYPE C.
DATA ALTMP506(25) TYPE C.
DATA ALTMP507(25) TYPE C.
DATA ALTMP508(15) TYPE C.
DATA ALTMP509(2) TYPE C.
DATA ALTMP510(25) TYPE C.
DATA ALTMP511(25) TYPE C.
DATA ALTMP512(7) TYPE N.
DATA ALTMP513(5) TYPE N.
DATA ALTMP514(4) TYPE C.
DATA ALTMP515(4) TYPE C.
DATA ALTMP516(1) TYPE N.
DATA ALTMP517(14) TYPE C.
DATA ALTMP518 TYPE D.
DATA ALTMP519(12) TYPE C.
DATA ALTMP520(1) TYPE C.
DATA ALTMP521(2) TYPE C.
DATA ALTMP522(10) TYPE C.
DATA ALTMP523(2) TYPE C.
DATA ALTMP524(10) TYPE C.
DATA ALTMP525(10) TYPE C.
DATA ALTMP526(4) TYPE C.
DATA ALTMP527(2) TYPE C.
DATA ALTMP528(10) TYPE C.
DATA ALTMP529(2) TYPE C.
DATA ALTMP530(10) TYPE C.
DATA ALTMP531(1) TYPE C.
DATA ALTMP532(35) TYPE C.
DATA ALTMP533(35) TYPE C.
DATA ALTMP534(2) TYPE C.
DATA ALTMP535(35) TYPE C.
DATA ALTMP536(10) TYPE C.
DATA ALTMP537(10) TYPE C.
DATA ALTMP538(3) TYPE C.
DATA ALTMP539(4) TYPE C.
DATA ALTMP540(5) TYPE C.
DATA ALTMP541(1) TYPE C.
DATA ALTMP542(1) TYPE C.
DATA ALTMP543(16) TYPE C.
DATA ALTMP544(11) TYPE C.
DATA ALTMP545(1) TYPE C.
DATA ALTMP546(1) TYPE C.
DATA ALTMP547(15) TYPE C.
DATA ALTMP548(16) TYPE C.
DATA ALTMP549(30) TYPE C.
DATA ALTMP550(30) TYPE C.
DATA ALTMP551(10) TYPE C.
DATA ALTMP552(1) TYPE C.
DATA ALTMP553(6) TYPE C.
DATA ALTMP554(20) TYPE C.
DATA ALTMP555(1) TYPE C.
DATA ALTMP556(1) TYPE C.
DATA ALTMP557(1) TYPE C.
DATA ALTMP558(1) TYPE C.
DATA ALTMP559(1) TYPE C.
DATA ALTMP560(2) TYPE C.
DATA ALTMP561(10) TYPE C.
DATA ALTMP562(10) TYPE C.
DATA ALTMP563(10) TYPE C.
DATA ALTMP564(10) TYPE C.
DATA ALTMP565(10) TYPE C.
DATA ALTMP566(10) TYPE C.
DATA ALTMP567(16) TYPE P DECIMALS 2.
DATA ALTMP568(4) TYPE N.
DATA ALTMP569(5) TYPE C.
DATA ALTMP570(6) TYPE N.
DATA ALTMP571(4) TYPE N.
DATA ALTMP572(2) TYPE C.
DATA ALTMP573(2) TYPE C.
DATA ALTMP574(2) TYPE C.
DATA ALTMP575(2) TYPE C.
DATA ALTMP576(2) TYPE C.
DATA ALTMP577(3) TYPE C.
DATA ALTMP578(3) TYPE C.
DATA ALTMP579(3) TYPE C.
DATA ALTMP580(3) TYPE C.
DATA ALTMP581(3) TYPE C.
DATA ALTMP582(1) TYPE C.
DATA ALTMP583(16) TYPE P DECIMALS 2.
DATA ALTMP584(15) TYPE C.
DATA ALTMP585(2) TYPE C.
DATA ALTMP586(3) TYPE C.
DATA ALTMP587(1) TYPE C.
DATA ALTMP588(1) TYPE C.
DATA ALTMP589(4) TYPE C.
DATA ALTMP590(35) TYPE C.
DATA ALTMP591(4) TYPE C.
DATA ALTMP592(1) TYPE C.
DATA ALTMP593(2) TYPE C.
DATA ALTMP594(1) TYPE C.
DATA ALTMP595(2) TYPE N.
DATA ALTMP596(1) TYPE C.
DATA ALTMP597(10) TYPE C.
DATA ALTMP598(1) TYPE C.
DATA ALTMP599(1) TYPE C.
DATA ALTMP600(2) TYPE C.
DATA ALTMP601(2) TYPE C.
DATA ALTMP602(2) TYPE C.
DATA ALTMP603(2) TYPE C.
DATA ALTMP604(2) TYPE C.
DATA ALTMP605(1) TYPE C.
DATA ALTMP606(2) TYPE C.
DATA ALTMP607(2) TYPE C.
DATA ALTMP608(18) TYPE C.
DATA ALTMP609(18) TYPE C.
DATA ALTMP610(1) TYPE C.
DATA ALTMP611(1) TYPE C.
DATA ALTMP612(3) TYPE C.
DATA ALTMP613(2) TYPE C.
DATA ALTMP614(3) TYPE C.
DATA ALTMP615(3) TYPE C.
DATA ALTMP616(1) TYPE C.
DATA ALTMP617(1) TYPE C.
DATA ALTMP618(1) TYPE C.
DATA ALTMP619(1) TYPE C.
DATA ALTMP620(2) TYPE C.
DATA ALTMP621(132) TYPE C.
DATA ALTMP622(10) TYPE C.
DATA ALTMP623(30) TYPE C.
DATA ALTMP624(30) TYPE C.
DATA ALTMP625(1) TYPE C.
DATA ALTMP626 TYPE D.
DATA ALTMP627 TYPE T.
DATA ALTMP628(1) TYPE C.
DATA ALTMP629(1) TYPE C.
DATA ALTMP630(16) TYPE P DECIMALS 3.
DATA ALTMP631(3) TYPE C.
DATA ALTMP632(1) TYPE C.
DATA ALTMP633(18) TYPE C.
DATA ALTMP634(2) TYPE N.
DATA ALTMP635(1) TYPE C.
DATA ALTMP636(1) TYPE C.
DATA ALTMP637(1) TYPE N.
DATA ALTMP638(1) TYPE N.
DATA ALTMP639(10) TYPE C.
DATA ALTMP640(8) TYPE C.
DATA ALTMP641(5) TYPE C.
DATA ALTMP642(10) TYPE C.
DATA ALTMP643(20) TYPE C.
DATA ALTMP644(35) TYPE C.
DATA ALTMP645(35) TYPE C.
DATA ALTMP646(35) TYPE C.
DATA ALTMP647(35) TYPE C.
DATA ALTMP648(20) TYPE C.
DATA ALTMP649(6) TYPE C.
DATA ALTMP650(28) TYPE C.
DATA ALTMP651(50) TYPE C.
DATA ALTMP652(50) TYPE C.
DATA ALTMP653(50) TYPE C.
DATA ALTMP654(50) TYPE C.
DATA ALTMP655(50) TYPE C.
DATA ALTMP656(1) TYPE C.
DATA ALTMP657 TYPE D.
DATA ALTMP658 TYPE T.

DATA KNA19MANDT LIKE KNA1-MANDT.
DATA KNA19KUNNR LIKE KNA1-KUNNR.
DATA KNA19LAND1 LIKE KNA1-LAND1.
DATA KNA19NAME1 LIKE KNA1-NAME1.
DATA KNA19NAME2 LIKE KNA1-NAME2.
DATA KNA19ORT01 LIKE KNA1-ORT01.
DATA KNA19PSTLZ LIKE KNA1-PSTLZ.
DATA KNA19REGIO LIKE KNA1-REGIO.
DATA KNA19SORTL LIKE KNA1-SORTL.
DATA KNA19STRAS LIKE KNA1-STRAS.
DATA KNA19TELF1 LIKE KNA1-TELF1.
DATA KNA19TELFX LIKE KNA1-TELFX.
DATA KNA19XCPDK LIKE KNA1-XCPDK.
DATA KNA19ADRNR LIKE KNA1-ADRNR.
DATA KNA19MCOD1 LIKE KNA1-MCOD1.
DATA KNA19MCOD2 LIKE KNA1-MCOD2.
DATA KNA19MCOD3 LIKE KNA1-MCOD3.
DATA KNA19ANRED LIKE KNA1-ANRED.
DATA KNA19AUFSD LIKE KNA1-AUFSD.
DATA KNA19BAHNE LIKE KNA1-BAHNE.
DATA KNA19BAHNS LIKE KNA1-BAHNS.
DATA KNA19BBBNR LIKE KNA1-BBBNR.
DATA KNA19BBSNR LIKE KNA1-BBSNR.
DATA KNA19BEGRU LIKE KNA1-BEGRU.
DATA KNA19BRSCH LIKE KNA1-BRSCH.
DATA KNA19BUBKZ LIKE KNA1-BUBKZ.
DATA KNA19DATLT LIKE KNA1-DATLT.
DATA KNA19ERDAT LIKE KNA1-ERDAT.
DATA KNA19ERNAM LIKE KNA1-ERNAM.
DATA KNA19EXABL LIKE KNA1-EXABL.
DATA KNA19FAKSD LIKE KNA1-FAKSD.
DATA KNA19FISKN LIKE KNA1-FISKN.
DATA KNA19KNAZK LIKE KNA1-KNAZK.
DATA KNA19KNRZA LIKE KNA1-KNRZA.
DATA KNA19KONZS LIKE KNA1-KONZS.
DATA KNA19KTOKD LIKE KNA1-KTOKD.
DATA KNA19KUKLA LIKE KNA1-KUKLA.
DATA KNA19LIFNR LIKE KNA1-LIFNR.
DATA KNA19LIFSD LIKE KNA1-LIFSD.
DATA KNA19LOCCO LIKE KNA1-LOCCO.
DATA KNA19LOEVM LIKE KNA1-LOEVM.
DATA KNA19NAME3 LIKE KNA1-NAME3.
DATA KNA19NAME4 LIKE KNA1-NAME4.
DATA KNA19NIELS LIKE KNA1-NIELS.
DATA KNA19ORT02 LIKE KNA1-ORT02.
DATA KNA19PFACH LIKE KNA1-PFACH.
DATA KNA19PSTL2 LIKE KNA1-PSTL2.
DATA KNA19COUNC LIKE KNA1-COUNC.
DATA KNA19CITYC LIKE KNA1-CITYC.
DATA KNA19RPMKR LIKE KNA1-RPMKR.
DATA KNA19SPERR LIKE KNA1-SPERR.
DATA KNA19SPRAS LIKE KNA1-SPRAS.
DATA KNA19STCD1 LIKE KNA1-STCD1.
DATA KNA19STCD2 LIKE KNA1-STCD2.
DATA KNA19STKZA LIKE KNA1-STKZA.
DATA KNA19STKZU LIKE KNA1-STKZU.
DATA KNA19TELBX LIKE KNA1-TELBX.
DATA KNA19TELF2 LIKE KNA1-TELF2.
DATA KNA19TELTX LIKE KNA1-TELTX.
DATA KNA19TELX1 LIKE KNA1-TELX1.
DATA KNA19LZONE LIKE KNA1-LZONE.
DATA KNA19XZEMP LIKE KNA1-XZEMP.
DATA KNA19VBUND LIKE KNA1-VBUND.
DATA KNA19STCEG LIKE KNA1-STCEG.
DATA KNA19DEAR1 LIKE KNA1-DEAR1.
DATA KNA19DEAR2 LIKE KNA1-DEAR2.
DATA KNA19DEAR3 LIKE KNA1-DEAR3.
DATA KNA19DEAR4 LIKE KNA1-DEAR4.
DATA KNA19DEAR5 LIKE KNA1-DEAR5.
DATA KNA19GFORM LIKE KNA1-GFORM.
DATA KNA19BRAN1 LIKE KNA1-BRAN1.
DATA KNA19BRAN2 LIKE KNA1-BRAN2.
DATA KNA19BRAN3 LIKE KNA1-BRAN3.
DATA KNA19BRAN4 LIKE KNA1-BRAN4.
DATA KNA19BRAN5 LIKE KNA1-BRAN5.
DATA KNA19EKONT LIKE KNA1-EKONT.
DATA KNA19UMSAT LIKE KNA1-UMSAT.
DATA KNA19UMJAH LIKE KNA1-UMJAH.
DATA KNA19UWAER LIKE KNA1-UWAER.
DATA KNA19JMZAH LIKE KNA1-JMZAH.
DATA KNA19JMJAH LIKE KNA1-JMJAH.
DATA KNA19KATR1 LIKE KNA1-KATR1.
DATA KNA19KATR2 LIKE KNA1-KATR2.
DATA KNA19KATR3 LIKE KNA1-KATR3.
DATA KNA19KATR4 LIKE KNA1-KATR4.
DATA KNA19KATR5 LIKE KNA1-KATR5.
DATA KNA19KATR6 LIKE KNA1-KATR6.
DATA KNA19KATR7 LIKE KNA1-KATR7.
DATA KNA19KATR8 LIKE KNA1-KATR8.
DATA KNA19KATR9 LIKE KNA1-KATR9.
DATA KNA19KATR10 LIKE KNA1-KATR10.
DATA KNA19STKZN LIKE KNA1-STKZN.
DATA KNA19UMSA1 LIKE KNA1-UMSA1.
DATA KNA19TXJCD LIKE KNA1-TXJCD.
DATA KNA19PERIV LIKE KNA1-PERIV.
DATA KNA19ABRVW LIKE KNA1-ABRVW.
DATA KNA19INSPBYDEBI LIKE KNA1-INSPBYDEBI.
DATA KNA19INSPATDEBI LIKE KNA1-INSPATDEBI.
DATA KNA19KTOCD LIKE KNA1-KTOCD.
DATA KNA19PFORT LIKE KNA1-PFORT.
DATA KNA19WERKS LIKE KNA1-WERKS.
DATA KNA19DTAMS LIKE KNA1-DTAMS.
DATA KNA19DTAWS LIKE KNA1-DTAWS.
DATA KNA19DUEFL LIKE KNA1-DUEFL.
DATA KNA19HZUOR LIKE KNA1-HZUOR.
DATA KNA19SPERZ LIKE KNA1-SPERZ.
DATA KNA19ETIKG LIKE KNA1-ETIKG.
DATA KNA19CIVVE LIKE KNA1-CIVVE.
DATA KNA19MILVE LIKE KNA1-MILVE.
DATA KNA19KDKG1 LIKE KNA1-KDKG1.
DATA KNA19KDKG2 LIKE KNA1-KDKG2.
DATA KNA19KDKG3 LIKE KNA1-KDKG3.
DATA KNA19KDKG4 LIKE KNA1-KDKG4.
DATA KNA19KDKG5 LIKE KNA1-KDKG5.
DATA KNA19XKNZA LIKE KNA1-XKNZA.
DATA KNA19FITYP LIKE KNA1-FITYP.
DATA KNA19STCDT LIKE KNA1-STCDT.
DATA KNA19STCD3 LIKE KNA1-STCD3.
DATA KNA19STCD4 LIKE KNA1-STCD4.
DATA KNA19XICMS LIKE KNA1-XICMS.
DATA KNA19XXIPI LIKE KNA1-XXIPI.
DATA KNA19XSUBT LIKE KNA1-XSUBT.
DATA KNA19CFOPC LIKE KNA1-CFOPC.
DATA KNA19TXLW1 LIKE KNA1-TXLW1.
DATA KNA19TXLW2 LIKE KNA1-TXLW2.
DATA KNA19CCC01 LIKE KNA1-CCC01.
DATA KNA19CCC02 LIKE KNA1-CCC02.
DATA KNA19CCC03 LIKE KNA1-CCC03.
DATA KNA19CCC04 LIKE KNA1-CCC04.
DATA KNA19CASSD LIKE KNA1-CASSD.
DATA KNA19KNURL LIKE KNA1-KNURL.
DATA KNA19J_1KFREPRE LIKE KNA1-J_1KFREPRE.
DATA KNA19J_1KFTBUS LIKE KNA1-J_1KFTBUS.
DATA KNA19J_1KFTIND LIKE KNA1-J_1KFTIND.
DATA KNA19CONFS LIKE KNA1-CONFS.
DATA KNA19UPDAT LIKE KNA1-UPDAT.
DATA KNA19UPTIM LIKE KNA1-UPTIM.
DATA KNA19NODEL LIKE KNA1-NODEL.
DATA KNA19DEAR6 LIKE KNA1-DEAR6.
DATA KNA19/VSO/R_PALHGT LIKE KNA1-/VSO/R_PALHGT.
DATA KNA19/VSO/R_PAL_UL LIKE KNA1-/VSO/R_PAL_UL.
DATA KNA19/VSO/R_PK_MAT LIKE KNA1-/VSO/R_PK_MAT.
DATA KNA19/VSO/R_MATPAL LIKE KNA1-/VSO/R_MATPAL.
DATA KNA19/VSO/R_I_NO_LYR LIKE KNA1-/VSO/R_I_NO_LYR.
DATA KNA19/VSO/R_ONE_MAT LIKE KNA1-/VSO/R_ONE_MAT.
DATA KNA19/VSO/R_ONE_SORT LIKE KNA1-/VSO/R_ONE_SORT.
DATA KNA19/VSO/R_ULD_SIDE LIKE KNA1-/VSO/R_ULD_SIDE.
DATA KNA19/VSO/R_LOAD_PREF LIKE KNA1-/VSO/R_LOAD_PREF.
DATA KNA19/VSO/R_DPOINT LIKE KNA1-/VSO/R_DPOINT.
DATA KNA19ALC LIKE KNA1-ALC.
DATA KNA19PMT_OFFICE LIKE KNA1-PMT_OFFICE.
DATA KNA19PSOFG LIKE KNA1-PSOFG.
DATA KNA19PSOIS LIKE KNA1-PSOIS.
DATA KNA19PSON1 LIKE KNA1-PSON1.
DATA KNA19PSON2 LIKE KNA1-PSON2.
DATA KNA19PSON3 LIKE KNA1-PSON3.
DATA KNA19PSOVN LIKE KNA1-PSOVN.
DATA KNA19PSOTL LIKE KNA1-PSOTL.
DATA KNA19PSOHS LIKE KNA1-PSOHS.
DATA KNA19PSOST LIKE KNA1-PSOST.
DATA KNA19PSOO1 LIKE KNA1-PSOO1.
DATA KNA19PSOO2 LIKE KNA1-PSOO2.
DATA KNA19PSOO3 LIKE KNA1-PSOO3.
DATA KNA19PSOO4 LIKE KNA1-PSOO4.
DATA KNA19PSOO5 LIKE KNA1-PSOO5.
DATA CDHDR9CHANGE_IND LIKE CDHDR-CHANGE_IND.
DATA CDHDR9UDATE LIKE CDHDR-UDATE.
DATA CDHDR9UTIME LIKE CDHDR-UTIME.
DATA CDHDR9OBJECTCLAS LIKE CDHDR-OBJECTCLAS.
DATA CDHDR9OBJECTID LIKE CDHDR-OBJECTID.



SELECT
  KNA19~MANDT
  KNA19~KUNNR
  KNA19~LAND1
  KNA19~NAME1
  KNA19~NAME2
  KNA19~ORT01
  KNA19~PSTLZ
  KNA19~REGIO
  KNA19~SORTL
  KNA19~STRAS
  KNA19~TELF1
  KNA19~TELFX
  KNA19~XCPDK
  KNA19~ADRNR
  KNA19~MCOD1
  KNA19~MCOD2
  KNA19~MCOD3
  KNA19~ANRED
  KNA19~AUFSD
  KNA19~BAHNE
  KNA19~BAHNS
  KNA19~BBBNR
  KNA19~BBSNR
  KNA19~BEGRU
  KNA19~BRSCH
  KNA19~BUBKZ
  KNA19~DATLT
  KNA19~ERDAT
  KNA19~ERNAM
  KNA19~EXABL
  KNA19~FAKSD
  KNA19~FISKN
  KNA19~KNAZK
  KNA19~KNRZA
  KNA19~KONZS
  KNA19~KTOKD
  KNA19~KUKLA
  KNA19~LIFNR
  KNA19~LIFSD
  KNA19~LOCCO
  KNA19~LOEVM
  KNA19~NAME3
  KNA19~NAME4
  KNA19~NIELS
  KNA19~ORT02
  KNA19~PFACH
  KNA19~PSTL2
  KNA19~COUNC
  KNA19~CITYC
  KNA19~RPMKR
  KNA19~SPERR
  KNA19~SPRAS
  KNA19~STCD1
  KNA19~STCD2
  KNA19~STKZA
  KNA19~STKZU
  KNA19~TELBX
  KNA19~TELF2
  KNA19~TELTX
  KNA19~TELX1
  KNA19~LZONE
  KNA19~XZEMP
  KNA19~VBUND
  KNA19~STCEG
  KNA19~DEAR1
  KNA19~DEAR2
  KNA19~DEAR3
  KNA19~DEAR4
  KNA19~DEAR5
  KNA19~GFORM
  KNA19~BRAN1
  KNA19~BRAN2
  KNA19~BRAN3
  KNA19~BRAN4
  KNA19~BRAN5
  KNA19~EKONT
  KNA19~UMSAT
  KNA19~UMJAH
  KNA19~UWAER
  KNA19~JMZAH
  KNA19~JMJAH
  KNA19~KATR1
  KNA19~KATR2
  KNA19~KATR3
  KNA19~KATR4
  KNA19~KATR5
  KNA19~KATR6
  KNA19~KATR7
  KNA19~KATR8
  KNA19~KATR9
  KNA19~KATR10
  KNA19~STKZN
  KNA19~UMSA1
  KNA19~TXJCD
  KNA19~PERIV
  KNA19~ABRVW
  KNA19~INSPBYDEBI
  KNA19~INSPATDEBI
  KNA19~KTOCD
  KNA19~PFORT
  KNA19~WERKS
  KNA19~DTAMS
  KNA19~DTAWS
  KNA19~DUEFL
  KNA19~HZUOR
  KNA19~SPERZ
  KNA19~ETIKG
  KNA19~CIVVE
  KNA19~MILVE
  KNA19~KDKG1
  KNA19~KDKG2
  KNA19~KDKG3
  KNA19~KDKG4
  KNA19~KDKG5
  KNA19~XKNZA
  KNA19~FITYP
  KNA19~STCDT
  KNA19~STCD3
  KNA19~STCD4
  KNA19~XICMS
  KNA19~XXIPI
  KNA19~XSUBT
  KNA19~CFOPC
  KNA19~TXLW1
  KNA19~TXLW2
  KNA19~CCC01
  KNA19~CCC02
  KNA19~CCC03
  KNA19~CCC04
  KNA19~CASSD
  KNA19~KNURL
  KNA19~J_1KFREPRE
  KNA19~J_1KFTBUS
  KNA19~J_1KFTIND
  KNA19~CONFS
  KNA19~UPDAT
  KNA19~UPTIM
  KNA19~NODEL
  KNA19~DEAR6
  KNA19~/VSO/R_PALHGT
  KNA19~/VSO/R_PAL_UL
  KNA19~/VSO/R_PK_MAT
  KNA19~/VSO/R_MATPAL
  KNA19~/VSO/R_I_NO_LYR
  KNA19~/VSO/R_ONE_MAT
  KNA19~/VSO/R_ONE_SORT
  KNA19~/VSO/R_ULD_SIDE
  KNA19~/VSO/R_LOAD_PREF
  KNA19~/VSO/R_DPOINT
  KNA19~ALC
  KNA19~PMT_OFFICE
  KNA19~PSOFG
  KNA19~PSOIS
  KNA19~PSON1
  KNA19~PSON2
  KNA19~PSON3
  KNA19~PSOVN
  KNA19~PSOTL
  KNA19~PSOHS
  KNA19~PSOST
  KNA19~PSOO1
  KNA19~PSOO2
  KNA19~PSOO3
  KNA19~PSOO4
  KNA19~PSOO5
  CDHDR9~CHANGE_IND
  CDHDR9~UDATE
  CDHDR9~UTIME
  CDHDR9~OBJECTCLAS
  CDHDR9~OBJECTID
into (KNA19MANDT,
  KNA19KUNNR,
  KNA19LAND1,
  KNA19NAME1,
  KNA19NAME2,
  KNA19ORT01,
  KNA19PSTLZ,
  KNA19REGIO,
  KNA19SORTL,
  KNA19STRAS,
  KNA19TELF1,
  KNA19TELFX,
  KNA19XCPDK,
  KNA19ADRNR,
  KNA19MCOD1,
  KNA19MCOD2,
  KNA19MCOD3,
  KNA19ANRED,
  KNA19AUFSD,
  KNA19BAHNE,
  KNA19BAHNS,
  KNA19BBBNR,
  KNA19BBSNR,
  KNA19BEGRU,
  KNA19BRSCH,
  KNA19BUBKZ,
  KNA19DATLT,
  KNA19ERDAT,
  KNA19ERNAM,
  KNA19EXABL,
  KNA19FAKSD,
  KNA19FISKN,
  KNA19KNAZK,
  KNA19KNRZA,
  KNA19KONZS,
  KNA19KTOKD,
  KNA19KUKLA,
  KNA19LIFNR,
  KNA19LIFSD,
  KNA19LOCCO,
  KNA19LOEVM,
  KNA19NAME3,
  KNA19NAME4,
  KNA19NIELS,
  KNA19ORT02,
  KNA19PFACH,
  KNA19PSTL2,
  KNA19COUNC,
  KNA19CITYC,
  KNA19RPMKR,
  KNA19SPERR,
  KNA19SPRAS,
  KNA19STCD1,
  KNA19STCD2,
  KNA19STKZA,
  KNA19STKZU,
  KNA19TELBX,
  KNA19TELF2,
  KNA19TELTX,
  KNA19TELX1,
  KNA19LZONE,
  KNA19XZEMP,
  KNA19VBUND,
  KNA19STCEG,
  KNA19DEAR1,
  KNA19DEAR2,
  KNA19DEAR3,
  KNA19DEAR4,
  KNA19DEAR5,
  KNA19GFORM,
  KNA19BRAN1,
  KNA19BRAN2,
  KNA19BRAN3,
  KNA19BRAN4,
  KNA19BRAN5,
  KNA19EKONT,
  KNA19UMSAT,
  KNA19UMJAH,
  KNA19UWAER,
  KNA19JMZAH,
  KNA19JMJAH,
  KNA19KATR1,
  KNA19KATR2,
  KNA19KATR3,
  KNA19KATR4,
  KNA19KATR5,
  KNA19KATR6,
  KNA19KATR7,
  KNA19KATR8,
  KNA19KATR9,
  KNA19KATR10,
  KNA19STKZN,
  KNA19UMSA1,
  KNA19TXJCD,
  KNA19PERIV,
  KNA19ABRVW,
  KNA19INSPBYDEBI,
  KNA19INSPATDEBI,
  KNA19KTOCD,
  KNA19PFORT,
  KNA19WERKS,
  KNA19DTAMS,
  KNA19DTAWS,
  KNA19DUEFL,
  KNA19HZUOR,
  KNA19SPERZ,
  KNA19ETIKG,
  KNA19CIVVE,
  KNA19MILVE,
  KNA19KDKG1,
  KNA19KDKG2,
  KNA19KDKG3,
  KNA19KDKG4,
  KNA19KDKG5,
  KNA19XKNZA,
  KNA19FITYP,
  KNA19STCDT,
  KNA19STCD3,
  KNA19STCD4,
  KNA19XICMS,
  KNA19XXIPI,
  KNA19XSUBT,
  KNA19CFOPC,
  KNA19TXLW1,
  KNA19TXLW2,
  KNA19CCC01,
  KNA19CCC02,
  KNA19CCC03,
  KNA19CCC04,
  KNA19CASSD,
  KNA19KNURL,
  KNA19J_1KFREPRE,
  KNA19J_1KFTBUS,
  KNA19J_1KFTIND,
  KNA19CONFS,
  KNA19UPDAT,
  KNA19UPTIM,
  KNA19NODEL,
  KNA19DEAR6,
  KNA19/VSO/R_PALHGT,
  KNA19/VSO/R_PAL_UL,
  KNA19/VSO/R_PK_MAT,
  KNA19/VSO/R_MATPAL,
  KNA19/VSO/R_I_NO_LYR,
  KNA19/VSO/R_ONE_MAT,
  KNA19/VSO/R_ONE_SORT,
  KNA19/VSO/R_ULD_SIDE,
  KNA19/VSO/R_LOAD_PREF,
  KNA19/VSO/R_DPOINT,
  KNA19ALC,
  KNA19PMT_OFFICE,
  KNA19PSOFG,
  KNA19PSOIS,
  KNA19PSON1,
  KNA19PSON2,
  KNA19PSON3,
  KNA19PSOVN,
  KNA19PSOTL,
  KNA19PSOHS,
  KNA19PSOST,
  KNA19PSOO1,
  KNA19PSOO2,
  KNA19PSOO3,
  KNA19PSOO4,
  KNA19PSOO5,
  CDHDR9CHANGE_IND,
  CDHDR9UDATE,
  CDHDR9UTIME,
  CDHDR9OBJECTCLAS,
  CDHDR9OBJECTID)
FROM CDHDR AS CDHDR9
 INNER JOIN KNA1 AS KNA19
 ON ( CDHDR9~OBJECTID = KNA19~KUNNR )
WHERE ( ( CDHDR9~UDATE >= $PARAM1 )
 AND ( CDHDR9~OBJECTCLAS = 'DEBI' ) ).
ALTMP491 = KNA19MANDT.
ALTMP492 = KNA19KUNNR.
ALTMP493 = KNA19LAND1.
ALTMP494 = KNA19NAME1.
ALTMP495 = KNA19NAME2.
ALTMP496 = KNA19ORT01.
ALTMP497 = KNA19PSTLZ.
ALTMP498 = KNA19REGIO.
ALTMP499 = KNA19SORTL.
ALTMP500 = KNA19STRAS.
ALTMP501 = KNA19TELF1.
ALTMP502 = KNA19TELFX.
ALTMP503 = KNA19XCPDK.
ALTMP504 = KNA19ADRNR.
ALTMP505 = KNA19MCOD1.
ALTMP506 = KNA19MCOD2.
ALTMP507 = KNA19MCOD3.
ALTMP508 = KNA19ANRED.
ALTMP509 = KNA19AUFSD.
ALTMP510 = KNA19BAHNE.
ALTMP511 = KNA19BAHNS.
ALTMP512 = KNA19BBBNR.
ALTMP513 = KNA19BBSNR.
ALTMP514 = KNA19BEGRU.
ALTMP515 = KNA19BRSCH.
ALTMP516 = KNA19BUBKZ.
ALTMP517 = KNA19DATLT.
ALTMP518 = KNA19ERDAT.
ALTMP519 = KNA19ERNAM.
ALTMP520 = KNA19EXABL.
ALTMP521 = KNA19FAKSD.
ALTMP522 = KNA19FISKN.
ALTMP523 = KNA19KNAZK.
ALTMP524 = KNA19KNRZA.
ALTMP525 = KNA19KONZS.
ALTMP526 = KNA19KTOKD.
ALTMP527 = KNA19KUKLA.
ALTMP528 = KNA19LIFNR.
ALTMP529 = KNA19LIFSD.
ALTMP530 = KNA19LOCCO.
ALTMP531 = KNA19LOEVM.
ALTMP532 = KNA19NAME3.
ALTMP533 = KNA19NAME4.
ALTMP534 = KNA19NIELS.
ALTMP535 = KNA19ORT02.
ALTMP536 = KNA19PFACH.
ALTMP537 = KNA19PSTL2.
ALTMP538 = KNA19COUNC.
ALTMP539 = KNA19CITYC.
ALTMP540 = KNA19RPMKR.
ALTMP541 = KNA19SPERR.
ALTMP542 = KNA19SPRAS.
ALTMP543 = KNA19STCD1.
ALTMP544 = KNA19STCD2.
ALTMP545 = KNA19STKZA.
ALTMP546 = KNA19STKZU.
ALTMP547 = KNA19TELBX.
ALTMP548 = KNA19TELF2.
ALTMP549 = KNA19TELTX.
ALTMP550 = KNA19TELX1.
ALTMP551 = KNA19LZONE.
ALTMP552 = KNA19XZEMP.
ALTMP553 = KNA19VBUND.
ALTMP554 = KNA19STCEG.
ALTMP555 = KNA19DEAR1.
ALTMP556 = KNA19DEAR2.
ALTMP557 = KNA19DEAR3.
ALTMP558 = KNA19DEAR4.
ALTMP559 = KNA19DEAR5.
ALTMP560 = KNA19GFORM.
ALTMP561 = KNA19BRAN1.
ALTMP562 = KNA19BRAN2.
ALTMP563 = KNA19BRAN3.
ALTMP564 = KNA19BRAN4.
ALTMP565 = KNA19BRAN5.
ALTMP566 = KNA19EKONT.
ALTMP567 = KNA19UMSAT.
ALTMP568 = KNA19UMJAH.
ALTMP569 = KNA19UWAER.
ALTMP570 = KNA19JMZAH.
ALTMP571 = KNA19JMJAH.
ALTMP572 = KNA19KATR1.
ALTMP573 = KNA19KATR2.
ALTMP574 = KNA19KATR3.
ALTMP575 = KNA19KATR4.
ALTMP576 = KNA19KATR5.
ALTMP577 = KNA19KATR6.
ALTMP578 = KNA19KATR7.
ALTMP579 = KNA19KATR8.
ALTMP580 = KNA19KATR9.
ALTMP581 = KNA19KATR10.
ALTMP582 = KNA19STKZN.
ALTMP583 = KNA19UMSA1.
ALTMP584 = KNA19TXJCD.
ALTMP585 = KNA19PERIV.
ALTMP586 = KNA19ABRVW.
ALTMP587 = KNA19INSPBYDEBI.
ALTMP588 = KNA19INSPATDEBI.
ALTMP589 = KNA19KTOCD.
ALTMP590 = KNA19PFORT.
ALTMP591 = KNA19WERKS.
ALTMP592 = KNA19DTAMS.
ALTMP593 = KNA19DTAWS.
ALTMP594 = KNA19DUEFL.
ALTMP595 = KNA19HZUOR.
ALTMP596 = KNA19SPERZ.
ALTMP597 = KNA19ETIKG.
ALTMP598 = KNA19CIVVE.
ALTMP599 = KNA19MILVE.
ALTMP600 = KNA19KDKG1.
ALTMP601 = KNA19KDKG2.
ALTMP602 = KNA19KDKG3.
ALTMP603 = KNA19KDKG4.
ALTMP604 = KNA19KDKG5.
ALTMP605 = KNA19XKNZA.
ALTMP606 = KNA19FITYP.
ALTMP607 = KNA19STCDT.
ALTMP608 = KNA19STCD3.
ALTMP609 = KNA19STCD4.
ALTMP610 = KNA19XICMS.
ALTMP611 = KNA19XXIPI.
ALTMP612 = KNA19XSUBT.
ALTMP613 = KNA19CFOPC.
ALTMP614 = KNA19TXLW1.
ALTMP615 = KNA19TXLW2.
ALTMP616 = KNA19CCC01.
ALTMP617 = KNA19CCC02.
ALTMP618 = KNA19CCC03.
ALTMP619 = KNA19CCC04.
ALTMP620 = KNA19CASSD.
ALTMP621 = KNA19KNURL.
ALTMP622 = KNA19J_1KFREPRE.
ALTMP623 = KNA19J_1KFTBUS.
ALTMP624 = KNA19J_1KFTIND.
ALTMP625 = KNA19CONFS.
ALTMP626 = KNA19UPDAT.
ALTMP627 = KNA19UPTIM.
ALTMP628 = KNA19NODEL.
ALTMP629 = KNA19DEAR6.
ALTMP630 = KNA19/VSO/R_PALHGT.
ALTMP631 = KNA19/VSO/R_PAL_UL.
ALTMP632 = KNA19/VSO/R_PK_MAT.
ALTMP633 = KNA19/VSO/R_MATPAL.
ALTMP634 = KNA19/VSO/R_I_NO_LYR.
ALTMP635 = KNA19/VSO/R_ONE_MAT.
ALTMP636 = KNA19/VSO/R_ONE_SORT.
ALTMP637 = KNA19/VSO/R_ULD_SIDE.
ALTMP638 = KNA19/VSO/R_LOAD_PREF.
ALTMP639 = KNA19/VSO/R_DPOINT.
ALTMP640 = KNA19ALC.
ALTMP641 = KNA19PMT_OFFICE.
ALTMP642 = KNA19PSOFG.
ALTMP643 = KNA19PSOIS.
ALTMP644 = KNA19PSON1.
ALTMP645 = KNA19PSON2.
ALTMP646 = KNA19PSON3.
ALTMP647 = KNA19PSOVN.
ALTMP648 = KNA19PSOTL.
ALTMP649 = KNA19PSOHS.
ALTMP650 = KNA19PSOST.
ALTMP651 = KNA19PSOO1.
ALTMP652 = KNA19PSOO2.
ALTMP653 = KNA19PSOO3.
ALTMP654 = KNA19PSOO4.
ALTMP655 = KNA19PSOO5.
ALTMP656 = CDHDR9CHANGE_IND.
ALTMP657 = CDHDR9UDATE.
ALTMP658 = CDHDR9UTIME.
 move ALTMP491 to ITAB3-MANDT.
 move ALTMP492 to ITAB3-KUNNR.
 move ALTMP493 to ITAB3-LAND1.
 move ALTMP494 to ITAB3-NAME1.
 move ALTMP495 to ITAB3-NAME2.
 move ALTMP496 to ITAB3-ORT01.
 move ALTMP497 to ITAB3-PSTLZ.
 move ALTMP498 to ITAB3-REGIO.
 move ALTMP499 to ITAB3-SORTL.
 move ALTMP500 to ITAB3-STRAS.
 move ALTMP501 to ITAB3-TELF1.
 move ALTMP502 to ITAB3-TELFX.
 move ALTMP503 to ITAB3-XCPDK.
 move ALTMP504 to ITAB3-ADRNR.
 move ALTMP505 to ITAB3-MCOD1.
 move ALTMP506 to ITAB3-MCOD2.
 move ALTMP507 to ITAB3-MCOD3.
 move ALTMP508 to ITAB3-ANRED.
 move ALTMP509 to ITAB3-AUFSD.
 move ALTMP510 to ITAB3-BAHNE.
 move ALTMP511 to ITAB3-BAHNS.
 move ALTMP512 to ITAB3-BBBNR.
 move ALTMP513 to ITAB3-BBSNR.
 move ALTMP514 to ITAB3-BEGRU.
 move ALTMP515 to ITAB3-BRSCH.
 move ALTMP516 to ITAB3-BUBKZ.
 move ALTMP517 to ITAB3-DATLT.
 move ALTMP518 to ITAB3-ERDAT.
 move ALTMP519 to ITAB3-ERNAM.
 move ALTMP520 to ITAB3-EXABL.
 move ALTMP521 to ITAB3-FAKSD.
 move ALTMP522 to ITAB3-FISKN.
 move ALTMP523 to ITAB3-KNAZK.
 move ALTMP524 to ITAB3-KNRZA.
 move ALTMP525 to ITAB3-KONZS.
 move ALTMP526 to ITAB3-KTOKD.
 move ALTMP527 to ITAB3-KUKLA.
 move ALTMP528 to ITAB3-LIFNR.
 move ALTMP529 to ITAB3-LIFSD.
 move ALTMP530 to ITAB3-LOCCO.
 move ALTMP531 to ITAB3-LOEVM.
 move ALTMP532 to ITAB3-NAME3.
 move ALTMP533 to ITAB3-NAME4.
 move ALTMP534 to ITAB3-NIELS.
 move ALTMP535 to ITAB3-ORT02.
 move ALTMP536 to ITAB3-PFACH.
 move ALTMP537 to ITAB3-PSTL2.
 move ALTMP538 to ITAB3-COUNC.
 move ALTMP539 to ITAB3-CITYC.
 move ALTMP540 to ITAB3-RPMKR.
 move ALTMP541 to ITAB3-SPERR.
 move ALTMP542 to ITAB3-SPRAS.
 move ALTMP543 to ITAB3-STCD1.
 move ALTMP544 to ITAB3-STCD2.
 move ALTMP545 to ITAB3-STKZA.
 move ALTMP546 to ITAB3-STKZU.
 move ALTMP547 to ITAB3-TELBX.
 move ALTMP548 to ITAB3-TELF2.
 move ALTMP549 to ITAB3-TELTX.
 move ALTMP550 to ITAB3-TELX1.
 move ALTMP551 to ITAB3-LZONE.
 move ALTMP552 to ITAB3-XZEMP.
 move ALTMP553 to ITAB3-VBUND.
 move ALTMP554 to ITAB3-STCEG.
 move ALTMP555 to ITAB3-DEAR1.
 move ALTMP556 to ITAB3-DEAR2.
 move ALTMP557 to ITAB3-DEAR3.
 move ALTMP558 to ITAB3-DEAR4.
 move ALTMP559 to ITAB3-DEAR5.
 move ALTMP560 to ITAB3-GFORM.
 move ALTMP561 to ITAB3-BRAN1.
 move ALTMP562 to ITAB3-BRAN2.
 move ALTMP563 to ITAB3-BRAN3.
 move ALTMP564 to ITAB3-BRAN4.
 move ALTMP565 to ITAB3-BRAN5.
 move ALTMP566 to ITAB3-EKONT.
 move ALTMP567 to ITAB3-UMSAT.
 move ALTMP568 to ITAB3-UMJAH.
 move ALTMP569 to ITAB3-UWAER.
 move ALTMP570 to ITAB3-JMZAH.
 move ALTMP571 to ITAB3-JMJAH.
 move ALTMP572 to ITAB3-KATR1.
 move ALTMP573 to ITAB3-KATR2.
 move ALTMP574 to ITAB3-KATR3.
 move ALTMP575 to ITAB3-KATR4.
 move ALTMP576 to ITAB3-KATR5.
 move ALTMP577 to ITAB3-KATR6.
 move ALTMP578 to ITAB3-KATR7.
 move ALTMP579 to ITAB3-KATR8.
 move ALTMP580 to ITAB3-KATR9.
 move ALTMP581 to ITAB3-KATR10.
 move ALTMP582 to ITAB3-STKZN.
 move ALTMP583 to ITAB3-UMSA1.
 move ALTMP584 to ITAB3-TXJCD.
 move ALTMP585 to ITAB3-PERIV.
 move ALTMP586 to ITAB3-ABRVW.
 move ALTMP587 to ITAB3-INSPBYDEBI.
 move ALTMP588 to ITAB3-INSPATDEBI.
 move ALTMP589 to ITAB3-KTOCD.
 move ALTMP590 to ITAB3-PFORT.
 move ALTMP591 to ITAB3-WERKS.
 move ALTMP592 to ITAB3-DTAMS.
 move ALTMP593 to ITAB3-DTAWS.
 move ALTMP594 to ITAB3-DUEFL.
 move ALTMP595 to ITAB3-HZUOR.
 move ALTMP596 to ITAB3-SPERZ.
 move ALTMP597 to ITAB3-ETIKG.
 move ALTMP598 to ITAB3-CIVVE.
 move ALTMP599 to ITAB3-MILVE.
 move ALTMP600 to ITAB3-KDKG1.
 move ALTMP601 to ITAB3-KDKG2.
 move ALTMP602 to ITAB3-KDKG3.
 move ALTMP603 to ITAB3-KDKG4.
 move ALTMP604 to ITAB3-KDKG5.
 move ALTMP605 to ITAB3-XKNZA.
 move ALTMP606 to ITAB3-FITYP.
 move ALTMP607 to ITAB3-STCDT.
 move ALTMP608 to ITAB3-STCD3.
 move ALTMP609 to ITAB3-STCD4.
 move ALTMP610 to ITAB3-XICMS.
 move ALTMP611 to ITAB3-XXIPI.
 move ALTMP612 to ITAB3-XSUBT.
 move ALTMP613 to ITAB3-CFOPC.
 move ALTMP614 to ITAB3-TXLW1.
 move ALTMP615 to ITAB3-TXLW2.
 move ALTMP616 to ITAB3-CCC01.
 move ALTMP617 to ITAB3-CCC02.
 move ALTMP618 to ITAB3-CCC03.
 move ALTMP619 to ITAB3-CCC04.
 move ALTMP620 to ITAB3-CASSD.
 move ALTMP621 to ITAB3-KNURL.
 move ALTMP622 to ITAB3-J_1KFREPRE.
 move ALTMP623 to ITAB3-J_1KFTBUS.
 move ALTMP624 to ITAB3-J_1KFTIND.
 move ALTMP625 to ITAB3-CONFS.
 move ALTMP626 to ITAB3-UPDAT.
 move ALTMP627 to ITAB3-UPTIM.
 move ALTMP628 to ITAB3-NODEL.
 move ALTMP629 to ITAB3-DEAR6.
 move ALTMP630 to ITAB3-/VSO/R_PALHGT.
 move ALTMP631 to ITAB3-/VSO/R_PAL_UL.
 move ALTMP632 to ITAB3-/VSO/R_PK_MAT.
 move ALTMP633 to ITAB3-/VSO/R_MATPAL.
 move ALTMP634 to ITAB3-/VSO/R_I_NO_LYR.
 move ALTMP635 to ITAB3-/VSO/R_ONE_MAT.
 move ALTMP636 to ITAB3-/VSO/R_ONE_SORT.
 move ALTMP637 to ITAB3-/VSO/R_ULD_SIDE.
 move ALTMP638 to ITAB3-/VSO/R_LOAD_PREF.
 move ALTMP639 to ITAB3-/VSO/R_DPOINT.
 move ALTMP640 to ITAB3-ALC.
 move ALTMP641 to ITAB3-PMT_OFFICE.
 move ALTMP642 to ITAB3-PSOFG.
 move ALTMP643 to ITAB3-PSOIS.
 move ALTMP644 to ITAB3-PSON1.
 move ALTMP645 to ITAB3-PSON2.
 move ALTMP646 to ITAB3-PSON3.
 move ALTMP647 to ITAB3-PSOVN.
 move ALTMP648 to ITAB3-PSOTL.
 move ALTMP649 to ITAB3-PSOHS.
 move ALTMP650 to ITAB3-PSOST.
 move ALTMP651 to ITAB3-PSOO1.
 move ALTMP652 to ITAB3-PSOO2.
 move ALTMP653 to ITAB3-PSOO3.
 move ALTMP654 to ITAB3-PSOO4.
 move ALTMP655 to ITAB3-PSOO5.
 move ALTMP656 to ITAB3-CHANGE_IND.
 move ALTMP657 to ITAB3-UDATE.
 move ALTMP658 to ITAB3-UTIME.
 append ITAB3.
rowCount = rowCount + 1.
IF ( download = 'S' ).
 IF ( rowCount = P_PKGSZ ).
   PERFORM FORM5.
   REFRESH ITAB3.
   rowCount = 0.
 ENDIF.
ELSE.
 IF ( rowCount = 5000 ).
   PERFORM FORM5.
   REFRESH ITAB3.
   rowCount = 0.
 ENDIF.
ENDIF.
ENDSELECT.
ENDFORM.

FORM FORM5.
STATICS firstRun(1) TYPE C VALUE 'Y'.
DATA ALTMP659(3) TYPE C.
DATA ALTMP660(10) TYPE C.
DATA ALTMP661(3) TYPE C.
DATA ALTMP662(35) TYPE C.
DATA ALTMP663(35) TYPE C.
DATA ALTMP664(35) TYPE C.
DATA ALTMP665(10) TYPE C.
DATA ALTMP666(3) TYPE C.
DATA ALTMP667(10) TYPE C.
DATA ALTMP668(35) TYPE C.
DATA ALTMP669(16) TYPE C.
DATA ALTMP670(31) TYPE C.
DATA ALTMP671(1) TYPE C.
DATA ALTMP672(10) TYPE C.
DATA ALTMP673(25) TYPE C.
DATA ALTMP674(25) TYPE C.
DATA ALTMP675(25) TYPE C.
DATA ALTMP676(15) TYPE C.
DATA ALTMP677(2) TYPE C.
DATA ALTMP678(25) TYPE C.
DATA ALTMP679(25) TYPE C.
DATA ALTMP680(7) TYPE N.
DATA ALTMP681(5) TYPE N.
DATA ALTMP682(4) TYPE C.
DATA ALTMP683(4) TYPE C.
DATA ALTMP684(1) TYPE N.
DATA ALTMP685(14) TYPE C.
DATA ALTMP686 TYPE D.
DATA ALTMP687(12) TYPE C.
DATA ALTMP688(1) TYPE C.
DATA ALTMP689(2) TYPE C.
DATA ALTMP690(10) TYPE C.
DATA ALTMP691(2) TYPE C.
DATA ALTMP692(10) TYPE C.
DATA ALTMP693(10) TYPE C.
DATA ALTMP694(4) TYPE C.
DATA ALTMP695(2) TYPE C.
DATA ALTMP696(10) TYPE C.
DATA ALTMP697(2) TYPE C.
DATA ALTMP698(10) TYPE C.
DATA ALTMP699(1) TYPE C.
DATA ALTMP700(35) TYPE C.
DATA ALTMP701(35) TYPE C.
DATA ALTMP702(2) TYPE C.
DATA ALTMP703(35) TYPE C.
DATA ALTMP704(10) TYPE C.
DATA ALTMP705(10) TYPE C.
DATA ALTMP706(3) TYPE C.
DATA ALTMP707(4) TYPE C.
DATA ALTMP708(5) TYPE C.
DATA ALTMP709(1) TYPE C.
DATA ALTMP710(1) TYPE C.
DATA ALTMP711(16) TYPE C.
DATA ALTMP712(11) TYPE C.
DATA ALTMP713(1) TYPE C.
DATA ALTMP714(1) TYPE C.
DATA ALTMP715(15) TYPE C.
DATA ALTMP716(16) TYPE C.
DATA ALTMP717(30) TYPE C.
DATA ALTMP718(30) TYPE C.
DATA ALTMP719(10) TYPE C.
DATA ALTMP720(1) TYPE C.
DATA ALTMP721(6) TYPE C.
DATA ALTMP722(20) TYPE C.
DATA ALTMP723(1) TYPE C.
DATA ALTMP724(1) TYPE C.
DATA ALTMP725(1) TYPE C.
DATA ALTMP726(1) TYPE C.
DATA ALTMP727(1) TYPE C.
DATA ALTMP728(2) TYPE C.
DATA ALTMP729(10) TYPE C.
DATA ALTMP730(10) TYPE C.
DATA ALTMP731(10) TYPE C.
DATA ALTMP732(10) TYPE C.
DATA ALTMP733(10) TYPE C.
DATA ALTMP734(10) TYPE C.
DATA ALTMP735(16) TYPE P DECIMALS 2.
DATA ALTMP736(4) TYPE N.
DATA ALTMP737(5) TYPE C.
DATA ALTMP738(6) TYPE N.
DATA ALTMP739(4) TYPE N.
DATA ALTMP740(2) TYPE C.
DATA ALTMP741(2) TYPE C.
DATA ALTMP742(2) TYPE C.
DATA ALTMP743(2) TYPE C.
DATA ALTMP744(2) TYPE C.
DATA ALTMP745(3) TYPE C.
DATA ALTMP746(3) TYPE C.
DATA ALTMP747(3) TYPE C.
DATA ALTMP748(3) TYPE C.
DATA ALTMP749(3) TYPE C.
DATA ALTMP750(1) TYPE C.
DATA ALTMP751(16) TYPE P DECIMALS 2.
DATA ALTMP752(15) TYPE C.
DATA ALTMP753(2) TYPE C.
DATA ALTMP754(3) TYPE C.
DATA ALTMP755(1) TYPE C.
DATA ALTMP756(1) TYPE C.
DATA ALTMP757(4) TYPE C.
DATA ALTMP758(35) TYPE C.
DATA ALTMP759(4) TYPE C.
DATA ALTMP760(1) TYPE C.
DATA ALTMP761(2) TYPE C.
DATA ALTMP762(1) TYPE C.
DATA ALTMP763(2) TYPE N.
DATA ALTMP764(1) TYPE C.
DATA ALTMP765(10) TYPE C.
DATA ALTMP766(1) TYPE C.
DATA ALTMP767(1) TYPE C.
DATA ALTMP768(2) TYPE C.
DATA ALTMP769(2) TYPE C.
DATA ALTMP770(2) TYPE C.
DATA ALTMP771(2) TYPE C.
DATA ALTMP772(2) TYPE C.
DATA ALTMP773(1) TYPE C.
DATA ALTMP774(2) TYPE C.
DATA ALTMP775(2) TYPE C.
DATA ALTMP776(18) TYPE C.
DATA ALTMP777(18) TYPE C.
DATA ALTMP778(1) TYPE C.
DATA ALTMP779(1) TYPE C.
DATA ALTMP780(3) TYPE C.
DATA ALTMP781(2) TYPE C.
DATA ALTMP782(3) TYPE C.
DATA ALTMP783(3) TYPE C.
DATA ALTMP784(1) TYPE C.
DATA ALTMP785(1) TYPE C.
DATA ALTMP786(1) TYPE C.
DATA ALTMP787(1) TYPE C.
DATA ALTMP788(2) TYPE C.
DATA ALTMP789(132) TYPE C.
DATA ALTMP790(10) TYPE C.
DATA ALTMP791(30) TYPE C.
DATA ALTMP792(30) TYPE C.
DATA ALTMP793(1) TYPE C.
DATA ALTMP794 TYPE D.
DATA ALTMP795(24) TYPE C.
DATA ALTMP796(1) TYPE C.
DATA ALTMP797(1) TYPE C.
DATA ALTMP798(16) TYPE P DECIMALS 3.
DATA ALTMP799(3) TYPE C.
DATA ALTMP800(1) TYPE C.
DATA ALTMP801(18) TYPE C.
DATA ALTMP802(2) TYPE N.
DATA ALTMP803(1) TYPE C.
DATA ALTMP804(1) TYPE C.
DATA ALTMP805(1) TYPE N.
DATA ALTMP806(1) TYPE N.
DATA ALTMP807(10) TYPE C.
DATA ALTMP808(8) TYPE C.
DATA ALTMP809(5) TYPE C.
DATA ALTMP810(10) TYPE C.
DATA ALTMP811(20) TYPE C.
DATA ALTMP812(35) TYPE C.
DATA ALTMP813(35) TYPE C.
DATA ALTMP814(35) TYPE C.
DATA ALTMP815(35) TYPE C.
DATA ALTMP816(20) TYPE C.
DATA ALTMP817(6) TYPE C.
DATA ALTMP818(28) TYPE C.
DATA ALTMP819(50) TYPE C.
DATA ALTMP820(50) TYPE C.
DATA ALTMP821(50) TYPE C.
DATA ALTMP822(50) TYPE C.
DATA ALTMP823(50) TYPE C.
DATA ALTMP824(1) TYPE C.
DATA ALTMP825 TYPE D.
DATA ALTMP826(24) TYPE C.
DATA ALTMP827(20) TYPE C.
DATA ALTMP828(20) TYPE C.
DATA ALOJF0 TYPE C.
DATA ALOJF1 TYPE C.



LOOP AT ITAB3.
ALTMP659 = ITAB3-MANDT.
ALTMP660 = ITAB3-KUNNR.
ALTMP661 = ITAB3-LAND1.
ALTMP662 = ITAB3-NAME1.
ALTMP663 = ITAB3-NAME2.
ALTMP664 = ITAB3-ORT01.
ALTMP665 = ITAB3-PSTLZ.
ALTMP666 = ITAB3-REGIO.
ALTMP667 = ITAB3-SORTL.
ALTMP668 = ITAB3-STRAS.
ALTMP669 = ITAB3-TELF1.
ALTMP670 = ITAB3-TELFX.
ALTMP671 = ITAB3-XCPDK.
ALTMP672 = ITAB3-ADRNR.
ALTMP673 = ITAB3-MCOD1.
ALTMP674 = ITAB3-MCOD2.
ALTMP675 = ITAB3-MCOD3.
ALTMP676 = ITAB3-ANRED.
ALTMP677 = ITAB3-AUFSD.
ALTMP678 = ITAB3-BAHNE.
ALTMP679 = ITAB3-BAHNS.
ALTMP680 = ITAB3-BBBNR.
ALTMP681 = ITAB3-BBSNR.
ALTMP682 = ITAB3-BEGRU.
ALTMP683 = ITAB3-BRSCH.
ALTMP684 = ITAB3-BUBKZ.
ALTMP685 = ITAB3-DATLT.
ALTMP686 = ITAB3-ERDAT.
ALTMP687 = ITAB3-ERNAM.
ALTMP688 = ITAB3-EXABL.
ALTMP689 = ITAB3-FAKSD.
ALTMP690 = ITAB3-FISKN.
ALTMP691 = ITAB3-KNAZK.
ALTMP692 = ITAB3-KNRZA.
ALTMP693 = ITAB3-KONZS.
ALTMP694 = ITAB3-KTOKD.
ALTMP695 = ITAB3-KUKLA.
ALTMP696 = ITAB3-LIFNR.
ALTMP697 = ITAB3-LIFSD.
ALTMP698 = ITAB3-LOCCO.
ALTMP699 = ITAB3-LOEVM.
ALTMP700 = ITAB3-NAME3.
ALTMP701 = ITAB3-NAME4.
ALTMP702 = ITAB3-NIELS.
ALTMP703 = ITAB3-ORT02.
ALTMP704 = ITAB3-PFACH.
ALTMP705 = ITAB3-PSTL2.
ALTMP706 = ITAB3-COUNC.
ALTMP707 = ITAB3-CITYC.
ALTMP708 = ITAB3-RPMKR.
ALTMP709 = ITAB3-SPERR.
ALTMP710 = ITAB3-SPRAS.
ALTMP711 = ITAB3-STCD1.
ALTMP712 = ITAB3-STCD2.
ALTMP713 = ITAB3-STKZA.
ALTMP714 = ITAB3-STKZU.
ALTMP715 = ITAB3-TELBX.
ALTMP716 = ITAB3-TELF2.
ALTMP717 = ITAB3-TELTX.
ALTMP718 = ITAB3-TELX1.
ALTMP719 = ITAB3-LZONE.
ALTMP720 = ITAB3-XZEMP.
ALTMP721 = ITAB3-VBUND.
ALTMP722 = ITAB3-STCEG.
ALTMP723 = ITAB3-DEAR1.
ALTMP724 = ITAB3-DEAR2.
ALTMP725 = ITAB3-DEAR3.
ALTMP726 = ITAB3-DEAR4.
ALTMP727 = ITAB3-DEAR5.
ALTMP728 = ITAB3-GFORM.
ALTMP729 = ITAB3-BRAN1.
ALTMP730 = ITAB3-BRAN2.
ALTMP731 = ITAB3-BRAN3.
ALTMP732 = ITAB3-BRAN4.
ALTMP733 = ITAB3-BRAN5.
ALTMP734 = ITAB3-EKONT.
ALTMP735 = ITAB3-UMSAT.
ALTMP736 = ITAB3-UMJAH.
ALTMP737 = ITAB3-UWAER.
ALTMP738 = ITAB3-JMZAH.
ALTMP739 = ITAB3-JMJAH.
ALTMP740 = ITAB3-KATR1.
ALTMP741 = ITAB3-KATR2.
ALTMP742 = ITAB3-KATR3.
ALTMP743 = ITAB3-KATR4.
ALTMP744 = ITAB3-KATR5.
ALTMP745 = ITAB3-KATR6.
ALTMP746 = ITAB3-KATR7.
ALTMP747 = ITAB3-KATR8.
ALTMP748 = ITAB3-KATR9.
ALTMP749 = ITAB3-KATR10.
ALTMP750 = ITAB3-STKZN.
ALTMP751 = ITAB3-UMSA1.
ALTMP752 = ITAB3-TXJCD.
ALTMP753 = ITAB3-PERIV.
ALTMP754 = ITAB3-ABRVW.
ALTMP755 = ITAB3-INSPBYDEBI.
ALTMP756 = ITAB3-INSPATDEBI.
ALTMP757 = ITAB3-KTOCD.
ALTMP758 = ITAB3-PFORT.
ALTMP759 = ITAB3-WERKS.
ALTMP760 = ITAB3-DTAMS.
ALTMP761 = ITAB3-DTAWS.
ALTMP762 = ITAB3-DUEFL.
ALTMP763 = ITAB3-HZUOR.
ALTMP764 = ITAB3-SPERZ.
ALTMP765 = ITAB3-ETIKG.
ALTMP766 = ITAB3-CIVVE.
ALTMP767 = ITAB3-MILVE.
ALTMP768 = ITAB3-KDKG1.
ALTMP769 = ITAB3-KDKG2.
ALTMP770 = ITAB3-KDKG3.
ALTMP771 = ITAB3-KDKG4.
ALTMP772 = ITAB3-KDKG5.
ALTMP773 = ITAB3-XKNZA.
ALTMP774 = ITAB3-FITYP.
ALTMP775 = ITAB3-STCDT.
ALTMP776 = ITAB3-STCD3.
ALTMP777 = ITAB3-STCD4.
ALTMP778 = ITAB3-XICMS.
ALTMP779 = ITAB3-XXIPI.
ALTMP780 = ITAB3-XSUBT.
ALTMP781 = ITAB3-CFOPC.
ALTMP782 = ITAB3-TXLW1.
ALTMP783 = ITAB3-TXLW2.
ALTMP784 = ITAB3-CCC01.
ALTMP785 = ITAB3-CCC02.
ALTMP786 = ITAB3-CCC03.
ALTMP787 = ITAB3-CCC04.
ALTMP788 = ITAB3-CASSD.
ALTMP789 = ITAB3-KNURL.
ALTMP790 = ITAB3-J_1KFREPRE.
ALTMP791 = ITAB3-J_1KFTBUS.
ALTMP792 = ITAB3-J_1KFTIND.
ALTMP793 = ITAB3-CONFS.
ALTMP794 = ITAB3-UPDAT.
ALTMP795 = ITAB3-UPTIM.
ALTMP796 = ITAB3-NODEL.
ALTMP797 = ITAB3-DEAR6.
ALTMP798 = ITAB3-/VSO/R_PALHGT.
ALTMP799 = ITAB3-/VSO/R_PAL_UL.
ALTMP800 = ITAB3-/VSO/R_PK_MAT.
ALTMP801 = ITAB3-/VSO/R_MATPAL.
ALTMP802 = ITAB3-/VSO/R_I_NO_LYR.
ALTMP803 = ITAB3-/VSO/R_ONE_MAT.
ALTMP804 = ITAB3-/VSO/R_ONE_SORT.
ALTMP805 = ITAB3-/VSO/R_ULD_SIDE.
ALTMP806 = ITAB3-/VSO/R_LOAD_PREF.
ALTMP807 = ITAB3-/VSO/R_DPOINT.
ALTMP808 = ITAB3-ALC.
ALTMP809 = ITAB3-PMT_OFFICE.
ALTMP810 = ITAB3-PSOFG.
ALTMP811 = ITAB3-PSOIS.
ALTMP812 = ITAB3-PSON1.
ALTMP813 = ITAB3-PSON2.
ALTMP814 = ITAB3-PSON3.
ALTMP815 = ITAB3-PSOVN.
ALTMP816 = ITAB3-PSOTL.
ALTMP817 = ITAB3-PSOHS.
ALTMP818 = ITAB3-PSOST.
ALTMP819 = ITAB3-PSOO1.
ALTMP820 = ITAB3-PSOO2.
ALTMP821 = ITAB3-PSOO3.
ALTMP822 = ITAB3-PSOO4.
ALTMP823 = ITAB3-PSOO5.
ALTMP824 = ITAB3-CHANGE_IND.
ALTMP825 = ITAB3-UDATE.
ALTMP826 = ITAB3-UTIME.
ALOJF0 = 'Y'.
ALOJF1 = 'N'.
IF ( ALOJF0 = 'Y' ).

SELECT
  SORT1
  SORT2
  ADDRNUMBER
INTO CORRESPONDING FIELDS OF ADRC
FROM ADRC
WHERE ( ADDRNUMBER = ITAB3-ADRNR ).
ALTMP827 = ADRC-SORT1.
ALTMP828 = ADRC-SORT2.
ALOJF1 = 'Y'.
 move ALTMP659 to ITAB5-MANDT.
 move ALTMP660 to ITAB5-KUNNR.
 move ALTMP661 to ITAB5-LAND1.
 move ALTMP662 to ITAB5-NAME1.
 move ALTMP663 to ITAB5-NAME2.
 move ALTMP664 to ITAB5-ORT01.
 move ALTMP665 to ITAB5-PSTLZ.
 move ALTMP666 to ITAB5-REGIO.
 move ALTMP667 to ITAB5-SORTL.
 move ALTMP668 to ITAB5-STRAS.
 move ALTMP669 to ITAB5-TELF1.
 move ALTMP670 to ITAB5-TELFX.
 move ALTMP671 to ITAB5-XCPDK.
 move ALTMP672 to ITAB5-ADRNR.
 move ALTMP673 to ITAB5-MCOD1.
 move ALTMP674 to ITAB5-MCOD2.
 move ALTMP675 to ITAB5-MCOD3.
 move ALTMP676 to ITAB5-ANRED.
 move ALTMP677 to ITAB5-AUFSD.
 move ALTMP678 to ITAB5-BAHNE.
 move ALTMP679 to ITAB5-BAHNS.
 move ALTMP680 to ITAB5-BBBNR.
 move ALTMP681 to ITAB5-BBSNR.
 move ALTMP682 to ITAB5-BEGRU.
 move ALTMP683 to ITAB5-BRSCH.
 move ALTMP684 to ITAB5-BUBKZ.
 move ALTMP685 to ITAB5-DATLT.
 move ALTMP686 to ITAB5-ERDAT.
 move ALTMP687 to ITAB5-ERNAM.
 move ALTMP688 to ITAB5-EXABL.
 move ALTMP689 to ITAB5-FAKSD.
 move ALTMP690 to ITAB5-FISKN.
 move ALTMP691 to ITAB5-KNAZK.
 move ALTMP692 to ITAB5-KNRZA.
 move ALTMP693 to ITAB5-KONZS.
 move ALTMP694 to ITAB5-KTOKD.
 move ALTMP695 to ITAB5-KUKLA.
 move ALTMP696 to ITAB5-LIFNR.
 move ALTMP697 to ITAB5-LIFSD.
 move ALTMP698 to ITAB5-LOCCO.
 move ALTMP699 to ITAB5-LOEVM.
 move ALTMP700 to ITAB5-NAME3.
 move ALTMP701 to ITAB5-NAME4.
 move ALTMP702 to ITAB5-NIELS.
 move ALTMP703 to ITAB5-ORT02.
 move ALTMP704 to ITAB5-PFACH.
 move ALTMP705 to ITAB5-PSTL2.
 move ALTMP706 to ITAB5-COUNC.
 move ALTMP707 to ITAB5-CITYC.
 move ALTMP708 to ITAB5-RPMKR.
 move ALTMP709 to ITAB5-SPERR.
 move ALTMP710 to ITAB5-SPRAS.
 move ALTMP711 to ITAB5-STCD1.
 move ALTMP712 to ITAB5-STCD2.
 move ALTMP713 to ITAB5-STKZA.
 move ALTMP714 to ITAB5-STKZU.
 move ALTMP715 to ITAB5-TELBX.
 move ALTMP716 to ITAB5-TELF2.
 move ALTMP717 to ITAB5-TELTX.
 move ALTMP718 to ITAB5-TELX1.
 move ALTMP719 to ITAB5-LZONE.
 move ALTMP720 to ITAB5-XZEMP.
 move ALTMP721 to ITAB5-VBUND.
 move ALTMP722 to ITAB5-STCEG.
 move ALTMP723 to ITAB5-DEAR1.
 move ALTMP724 to ITAB5-DEAR2.
 move ALTMP725 to ITAB5-DEAR3.
 move ALTMP726 to ITAB5-DEAR4.
 move ALTMP727 to ITAB5-DEAR5.
 move ALTMP728 to ITAB5-GFORM.
 move ALTMP729 to ITAB5-BRAN1.
 move ALTMP730 to ITAB5-BRAN2.
 move ALTMP731 to ITAB5-BRAN3.
 move ALTMP732 to ITAB5-BRAN4.
 move ALTMP733 to ITAB5-BRAN5.
 move ALTMP734 to ITAB5-EKONT.
 move ALTMP735 to ITAB5-UMSAT.
 move ALTMP736 to ITAB5-UMJAH.
 move ALTMP737 to ITAB5-UWAER.
 move ALTMP738 to ITAB5-JMZAH.
 move ALTMP739 to ITAB5-JMJAH.
 move ALTMP740 to ITAB5-KATR1.
 move ALTMP741 to ITAB5-KATR2.
 move ALTMP742 to ITAB5-KATR3.
 move ALTMP743 to ITAB5-KATR4.
 move ALTMP744 to ITAB5-KATR5.
 move ALTMP745 to ITAB5-KATR6.
 move ALTMP746 to ITAB5-KATR7.
 move ALTMP747 to ITAB5-KATR8.
 move ALTMP748 to ITAB5-KATR9.
 move ALTMP749 to ITAB5-KATR10.
 move ALTMP750 to ITAB5-STKZN.
 move ALTMP751 to ITAB5-UMSA1.
 move ALTMP752 to ITAB5-TXJCD.
 move ALTMP753 to ITAB5-PERIV.
 move ALTMP754 to ITAB5-ABRVW.
 move ALTMP755 to ITAB5-INSPBYDEBI.
 move ALTMP756 to ITAB5-INSPATDEBI.
 move ALTMP757 to ITAB5-KTOCD.
 move ALTMP758 to ITAB5-PFORT.
 move ALTMP759 to ITAB5-WERKS.
 move ALTMP760 to ITAB5-DTAMS.
 move ALTMP761 to ITAB5-DTAWS.
 move ALTMP762 to ITAB5-DUEFL.
 move ALTMP763 to ITAB5-HZUOR.
 move ALTMP764 to ITAB5-SPERZ.
 move ALTMP765 to ITAB5-ETIKG.
 move ALTMP766 to ITAB5-CIVVE.
 move ALTMP767 to ITAB5-MILVE.
 move ALTMP768 to ITAB5-KDKG1.
 move ALTMP769 to ITAB5-KDKG2.
 move ALTMP770 to ITAB5-KDKG3.
 move ALTMP771 to ITAB5-KDKG4.
 move ALTMP772 to ITAB5-KDKG5.
 move ALTMP773 to ITAB5-XKNZA.
 move ALTMP774 to ITAB5-FITYP.
 move ALTMP775 to ITAB5-STCDT.
 move ALTMP776 to ITAB5-STCD3.
 move ALTMP777 to ITAB5-STCD4.
 move ALTMP778 to ITAB5-XICMS.
 move ALTMP779 to ITAB5-XXIPI.
 move ALTMP780 to ITAB5-XSUBT.
 move ALTMP781 to ITAB5-CFOPC.
 move ALTMP782 to ITAB5-TXLW1.
 move ALTMP783 to ITAB5-TXLW2.
 move ALTMP784 to ITAB5-CCC01.
 move ALTMP785 to ITAB5-CCC02.
 move ALTMP786 to ITAB5-CCC03.
 move ALTMP787 to ITAB5-CCC04.
 move ALTMP788 to ITAB5-CASSD.
 move ALTMP789 to ITAB5-KNURL.
 move ALTMP790 to ITAB5-J_1KFREPRE.
 move ALTMP791 to ITAB5-J_1KFTBUS.
 move ALTMP792 to ITAB5-J_1KFTIND.
 move ALTMP793 to ITAB5-CONFS.
 move ALTMP794 to ITAB5-UPDAT.
 move ALTMP795 to ITAB5-UPTIM.
 move ALTMP796 to ITAB5-NODEL.
 move ALTMP797 to ITAB5-DEAR6.
 move ALTMP798 to ITAB5-/VSO/R_PALHGT.
 move ALTMP799 to ITAB5-/VSO/R_PAL_UL.
 move ALTMP800 to ITAB5-/VSO/R_PK_MAT.
 move ALTMP801 to ITAB5-/VSO/R_MATPAL.
 move ALTMP802 to ITAB5-/VSO/R_I_NO_LYR.
 move ALTMP803 to ITAB5-/VSO/R_ONE_MAT.
 move ALTMP804 to ITAB5-/VSO/R_ONE_SORT.
 move ALTMP805 to ITAB5-/VSO/R_ULD_SIDE.
 move ALTMP806 to ITAB5-/VSO/R_LOAD_PREF.
 move ALTMP807 to ITAB5-/VSO/R_DPOINT.
 move ALTMP808 to ITAB5-ALC.
 move ALTMP809 to ITAB5-PMT_OFFICE.
 move ALTMP810 to ITAB5-PSOFG.
 move ALTMP811 to ITAB5-PSOIS.
 move ALTMP812 to ITAB5-PSON1.
 move ALTMP813 to ITAB5-PSON2.
 move ALTMP814 to ITAB5-PSON3.
 move ALTMP815 to ITAB5-PSOVN.
 move ALTMP816 to ITAB5-PSOTL.
 move ALTMP817 to ITAB5-PSOHS.
 move ALTMP818 to ITAB5-PSOST.
 move ALTMP819 to ITAB5-PSOO1.
 move ALTMP820 to ITAB5-PSOO2.
 move ALTMP821 to ITAB5-PSOO3.
 move ALTMP822 to ITAB5-PSOO4.
 move ALTMP823 to ITAB5-PSOO5.
 move ALTMP824 to ITAB5-CHANGE_IND.
 move ALTMP825 to ITAB5-UDATE.
 move ALTMP826 to ITAB5-UTIME.
 move ALTMP827 to ITAB5-SORT1.
 move ALTMP828 to ITAB5-SORT2.
 append ITAB5.
firstRun = 'N' .
 cntbuf = cntbuf + 1.
 if download = 'N'.
  if cntbuf > 5000.
    perform FORM6.
    clear cntbuf.
    refresh ITAB5.
    append_flag = 'A'.
  endif.
 endif.
 if download = 'S'.
  if cntbuf > P_PKGSZ.
    perform FORM6.
    clear cntbuf.
    refresh ITAB5.
  endif.
 endif.
ENDSELECT.
ENDIF.
IF ( ALOJF1 = 'N' ).
clear ADRC-SORT1.
clear ADRC-SORT2.
clear ADRC-ADDRNUMBER.
clear ALTMP827.
clear ALTMP828.
 move ALTMP659 to ITAB5-MANDT.
 move ALTMP660 to ITAB5-KUNNR.
 move ALTMP661 to ITAB5-LAND1.
 move ALTMP662 to ITAB5-NAME1.
 move ALTMP663 to ITAB5-NAME2.
 move ALTMP664 to ITAB5-ORT01.
 move ALTMP665 to ITAB5-PSTLZ.
 move ALTMP666 to ITAB5-REGIO.
 move ALTMP667 to ITAB5-SORTL.
 move ALTMP668 to ITAB5-STRAS.
 move ALTMP669 to ITAB5-TELF1.
 move ALTMP670 to ITAB5-TELFX.
 move ALTMP671 to ITAB5-XCPDK.
 move ALTMP672 to ITAB5-ADRNR.
 move ALTMP673 to ITAB5-MCOD1.
 move ALTMP674 to ITAB5-MCOD2.
 move ALTMP675 to ITAB5-MCOD3.
 move ALTMP676 to ITAB5-ANRED.
 move ALTMP677 to ITAB5-AUFSD.
 move ALTMP678 to ITAB5-BAHNE.
 move ALTMP679 to ITAB5-BAHNS.
 move ALTMP680 to ITAB5-BBBNR.
 move ALTMP681 to ITAB5-BBSNR.
 move ALTMP682 to ITAB5-BEGRU.
 move ALTMP683 to ITAB5-BRSCH.
 move ALTMP684 to ITAB5-BUBKZ.
 move ALTMP685 to ITAB5-DATLT.
 move ALTMP686 to ITAB5-ERDAT.
 move ALTMP687 to ITAB5-ERNAM.
 move ALTMP688 to ITAB5-EXABL.
 move ALTMP689 to ITAB5-FAKSD.
 move ALTMP690 to ITAB5-FISKN.
 move ALTMP691 to ITAB5-KNAZK.
 move ALTMP692 to ITAB5-KNRZA.
 move ALTMP693 to ITAB5-KONZS.
 move ALTMP694 to ITAB5-KTOKD.
 move ALTMP695 to ITAB5-KUKLA.
 move ALTMP696 to ITAB5-LIFNR.
 move ALTMP697 to ITAB5-LIFSD.
 move ALTMP698 to ITAB5-LOCCO.
 move ALTMP699 to ITAB5-LOEVM.
 move ALTMP700 to ITAB5-NAME3.
 move ALTMP701 to ITAB5-NAME4.
 move ALTMP702 to ITAB5-NIELS.
 move ALTMP703 to ITAB5-ORT02.
 move ALTMP704 to ITAB5-PFACH.
 move ALTMP705 to ITAB5-PSTL2.
 move ALTMP706 to ITAB5-COUNC.
 move ALTMP707 to ITAB5-CITYC.
 move ALTMP708 to ITAB5-RPMKR.
 move ALTMP709 to ITAB5-SPERR.
 move ALTMP710 to ITAB5-SPRAS.
 move ALTMP711 to ITAB5-STCD1.
 move ALTMP712 to ITAB5-STCD2.
 move ALTMP713 to ITAB5-STKZA.
 move ALTMP714 to ITAB5-STKZU.
 move ALTMP715 to ITAB5-TELBX.
 move ALTMP716 to ITAB5-TELF2.
 move ALTMP717 to ITAB5-TELTX.
 move ALTMP718 to ITAB5-TELX1.
 move ALTMP719 to ITAB5-LZONE.
 move ALTMP720 to ITAB5-XZEMP.
 move ALTMP721 to ITAB5-VBUND.
 move ALTMP722 to ITAB5-STCEG.
 move ALTMP723 to ITAB5-DEAR1.
 move ALTMP724 to ITAB5-DEAR2.
 move ALTMP725 to ITAB5-DEAR3.
 move ALTMP726 to ITAB5-DEAR4.
 move ALTMP727 to ITAB5-DEAR5.
 move ALTMP728 to ITAB5-GFORM.
 move ALTMP729 to ITAB5-BRAN1.
 move ALTMP730 to ITAB5-BRAN2.
 move ALTMP731 to ITAB5-BRAN3.
 move ALTMP732 to ITAB5-BRAN4.
 move ALTMP733 to ITAB5-BRAN5.
 move ALTMP734 to ITAB5-EKONT.
 move ALTMP735 to ITAB5-UMSAT.
 move ALTMP736 to ITAB5-UMJAH.
 move ALTMP737 to ITAB5-UWAER.
 move ALTMP738 to ITAB5-JMZAH.
 move ALTMP739 to ITAB5-JMJAH.
 move ALTMP740 to ITAB5-KATR1.
 move ALTMP741 to ITAB5-KATR2.
 move ALTMP742 to ITAB5-KATR3.
 move ALTMP743 to ITAB5-KATR4.
 move ALTMP744 to ITAB5-KATR5.
 move ALTMP745 to ITAB5-KATR6.
 move ALTMP746 to ITAB5-KATR7.
 move ALTMP747 to ITAB5-KATR8.
 move ALTMP748 to ITAB5-KATR9.
 move ALTMP749 to ITAB5-KATR10.
 move ALTMP750 to ITAB5-STKZN.
 move ALTMP751 to ITAB5-UMSA1.
 move ALTMP752 to ITAB5-TXJCD.
 move ALTMP753 to ITAB5-PERIV.
 move ALTMP754 to ITAB5-ABRVW.
 move ALTMP755 to ITAB5-INSPBYDEBI.
 move ALTMP756 to ITAB5-INSPATDEBI.
 move ALTMP757 to ITAB5-KTOCD.
 move ALTMP758 to ITAB5-PFORT.
 move ALTMP759 to ITAB5-WERKS.
 move ALTMP760 to ITAB5-DTAMS.
 move ALTMP761 to ITAB5-DTAWS.
 move ALTMP762 to ITAB5-DUEFL.
 move ALTMP763 to ITAB5-HZUOR.
 move ALTMP764 to ITAB5-SPERZ.
 move ALTMP765 to ITAB5-ETIKG.
 move ALTMP766 to ITAB5-CIVVE.
 move ALTMP767 to ITAB5-MILVE.
 move ALTMP768 to ITAB5-KDKG1.
 move ALTMP769 to ITAB5-KDKG2.
 move ALTMP770 to ITAB5-KDKG3.
 move ALTMP771 to ITAB5-KDKG4.
 move ALTMP772 to ITAB5-KDKG5.
 move ALTMP773 to ITAB5-XKNZA.
 move ALTMP774 to ITAB5-FITYP.
 move ALTMP775 to ITAB5-STCDT.
 move ALTMP776 to ITAB5-STCD3.
 move ALTMP777 to ITAB5-STCD4.
 move ALTMP778 to ITAB5-XICMS.
 move ALTMP779 to ITAB5-XXIPI.
 move ALTMP780 to ITAB5-XSUBT.
 move ALTMP781 to ITAB5-CFOPC.
 move ALTMP782 to ITAB5-TXLW1.
 move ALTMP783 to ITAB5-TXLW2.
 move ALTMP784 to ITAB5-CCC01.
 move ALTMP785 to ITAB5-CCC02.
 move ALTMP786 to ITAB5-CCC03.
 move ALTMP787 to ITAB5-CCC04.
 move ALTMP788 to ITAB5-CASSD.
 move ALTMP789 to ITAB5-KNURL.
 move ALTMP790 to ITAB5-J_1KFREPRE.
 move ALTMP791 to ITAB5-J_1KFTBUS.
 move ALTMP792 to ITAB5-J_1KFTIND.
 move ALTMP793 to ITAB5-CONFS.
 move ALTMP794 to ITAB5-UPDAT.
 move ALTMP795 to ITAB5-UPTIM.
 move ALTMP796 to ITAB5-NODEL.
 move ALTMP797 to ITAB5-DEAR6.
 move ALTMP798 to ITAB5-/VSO/R_PALHGT.
 move ALTMP799 to ITAB5-/VSO/R_PAL_UL.
 move ALTMP800 to ITAB5-/VSO/R_PK_MAT.
 move ALTMP801 to ITAB5-/VSO/R_MATPAL.
 move ALTMP802 to ITAB5-/VSO/R_I_NO_LYR.
 move ALTMP803 to ITAB5-/VSO/R_ONE_MAT.
 move ALTMP804 to ITAB5-/VSO/R_ONE_SORT.
 move ALTMP805 to ITAB5-/VSO/R_ULD_SIDE.
 move ALTMP806 to ITAB5-/VSO/R_LOAD_PREF.
 move ALTMP807 to ITAB5-/VSO/R_DPOINT.
 move ALTMP808 to ITAB5-ALC.
 move ALTMP809 to ITAB5-PMT_OFFICE.
 move ALTMP810 to ITAB5-PSOFG.
 move ALTMP811 to ITAB5-PSOIS.
 move ALTMP812 to ITAB5-PSON1.
 move ALTMP813 to ITAB5-PSON2.
 move ALTMP814 to ITAB5-PSON3.
 move ALTMP815 to ITAB5-PSOVN.
 move ALTMP816 to ITAB5-PSOTL.
 move ALTMP817 to ITAB5-PSOHS.
 move ALTMP818 to ITAB5-PSOST.
 move ALTMP819 to ITAB5-PSOO1.
 move ALTMP820 to ITAB5-PSOO2.
 move ALTMP821 to ITAB5-PSOO3.
 move ALTMP822 to ITAB5-PSOO4.
 move ALTMP823 to ITAB5-PSOO5.
 move ALTMP824 to ITAB5-CHANGE_IND.
 move ALTMP825 to ITAB5-UDATE.
 move ALTMP826 to ITAB5-UTIME.
 move ALTMP827 to ITAB5-SORT1.
 move ALTMP828 to ITAB5-SORT2.
 append ITAB5.
firstRun = 'N' .
 cntbuf = cntbuf + 1.
 if download = 'N'.
  if cntbuf > 5000.
    perform FORM6.
    clear cntbuf.
    refresh ITAB5.
    append_flag = 'A'.
  endif.
 endif.
 if download = 'S'.
  if cntbuf > P_PKGSZ.
    perform FORM6.
    clear cntbuf.
    refresh ITAB5.
  endif.
 endif.
ENDIF.
ENDLOOP.
ENDFORM.

FORM FORM6.
data: outfile(512), ldfile(50).
ldfile = 'CTS_LZ_SAP_CP1_KNA1'.
concatenate out_dir ldfile into outfile
  separated by '/'.
  IF DOWNLOAD = 'S'.
     DATA: error_message(700),mtext(800),iEOP(1).
     CALL FUNCTION P_SRVFM
          DESTINATION P_DEST
          KEEPING LOGICAL UNIT OF WORK
          EXPORTING
            EOS = last_batch
          IMPORTING
            EOP = iEOP
          TABLES
            E_TABLE = ITAB5
          EXCEPTIONS
            READ_ERROR = 1
            SYSTEM_FAILURE = 2
            MESSAGE error_message
            COMMUNICATION_FAILURE = 3
            MESSAGE error_message
            OTHERS = 4.

     IF sy-subrc ne 0.
        Case sy-subrc.
        when 1.
        CONCATENATE
        'Data Services read error. '
        'Check Data Services error log.'
        INTO mtext.
        MESSAGE  E240(S#) WITH mtext.
        when 2.
        CONCATENATE
'SAP System Failure while calling DS remote function: '
      error_message INTO mtext.
        MESSAGE  E240(S#) WITH mtext.
        when 3.
        CONCATENATE
'SAP System Failure while calling DS remote function: '
      error_message INTO mtext.
        MESSAGE  E240(S#) WITH mtext.
        when 4.
        MESSAGE  E240(S#) WITH
'Other SAP System Failure while calling DS remote function.'.
        endcase.
      ENDIF.
      IF iEOP = 'X'.
         PERFORM DISCONNECT_RFCDEST_FROM_PROGID.
         LEAVE PROGRAM.
       ENDIF.
  ELSE.
data  dlmtlen type i value '1'.
data xdlmtlen type i value '1'.
data:
  ht(1) type c,
  xht(1) type x,
  conv type ref to cl_abap_conv_in_ce.
xht = '7F'.
conv = cl_abap_conv_in_ce=>create(
  encoding = '1100'
  input = xht
).
call method conv->read(
  exporting n    = xdlmtlen
  importing data = ht
            len = dlmtlen
).
data return_code type i.
 perform write_delimited_file
           tables   ITAB5
           using    outfile
                    append_flag
                    ht
                    dlmtlen
                    download
           changing return_code.

  case return_code.
    when 1.
      IF EXECMODE = 'D'.
        WRITE: /5 'No line selected'.
      ELSE.
        MESSAGE E047(S#).
      ENDIF.
    when 2.
      IF EXECMODE = 'D'.
        WRITE: /5 'Open File Error -- ', 25 OUTFILE.
      ELSE.
        MESSAGE  E084(E0) WITH OUTFILE.
      ENDIF.
    when 3.
      IF EXECMODE = 'D'.
        WRITE: /5 'Data exceed length limit (8192) '.
      ELSE.
        MESSAGE  E240(S#) WITH
             'Data exceed length limit (8192) '.
      ENDIF.
    when 4.
      IF EXECMODE = 'D'.
        WRITE: /5 'Call function WS_DOWNLOAD error'.
      ELSE.
        MESSAGE  E240(S#) WITH
             'Call function WS_DOWNLOAD error'.
      ENDIF.
  endcase.
 ENDIF.
ENDFORM.

FORM SUBSTRING USING SRC BEG LEN CHANGING RET.

DATA: VA1 TYPE I.
DATA: VA2 TYPE I.
DATA: VA3 TYPE I.

VA3 = STRLEN( SRC ).

IF  BEG = 0.   VA1 = 0.
ELSE.
  IF  BEG < 0.
    VA1 = VA3 + BEG.
    IF  VA1 < 0.   VA1 = 0.
    ENDIF.
  ELSE.          VA1 = BEG - 1.
  ENDIF.
ENDIF.

IF  LEN < 0.   VA2 = 0.
ELSE.          VA2 = VA3 - VA1.
ENDIF.

IF  VA2 > LEN. VA2 = LEN.
ENDIF.

IF  VA2 < 1.   MOVE ''           TO RET.
ELSE.          MOVE SRC+VA1(VA2) TO RET.
ENDIF.

ENDFORM.

form write_delimited_file
           tables   datatab
           using    file
                    append
                    delimit
                    dlength
                    dwnload
          changing rc.

  data: type1,
        appd(1),
        temp(32),
        time1(8),
        date1(10),
        output(8192),
        rcount type i,
        offset type i,
        tablen type i,
        maxlen type i value '8192'.

  data: begin of clientab occurs 0,
             output(8192),
          end of clientab.

  field-symbols: <f>.
  field-symbols <delim1>.
  data delim2(16).
  data l_filename type string.

  appd = append.
  if appd is not initial.
     appd = 'X'.
  endif.
  move file to l_filename.
  describe table datatab lines tablen.


  if dwnload = 'Y'.
     clear clientab. refresh clientab.
     rcount = 0.
  else.
     if appd = space.
   open dataset file for output in text mode ENCODING UTF-8.
     else.
    open dataset file for appending in text mode ENCODING UTF-8.
     endif.
     if sy-subrc <> 0.
         rc = 2. exit.
     endif.
  endif.

  loop at datatab.
    clear: tablen, offset, output.
    do.
      assign component sy-index of
         structure datatab to <f>.
      if sy-subrc <> 0. exit. endif.
      if sy-index > 1.
         assign delimit(dlength) TO <delim1> CASTING TYPE C.
         delim2 = <delim1>.
         write delim2(dlength) to output+offset(dlength).
         add dlength to offset.
      endif.

      describe field <f> type type1.

      if type1 = 'I' or type1 = 'N'.
          type1 = 'P'.
      endif.

      case type1.
        when 'D'.
          if <f> = '00000000'.
             <f> = ' '.
          else.
             move <f> to time1.
             assign time1 to <f>.
          endif.
        when 'F'.
          if <f> = '0.0'.
            temp = '0.0'.
          else.
             write <f> to temp exponent 0.
          endif.
          condense temp no-gaps.
          translate temp using ',.'.
          assign temp to <f>.
        when 'P'.
          if <f> < 0.
             write '-' to output+offset(1).
             add 1 to offset.
             <f> = <f> * ( -1 ).
          endif.
          move <f> to temp.
          condense temp no-gaps.
          translate temp using ',.'.
          assign temp to <f>.
      endcase.

      sy-fdpos = strlen( <f> ).

      tablen = offset + sy-fdpos.
      if tablen > maxlen.
         rc = 3. exit.
      endif.
      write <f> to output+offset(sy-fdpos).
      add sy-fdpos to offset.
    enddo.

    if dwnload = 'Y'.
       clientab-output = output.
       append clientab.
       rcount = rcount + 1.
       if rcount >= 50.
          SY-BATCH = SPACE.
          CALL FUNCTION 'GUI_DOWNLOAD'
            EXPORTING
              FILENAME = l_filename
              FILETYPE = 'ASC'
              CODEPAGE = '4110'
              APPEND   = appd
              WRITE_FIELD_SEPARATOR = 'X'
*            IMPORTING
*              FILELENGTH =
            TABLES
              DATA_TAB = clientab
            EXCEPTIONS
              OTHERS = 1.
          if sy-subrc <> 0.
             rc = 4.
          endif.
          clear clientab. refresh clientab.
          rcount = 0. appd = 'A'.
       endif.
    else.
       transfer output to file.
    endif.
  endloop.

  if dwnload = 'Y'.
       SY-BATCH = SPACE.
       CALL FUNCTION 'GUI_DOWNLOAD'
         EXPORTING
           FILENAME = l_filename
           FILETYPE = 'ASC'
              CODEPAGE = '4110'
           APPEND   = appd
           WRITE_FIELD_SEPARATOR = 'X'
*         IMPORTING
*           FILELENGTH =
         TABLES
           DATA_TAB = clientab
         EXCEPTIONS
           OTHERS = 1.
          if sy-subrc <> 0.
             rc = 4.
          endif.
  else.
       close dataset file.
  endif.
endform.

FORM CONNECT_RFCDEST_TO_PROGID.
 INCLUDE rfctypes.

 DATA: len     type i,
       R3NAME(4),
       SYSTNR(2),
       uid     LIKE SYS_UID,
       options LIKE RFCOPT,
       isunicode  TYPE n.

 DATA: NTOTAL     LIKE GWY_STRUCT-NOREG,
       GWY_GWHOST LIKE GWY_STRUCT-GWHOST,
       GWY_GWSERV LIKE GWY_STRUCT-GWSERV,
       GWY_TPNAME LIKE GWY_SYSTEM-TPNAME.

 TABLES: RFCSI.

* Check program ID
 IF P_PROGID = SPACE.							
    RAISE INVALID_PROGRAM_ID.
 ENDIF.

* determine if the RFC destination authority
  CALL FUNCTION 'RFC_READ_TCPIP_DESTINATION'
       EXPORTING destination = P_DEST
                 authority_check = 'X'
  IMPORTING rfcunicode = isunicode.

* Use current gateway if no info exits
 IF P_GWHOST = SPACE OR P_GWSERV = SPACE.
  CALL FUNCTION 'RFC_SYSTEM_INFO'
      IMPORTING
          RFCSI_EXPORT = RFCSI.

  len = strlen( rfcsi-rfcdest ) - 2.
  systnr = rfcsi-rfcdest+len.
  len = len - 1 - 3.
  r3name = rfcsi-rfcdest+len(3).
  len = len - 1.
  options-rfcgwhost = rfcsi-rfcdest(len).
  CONCATENATE 'sapgw' SYSTNR INTO options-rfcgwserv.
 ELSE.
   options-rfcgwhost = P_GWHOST.
   options-rfcgwserv = P_GWSERV.
 ENDIF.

* Parameters for GWY function call
  GWY_GWHOST = OPTIONS-RFCGWHOST.
  GWY_GWSERV = OPTIONS-RFCGWSERV.
  GWY_TPNAME = P_PROGID.

* Check gateway and server program registered
  CALL FUNCTION 'GWY_GET_NO_REG_PROGRAMS'
     EXPORTING
        GWHOST      = GWY_GWHOST
        GWSERV      = GWY_GWSERV
        TPNAME      = GWY_TPNAME
     IMPORTING
        NOREG_TOTAL = NTOTAL
     EXCEPTIONS
        OTHERS      = 1.

  IF sy-subrc NE 0.
     raise CONNECT_TO_GATEWAY_FAILED.
  ENDIF.

  IF NTOTAL = 0.
     raise SERVER_NOT_REGISTERED.
  ENDIF.

  IF NTOTAL GT 1.
     raise DUPLICATE_REG_PROGRAMS.
  ENDIF.

* build new connection to a registered server
  options-rfcexec   = gwy_tpname.
  options-rfcgwhost = gwy_gwhost.
  options-rfcgwserv = gwy_gwserv.
  options-rfchost   = '%%RFCSERVER%%'.
  IF P_SNC_ON = 'X'.
    options-rfcsnc  = 'X'.
  ENDIF.

  CALL 'RFCControl' ID 'CODE' FIELD 'O'
                    ID 'DESTINATION' FIELD P_DEST
                    ID 'TYPE' FIELD rfctype_external_tcp
                    ID 'OPTIONS' FIELD options.

  IF sy-subrc NE 0.
     RAISE CONNECT_TO_REG_SERVER_FAILED.
   ENDIF.

* and set exclusive mode to keep server owned
  CALL FUNCTION 'SYSTEM_SET_REG_SERVER_PROPERTY'
      EXPORTING  destination = P_DEST
                 exclusiv    = 'Y'
      EXCEPTIONS connect_to_reg_server_failed = 1
                 exclusiv_not_supported       = 2.

  IF SY-SUBRC NE 0.
     CASE SY-SUBRC.
          WHEN 1.
              RAISE CONNECT_TO_REG_SERVER_FAILED.
          WHEN 2.
              RAISE EXCLUSIV_NOT_SUPPORTED.
     ENDCASE.
  ENDIF.

ENDFORM.

FORM DISCONNECT_RFCDEST_FROM_PROGID.
* set exclusive mode to E to end the session
  CALL FUNCTION 'SYSTEM_SET_REG_SERVER_PROPERTY'
     EXPORTING
         destination = P_DEST
         exclusiv    = 'E'
     EXCEPTIONS
         connect_to_reg_server_failed = 1				
         exclusiv_not_supported       = 2.
ENDFORM.
