REPORT ZAL_ABAP message-id 26 line-size 255
no standard page heading.
* YBO_SalesOrdersInv.
PARAMETER DOWNLOAD(1) DEFAULT 'N' lower case. "N-svr,Y-clnt
PARAMETER EXECMODE(1) DEFAULT 'B' lower case. "D-dlg,B-btch
PARAMETER OUT_DIR(48) DEFAULT "output file dir
*'/var/load/CP1/UK/read' LOWER CASE.
'/var/load/xxx/UK/read' LOWER CASE.
PARAMETER IN_DIR(48) DEFAULT "input file dir
*'/var/load/CP1/UK/read' LOWER CASE.
'/var/load/xxx/UK/read' LOWER CASE.

PARAMETER P_DF_VK(40) DEFAULT "ABAP data flow object key
'' lower case.
PARAMETER P_DI_GEN(40) DEFAULT "DI version that generated ABAP
'' lower case.

*** Machine generated ABAP. Do not modify.            ***
*** # Copyright Business Objects S.A.  All rights reserved. ***
*
* Date Time:
*    06/09/15 04:36:39
* SAP used for generated this ABAP:
*    Release: 701
*    Host   : 10.25.3.26
*
* ABAP Dataflow Name:
*    DF_SDMM_R3_SalesOrdersInv
* ABAP Dataflow comments:
*    SAP source : YSE_SD_SALES_INV
* ABAP program name in SAP:
*    YBO_SALESORDERSINV
* Generated ABAP file name:
*    D:/Data/SAPLogistics/PRD/ABAP/YBO_SalesOrdersInv
TABLES YSE_SD_SALES_INV.
TABLES TVKBT.

DATA: begin of ITAB3 occurs 0,
MANDT(3) TYPE C,
VBELN_ORD(10) TYPE C,
POSNR_ORD(6) TYPE N,
VBELN_DEL(10) TYPE C,
POSNR_DEL(6) TYPE N,
VBELN_INV(10) TYPE C,
POSNR_INV(6) TYPE N,
VKORG(4) TYPE C,
VTWEG(2) TYPE C,
SPART(2) TYPE C,
SPARTD(2) TYPE C,
VKBUR(4) TYPE C,
VKGRP(3) TYPE C,
PRCTR(10) TYPE C,
WW002(3) TYPE C,
WW006(4) TYPE C,
WW007(4) TYPE C,
CMGST(1) TYPE C,
BSTKD(35) TYPE C,
BZIRK(6) TYPE C,
VDATU TYPE D,
EDATU TYPE D,
EBELN(10) TYPE C,
EBELP(5) TYPE N,
ERDAT_ORD TYPE D,
ERNAM(12) TYPE C,
AUART(4) TYPE C,
BNDDT TYPE D,
WERKS(4) TYPE C,
MATNR(18) TYPE C,
MATKL(9) TYPE C,
PSTYV(4) TYPE C,
MTPOS(4) TYPE C,
KUNAG(10) TYPE C,
KUNWE(10) TYPE C,
SH_NAICS(10) TYPE C,
KUNRE(10) TYPE C,
HKUNNR(10) TYPE C,
BRAN1(10) TYPE C,
FAKSK(2) TYPE C,
LIFSK(2) TYPE C,
ERDAT TYPE D,
PARVW_VE(2) TYPE C,
PERNR_VE(8) TYPE N,
PARVW_ZX(2) TYPE C,
PERNR_ZX(8) TYPE N,
PARVW_ZY(2) TYPE C,
PERNR_ZY(8) TYPE N,
KWERT_ZPRO(16) TYPE P DECIMALS 2,
WAERK_ZPRO(5) TYPE C,
KZWI3_ORD(16) TYPE P DECIMALS 2,
WAERK_ORD(5) TYPE C,
KZWI3_ORD_CC(16) TYPE P DECIMALS 2,
ZUNITPR(16) TYPE P DECIMALS 2,
ZUNITPRCURR(5) TYPE C,
ZUNITPR_CC(16) TYPE P DECIMALS 2,
KWERT_ZPRS(16) TYPE P DECIMALS 2,
WAERK_ZPRS(5) TYPE C,
ZPROFIT(16) TYPE P DECIMALS 2,
ZPROFCURR(5) TYPE C,
ZPROFPERC(16) TYPE P DECIMALS 2,
KWMENG(16) TYPE P DECIMALS 3,
VRKME_ORD(3) TYPE C,
LIFNR(10) TYPE C,
LFIMG(16) TYPE P DECIMALS 3,
VRKME_DEL(3) TYPE C,
ZQUANT_DEL(16) TYPE P DECIMALS 3,
ZVRKME_DEL(3) TYPE C,
WADAT_IST TYPE D,
FKART(4) TYPE C,
FAREG(1) TYPE C,
FKIMG(16) TYPE P DECIMALS 3,
VRKME_INV(3) TYPE C,
KZWI3_INV(16) TYPE P DECIMALS 2,
WAERK_INV(5) TYPE C,
KZWI3_INV_CC(16) TYPE P DECIMALS 2,
ERDAT_INV TYPE D,
FKDAT TYPE D,
ZQUANT_INV(16) TYPE P DECIMALS 3,
ZVRKME_INV(3) TYPE C,
ZAMOUNT(16) TYPE P DECIMALS 2,
ZWAERK_INV(5) TYPE C,
FPROZ(16) TYPE P DECIMALS 4,
ZFPLVAL(16) TYPE P DECIMALS 2,
FAKSP(2) TYPE C,
KWMENG_OH(16) TYPE P DECIMALS 3,
KZWI3_OH(16) TYPE P DECIMALS 2,
KZWI3_OH_CC(16) TYPE P DECIMALS 2,
KWERT_COS_OH(16) TYPE P DECIMALS 2,
ZPROFIT_OH(16) TYPE P DECIMALS 2,
ZPROFPC_OH(16) TYPE P DECIMALS 2,
KWERT_COS_IN(16) TYPE P DECIMALS 2,
ZPROFIT_IN(16) TYPE P DECIMALS 2,
ZPROFPC_IN(16) TYPE P DECIMALS 2,
ZUONR(18) TYPE C,
ABGRU(2) TYPE C,
ECCUSTN(10) TYPE C,
ECPARTF(2) TYPE C,
ECNAICS(10) TYPE C,
ECHLCUS(10) TYPE C,
ZPROFIT_CC(16) TYPE P DECIMALS 2,
WAERK_CC(5) TYPE C,
COUNTRY(3) TYPE C,
BELNR(10) TYPE C,
MSTAV(2) TYPE C,
MMSTA(2) TYPE C,
KZAUS(1) TYPE C,
FKSAK(1) TYPE C,
GBSTK(1) TYPE C,
WBSTK(1) TYPE C,
LFSTA(1) TYPE C,
GBSTA(1) TYPE C,
ZTERM(4) TYPE C,
KTGRD(2) TYPE C,
ZFREIGHT_HDR(16) TYPE P DECIMALS 2,
ZFR_HDR_CC(5) TYPE C,
ZFREIGHT_ITM(16) TYPE P DECIMALS 2,
ZFR_ITM_CC(5) TYPE C,
VKBURTXT(20) TYPE C.
DATA: end of ITAB3.

data: append_flag(1) value ' ',
      cntbuf type i,
      delimleng type i.

CONSTANTS C_DF_VK(40) VALUE '7895'.
CONSTANTS C_DI_GEN(40) VALUE '12.2.2.3'.
DATA WARN_MSG(50).
DATA: gv_directory     TYPE epsdirnam  VALUE '/var/load/xxx/UK/read/',
      gv_logsys        like tbdlst-logsys.

start-of-selection.
* Logical system
  CALL FUNCTION 'OWN_LOGICAL_SYSTEM_GET'
    IMPORTING
      own_logical_system             = gv_logsys
    EXCEPTIONS
      own_logical_system_not_defined = 1
      OTHERS                         = 2.
  IF sy-subrc <> 0.
    MESSAGE ID sy-msgid TYPE 'E' NUMBER sy-msgno
         WITH sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4.
    STOP.
  ENDIF.
  REPLACE 'xxx' IN out_dir WITH gv_logsys(3).
  REPLACE 'xxx' IN in_dir WITH gv_logsys(3).



PERFORM FORM3.
PERFORM FORM4.
FREE ITAB3.

end-of-selection.

CLEAR WARN_MSG.

IF NOT P_DF_VK IS INITIAL.
  IF P_DF_VK <> C_DF_VK.
     CONCATENATE '$$Warning$'
                 C_DF_VK
                 '$' INTO WARN_MSG.
  ENDIF.
ENDIF.
IF NOT P_DI_GEN IS INITIAL.
  IF P_DI_GEN <> C_DI_GEN.
     IF WARN_MSG IS INITIAL.
       CONCATENATE '$$Warning$$'
                   C_DI_GEN
                   INTO WARN_MSG.
     ELSE.
       CONCATENATE WARN_MSG
                   C_DI_GEN
                   INTO WARN_MSG.
     ENDIF.
  ENDIF.
ENDIF.

IF NOT WARN_MSG IS INITIAL.
  IF EXECMODE = 'D'.
    WRITE WARN_MSG.
    NEW-LINE.
  ELSE.
    MESSAGE S000 with WARN_MSG.
  ENDIF.
ENDIF.


write  '* Program Complete *'.
write  '# Copyright Business Objects S.A.  All rights reserved.'
.

FORM FORM3.
DATA ALTMP1(3) TYPE C.
DATA ALTMP2(10) TYPE C.
DATA ALTMP3(6) TYPE N.
DATA ALTMP4(10) TYPE C.
DATA ALTMP5(6) TYPE N.
DATA ALTMP6(10) TYPE C.
DATA ALTMP7(6) TYPE N.
DATA ALTMP8(4) TYPE C.
DATA ALTMP9(2) TYPE C.
DATA ALTMP10(2) TYPE C.
DATA ALTMP11(2) TYPE C.
DATA ALTMP12(4) TYPE C.
DATA ALTMP13(3) TYPE C.
DATA ALTMP14(10) TYPE C.
DATA ALTMP15(3) TYPE C.
DATA ALTMP16(4) TYPE C.
DATA ALTMP17(4) TYPE C.
DATA ALTMP18(1) TYPE C.
DATA ALTMP19(35) TYPE C.
DATA ALTMP20(6) TYPE C.
DATA ALTMP21 TYPE D.
DATA ALTMP22 TYPE D.
DATA ALTMP23(10) TYPE C.
DATA ALTMP24(5) TYPE N.
DATA ALTMP25 TYPE D.
DATA ALTMP26(12) TYPE C.
DATA ALTMP27(4) TYPE C.
DATA ALTMP28 TYPE D.
DATA ALTMP29(4) TYPE C.
DATA ALTMP30(18) TYPE C.
DATA ALTMP31(9) TYPE C.
DATA ALTMP32(4) TYPE C.
DATA ALTMP33(4) TYPE C.
DATA ALTMP34(10) TYPE C.
DATA ALTMP35(10) TYPE C.
DATA ALTMP36(10) TYPE C.
DATA ALTMP37(10) TYPE C.
DATA ALTMP38(10) TYPE C.
DATA ALTMP39(10) TYPE C.
DATA ALTMP40(2) TYPE C.
DATA ALTMP41(2) TYPE C.
DATA ALTMP42 TYPE D.
DATA ALTMP43(2) TYPE C.
DATA ALTMP44(8) TYPE N.
DATA ALTMP45(2) TYPE C.
DATA ALTMP46(8) TYPE N.
DATA ALTMP47(2) TYPE C.
DATA ALTMP48(8) TYPE N.
DATA ALTMP49(16) TYPE P DECIMALS 2.
DATA ALTMP50(5) TYPE C.
DATA ALTMP51(16) TYPE P DECIMALS 2.
DATA ALTMP52(5) TYPE C.
DATA ALTMP53(16) TYPE P DECIMALS 2.
DATA ALTMP54(16) TYPE P DECIMALS 2.
DATA ALTMP55(5) TYPE C.
DATA ALTMP56(16) TYPE P DECIMALS 2.
DATA ALTMP57(16) TYPE P DECIMALS 2.
DATA ALTMP58(5) TYPE C.
DATA ALTMP59(16) TYPE P DECIMALS 2.
DATA ALTMP60(5) TYPE C.
DATA ALTMP61(16) TYPE P DECIMALS 2.
DATA ALTMP62(16) TYPE P DECIMALS 3.
DATA ALTMP63(3) TYPE C.
DATA ALTMP64(10) TYPE C.
DATA ALTMP65(16) TYPE P DECIMALS 3.
DATA ALTMP66(3) TYPE C.
DATA ALTMP67(16) TYPE P DECIMALS 3.
DATA ALTMP68(3) TYPE C.
DATA ALTMP69 TYPE D.
DATA ALTMP70(4) TYPE C.
DATA ALTMP71(1) TYPE C.
DATA ALTMP72(16) TYPE P DECIMALS 3.
DATA ALTMP73(3) TYPE C.
DATA ALTMP74(16) TYPE P DECIMALS 2.
DATA ALTMP75(5) TYPE C.
DATA ALTMP76(16) TYPE P DECIMALS 2.
DATA ALTMP77 TYPE D.
DATA ALTMP78 TYPE D.
DATA ALTMP79(16) TYPE P DECIMALS 3.
DATA ALTMP80(3) TYPE C.
DATA ALTMP81(16) TYPE P DECIMALS 2.
DATA ALTMP82(5) TYPE C.
DATA ALTMP83(16) TYPE P DECIMALS 4.
DATA ALTMP84(16) TYPE P DECIMALS 2.
DATA ALTMP85(2) TYPE C.
DATA ALTMP86(16) TYPE P DECIMALS 3.
DATA ALTMP87(16) TYPE P DECIMALS 2.
DATA ALTMP88(16) TYPE P DECIMALS 2.
DATA ALTMP89(16) TYPE P DECIMALS 2.
DATA ALTMP90(16) TYPE P DECIMALS 2.
DATA ALTMP91(16) TYPE P DECIMALS 2.
DATA ALTMP92(16) TYPE P DECIMALS 2.
DATA ALTMP93(16) TYPE P DECIMALS 2.
DATA ALTMP94(16) TYPE P DECIMALS 2.
DATA ALTMP95(18) TYPE C.
DATA ALTMP96(2) TYPE C.
DATA ALTMP97(10) TYPE C.
DATA ALTMP98(2) TYPE C.
DATA ALTMP99(10) TYPE C.
DATA ALTMP100(10) TYPE C.
DATA ALTMP101(16) TYPE P DECIMALS 2.
DATA ALTMP102(5) TYPE C.
DATA ALTMP103(3) TYPE C.
DATA ALTMP104(10) TYPE C.
DATA ALTMP105(2) TYPE C.
DATA ALTMP106(2) TYPE C.
DATA ALTMP107(1) TYPE C.
DATA ALTMP108(1) TYPE C.
DATA ALTMP109(1) TYPE C.
DATA ALTMP110(1) TYPE C.
DATA ALTMP111(1) TYPE C.
DATA ALTMP112(1) TYPE C.
DATA ALTMP113(4) TYPE C.
DATA ALTMP114(2) TYPE C.
DATA ALTMP115(16) TYPE P DECIMALS 2.
DATA ALTMP116(5) TYPE C.
DATA ALTMP117(16) TYPE P DECIMALS 2.
DATA ALTMP118(5) TYPE C.
DATA ALTMP119(20) TYPE C.

DATA YSE_SD_SA_019MANDT LIKE YSE_SD_SALES_INV-MANDT.
DATA YSE_SD_SA_019VBELN_ORD LIKE YSE_SD_SALES_INV-VBELN_ORD.
DATA YSE_SD_SA_019POSNR_ORD LIKE YSE_SD_SALES_INV-POSNR_ORD.
DATA YSE_SD_SA_019VBELN_DEL LIKE YSE_SD_SALES_INV-VBELN_DEL.
DATA YSE_SD_SA_019POSNR_DEL LIKE YSE_SD_SALES_INV-POSNR_DEL.
DATA YSE_SD_SA_019VBELN_INV LIKE YSE_SD_SALES_INV-VBELN_INV.
DATA YSE_SD_SA_019POSNR_INV LIKE YSE_SD_SALES_INV-POSNR_INV.
DATA YSE_SD_SA_019VKORG LIKE YSE_SD_SALES_INV-VKORG.
DATA YSE_SD_SA_019VTWEG LIKE YSE_SD_SALES_INV-VTWEG.
DATA YSE_SD_SA_019SPART LIKE YSE_SD_SALES_INV-SPART.
DATA YSE_SD_SA_019SPARTD LIKE YSE_SD_SALES_INV-SPARTD.
DATA YSE_SD_SA_019VKBUR LIKE YSE_SD_SALES_INV-VKBUR.
DATA YSE_SD_SA_019VKGRP LIKE YSE_SD_SALES_INV-VKGRP.
DATA YSE_SD_SA_019PRCTR LIKE YSE_SD_SALES_INV-PRCTR.
DATA YSE_SD_SA_019WW002 LIKE YSE_SD_SALES_INV-WW002.
DATA YSE_SD_SA_019WW006 LIKE YSE_SD_SALES_INV-WW006.
DATA YSE_SD_SA_019WW007 LIKE YSE_SD_SALES_INV-WW007.
DATA YSE_SD_SA_019CMGST LIKE YSE_SD_SALES_INV-CMGST.
DATA YSE_SD_SA_019BSTKD LIKE YSE_SD_SALES_INV-BSTKD.
DATA YSE_SD_SA_019BZIRK LIKE YSE_SD_SALES_INV-BZIRK.
DATA YSE_SD_SA_019VDATU LIKE YSE_SD_SALES_INV-VDATU.
DATA YSE_SD_SA_019EDATU LIKE YSE_SD_SALES_INV-EDATU.
DATA YSE_SD_SA_019EBELN LIKE YSE_SD_SALES_INV-EBELN.
DATA YSE_SD_SA_019EBELP LIKE YSE_SD_SALES_INV-EBELP.
DATA YSE_SD_SA_019ERDAT_ORD LIKE YSE_SD_SALES_INV-ERDAT_ORD.
DATA YSE_SD_SA_019ERNAM LIKE YSE_SD_SALES_INV-ERNAM.
DATA YSE_SD_SA_019AUART LIKE YSE_SD_SALES_INV-AUART.
DATA YSE_SD_SA_019BNDDT LIKE YSE_SD_SALES_INV-BNDDT.
DATA YSE_SD_SA_019WERKS LIKE YSE_SD_SALES_INV-WERKS.
DATA YSE_SD_SA_019MATNR LIKE YSE_SD_SALES_INV-MATNR.
DATA YSE_SD_SA_019MATKL LIKE YSE_SD_SALES_INV-MATKL.
DATA YSE_SD_SA_019PSTYV LIKE YSE_SD_SALES_INV-PSTYV.
DATA YSE_SD_SA_019MTPOS LIKE YSE_SD_SALES_INV-MTPOS.
DATA YSE_SD_SA_019KUNAG LIKE YSE_SD_SALES_INV-KUNAG.
DATA YSE_SD_SA_019KUNWE LIKE YSE_SD_SALES_INV-KUNWE.
DATA YSE_SD_SA_019SH_NAICS LIKE YSE_SD_SALES_INV-SH_NAICS.
DATA YSE_SD_SA_019KUNRE LIKE YSE_SD_SALES_INV-KUNRE.
DATA YSE_SD_SA_019HKUNNR LIKE YSE_SD_SALES_INV-HKUNNR.
DATA YSE_SD_SA_019BRAN1 LIKE YSE_SD_SALES_INV-BRAN1.
DATA YSE_SD_SA_019FAKSK LIKE YSE_SD_SALES_INV-FAKSK.
DATA YSE_SD_SA_019LIFSK LIKE YSE_SD_SALES_INV-LIFSK.
DATA YSE_SD_SA_019ERDAT LIKE YSE_SD_SALES_INV-ERDAT.
DATA YSE_SD_SA_019PARVW_VE LIKE YSE_SD_SALES_INV-PARVW_VE.
DATA YSE_SD_SA_019PERNR_VE LIKE YSE_SD_SALES_INV-PERNR_VE.
DATA YSE_SD_SA_019PARVW_ZX LIKE YSE_SD_SALES_INV-PARVW_ZX.
DATA YSE_SD_SA_019PERNR_ZX LIKE YSE_SD_SALES_INV-PERNR_ZX.
DATA YSE_SD_SA_019PARVW_ZY LIKE YSE_SD_SALES_INV-PARVW_ZY.
DATA YSE_SD_SA_019PERNR_ZY LIKE YSE_SD_SALES_INV-PERNR_ZY.
DATA YSE_SD_SA_019KWERT_ZPRO LIKE YSE_SD_SALES_INV-KWERT_ZPRO.
DATA YSE_SD_SA_019WAERK_ZPRO LIKE YSE_SD_SALES_INV-WAERK_ZPRO.
DATA YSE_SD_SA_019KZWI3_ORD LIKE YSE_SD_SALES_INV-KZWI3_ORD.
DATA YSE_SD_SA_019WAERK_ORD LIKE YSE_SD_SALES_INV-WAERK_ORD.
DATA YSE_SD_SA_019KZWI3_ORD_CC LIKE
YSE_SD_SALES_INV-KZWI3_ORD_CC.
DATA YSE_SD_SA_019ZUNITPR LIKE YSE_SD_SALES_INV-ZUNITPR.
DATA YSE_SD_SA_019ZUNITPRCURR LIKE YSE_SD_SALES_INV-ZUNITPRCURR.
DATA YSE_SD_SA_019ZUNITPR_CC LIKE YSE_SD_SALES_INV-ZUNITPR_CC.
DATA YSE_SD_SA_019KWERT_ZPRS LIKE YSE_SD_SALES_INV-KWERT_ZPRS.
DATA YSE_SD_SA_019WAERK_ZPRS LIKE YSE_SD_SALES_INV-WAERK_ZPRS.
DATA YSE_SD_SA_019ZPROFIT LIKE YSE_SD_SALES_INV-ZPROFIT.
DATA YSE_SD_SA_019ZPROFCURR LIKE YSE_SD_SALES_INV-ZPROFCURR.
DATA YSE_SD_SA_019ZPROFPERC LIKE YSE_SD_SALES_INV-ZPROFPERC.
DATA YSE_SD_SA_019KWMENG LIKE YSE_SD_SALES_INV-KWMENG.
DATA YSE_SD_SA_019VRKME_ORD LIKE YSE_SD_SALES_INV-VRKME_ORD.
DATA YSE_SD_SA_019LIFNR LIKE YSE_SD_SALES_INV-LIFNR.
DATA YSE_SD_SA_019LFIMG LIKE YSE_SD_SALES_INV-LFIMG.
DATA YSE_SD_SA_019VRKME_DEL LIKE YSE_SD_SALES_INV-VRKME_DEL.
DATA YSE_SD_SA_019ZQUANT_DEL LIKE YSE_SD_SALES_INV-ZQUANT_DEL.
DATA YSE_SD_SA_019ZVRKME_DEL LIKE YSE_SD_SALES_INV-ZVRKME_DEL.
DATA YSE_SD_SA_019WADAT_IST LIKE YSE_SD_SALES_INV-WADAT_IST.
DATA YSE_SD_SA_019FKART LIKE YSE_SD_SALES_INV-FKART.
DATA YSE_SD_SA_019FAREG LIKE YSE_SD_SALES_INV-FAREG.
DATA YSE_SD_SA_019FKIMG LIKE YSE_SD_SALES_INV-FKIMG.
DATA YSE_SD_SA_019VRKME_INV LIKE YSE_SD_SALES_INV-VRKME_INV.
DATA YSE_SD_SA_019KZWI3_INV LIKE YSE_SD_SALES_INV-KZWI3_INV.
DATA YSE_SD_SA_019WAERK_INV LIKE YSE_SD_SALES_INV-WAERK_INV.
DATA YSE_SD_SA_019KZWI3_INV_CC LIKE
YSE_SD_SALES_INV-KZWI3_INV_CC.
DATA YSE_SD_SA_019ERDAT_INV LIKE YSE_SD_SALES_INV-ERDAT_INV.
DATA YSE_SD_SA_019FKDAT LIKE YSE_SD_SALES_INV-FKDAT.
DATA YSE_SD_SA_019ZQUANT_INV LIKE YSE_SD_SALES_INV-ZQUANT_INV.
DATA YSE_SD_SA_019ZVRKME_INV LIKE YSE_SD_SALES_INV-ZVRKME_INV.
DATA YSE_SD_SA_019ZAMOUNT LIKE YSE_SD_SALES_INV-ZAMOUNT.
DATA YSE_SD_SA_019ZWAERK_INV LIKE YSE_SD_SALES_INV-ZWAERK_INV.
DATA YSE_SD_SA_019FPROZ LIKE YSE_SD_SALES_INV-FPROZ.
DATA YSE_SD_SA_019ZFPLVAL LIKE YSE_SD_SALES_INV-ZFPLVAL.
DATA YSE_SD_SA_019FAKSP LIKE YSE_SD_SALES_INV-FAKSP.
DATA YSE_SD_SA_019KWMENG_OH LIKE YSE_SD_SALES_INV-KWMENG_OH.
DATA YSE_SD_SA_019KZWI3_OH LIKE YSE_SD_SALES_INV-KZWI3_OH.
DATA YSE_SD_SA_019KZWI3_OH_CC LIKE YSE_SD_SALES_INV-KZWI3_OH_CC.
DATA YSE_SD_SA_019KWERT_COS_OH LIKE
YSE_SD_SALES_INV-KWERT_COS_OH.
DATA YSE_SD_SA_019ZPROFIT_OH LIKE YSE_SD_SALES_INV-ZPROFIT_OH.
DATA YSE_SD_SA_019ZPROFPC_OH LIKE YSE_SD_SALES_INV-ZPROFPC_OH.
DATA YSE_SD_SA_019KWERT_COS_IN LIKE
YSE_SD_SALES_INV-KWERT_COS_IN.
DATA YSE_SD_SA_019ZPROFIT_IN LIKE YSE_SD_SALES_INV-ZPROFIT_IN.
DATA YSE_SD_SA_019ZPROFPC_IN LIKE YSE_SD_SALES_INV-ZPROFPC_IN.
DATA YSE_SD_SA_019ZUONR LIKE YSE_SD_SALES_INV-ZUONR.
DATA YSE_SD_SA_019ABGRU LIKE YSE_SD_SALES_INV-ABGRU.
DATA YSE_SD_SA_019ECCUSTN LIKE YSE_SD_SALES_INV-ECCUSTN.
DATA YSE_SD_SA_019ECPARTF LIKE YSE_SD_SALES_INV-ECPARTF.
DATA YSE_SD_SA_019ECNAICS LIKE YSE_SD_SALES_INV-ECNAICS.
DATA YSE_SD_SA_019ECHLCUS LIKE YSE_SD_SALES_INV-ECHLCUS.
DATA YSE_SD_SA_019ZPROFIT_CC LIKE YSE_SD_SALES_INV-ZPROFIT_CC.
DATA YSE_SD_SA_019WAERK_CC LIKE YSE_SD_SALES_INV-WAERK_CC.
DATA YSE_SD_SA_019COUNTRY LIKE YSE_SD_SALES_INV-COUNTRY.
DATA YSE_SD_SA_019BELNR LIKE YSE_SD_SALES_INV-BELNR.
DATA YSE_SD_SA_019MSTAV LIKE YSE_SD_SALES_INV-MSTAV.
DATA YSE_SD_SA_019MMSTA LIKE YSE_SD_SALES_INV-MMSTA.
DATA YSE_SD_SA_019KZAUS LIKE YSE_SD_SALES_INV-KZAUS.
DATA YSE_SD_SA_019FKSAK LIKE YSE_SD_SALES_INV-FKSAK.
DATA YSE_SD_SA_019GBSTK LIKE YSE_SD_SALES_INV-GBSTK.
DATA YSE_SD_SA_019WBSTK LIKE YSE_SD_SALES_INV-WBSTK.
DATA YSE_SD_SA_019LFSTA LIKE YSE_SD_SALES_INV-LFSTA.
DATA YSE_SD_SA_019GBSTA LIKE YSE_SD_SALES_INV-GBSTA.
DATA YSE_SD_SA_019ZTERM LIKE YSE_SD_SALES_INV-ZTERM.
DATA YSE_SD_SA_019KTGRD LIKE YSE_SD_SALES_INV-KTGRD.
DATA YSE_SD_SA_019ZFREIGHT_HDR LIKE
YSE_SD_SALES_INV-ZFREIGHT_HDR.
DATA YSE_SD_SA_019ZFR_HDR_CC LIKE YSE_SD_SALES_INV-ZFR_HDR_CC.
DATA YSE_SD_SA_019ZFREIGHT_ITM LIKE
YSE_SD_SALES_INV-ZFREIGHT_ITM.
DATA YSE_SD_SA_019ZFR_ITM_CC LIKE YSE_SD_SALES_INV-ZFR_ITM_CC.
DATA TVKBT9BEZEI LIKE TVKBT-BEZEI.
DATA TVKBT9SPRAS LIKE TVKBT-SPRAS.
DATA TVKBT9VKBUR LIKE TVKBT-VKBUR.



SELECT
  YSE_SD_SA_019~MANDT
  YSE_SD_SA_019~VBELN_ORD
  YSE_SD_SA_019~POSNR_ORD
  YSE_SD_SA_019~VBELN_DEL
  YSE_SD_SA_019~POSNR_DEL
  YSE_SD_SA_019~VBELN_INV
  YSE_SD_SA_019~POSNR_INV
  YSE_SD_SA_019~VKORG
  YSE_SD_SA_019~VTWEG
  YSE_SD_SA_019~SPART
  YSE_SD_SA_019~SPARTD
  YSE_SD_SA_019~VKBUR
  YSE_SD_SA_019~VKGRP
  YSE_SD_SA_019~PRCTR
  YSE_SD_SA_019~WW002
  YSE_SD_SA_019~WW006
  YSE_SD_SA_019~WW007
  YSE_SD_SA_019~CMGST
  YSE_SD_SA_019~BSTKD
  YSE_SD_SA_019~BZIRK
  YSE_SD_SA_019~VDATU
  YSE_SD_SA_019~EDATU
  YSE_SD_SA_019~EBELN
  YSE_SD_SA_019~EBELP
  YSE_SD_SA_019~ERDAT_ORD
  YSE_SD_SA_019~ERNAM
  YSE_SD_SA_019~AUART
  YSE_SD_SA_019~BNDDT
  YSE_SD_SA_019~WERKS
  YSE_SD_SA_019~MATNR
  YSE_SD_SA_019~MATKL
  YSE_SD_SA_019~PSTYV
  YSE_SD_SA_019~MTPOS
  YSE_SD_SA_019~KUNAG
  YSE_SD_SA_019~KUNWE
  YSE_SD_SA_019~SH_NAICS
  YSE_SD_SA_019~KUNRE
  YSE_SD_SA_019~HKUNNR
  YSE_SD_SA_019~BRAN1
  YSE_SD_SA_019~FAKSK
  YSE_SD_SA_019~LIFSK
  YSE_SD_SA_019~ERDAT
  YSE_SD_SA_019~PARVW_VE
  YSE_SD_SA_019~PERNR_VE
  YSE_SD_SA_019~PARVW_ZX
  YSE_SD_SA_019~PERNR_ZX
  YSE_SD_SA_019~PARVW_ZY
  YSE_SD_SA_019~PERNR_ZY
  YSE_SD_SA_019~KWERT_ZPRO
  YSE_SD_SA_019~WAERK_ZPRO
  YSE_SD_SA_019~KZWI3_ORD
  YSE_SD_SA_019~WAERK_ORD
  YSE_SD_SA_019~KZWI3_ORD_CC
  YSE_SD_SA_019~ZUNITPR
  YSE_SD_SA_019~ZUNITPRCURR
  YSE_SD_SA_019~ZUNITPR_CC
  YSE_SD_SA_019~KWERT_ZPRS
  YSE_SD_SA_019~WAERK_ZPRS
  YSE_SD_SA_019~ZPROFIT
  YSE_SD_SA_019~ZPROFCURR
  YSE_SD_SA_019~ZPROFPERC
  YSE_SD_SA_019~KWMENG
  YSE_SD_SA_019~VRKME_ORD
  YSE_SD_SA_019~LIFNR
  YSE_SD_SA_019~LFIMG
  YSE_SD_SA_019~VRKME_DEL
  YSE_SD_SA_019~ZQUANT_DEL
  YSE_SD_SA_019~ZVRKME_DEL
  YSE_SD_SA_019~WADAT_IST
  YSE_SD_SA_019~FKART
  YSE_SD_SA_019~FAREG
  YSE_SD_SA_019~FKIMG
  YSE_SD_SA_019~VRKME_INV
  YSE_SD_SA_019~KZWI3_INV
  YSE_SD_SA_019~WAERK_INV
  YSE_SD_SA_019~KZWI3_INV_CC
  YSE_SD_SA_019~ERDAT_INV
  YSE_SD_SA_019~FKDAT
  YSE_SD_SA_019~ZQUANT_INV
  YSE_SD_SA_019~ZVRKME_INV
  YSE_SD_SA_019~ZAMOUNT
  YSE_SD_SA_019~ZWAERK_INV
  YSE_SD_SA_019~FPROZ
  YSE_SD_SA_019~ZFPLVAL
  YSE_SD_SA_019~FAKSP
  YSE_SD_SA_019~KWMENG_OH
  YSE_SD_SA_019~KZWI3_OH
  YSE_SD_SA_019~KZWI3_OH_CC
  YSE_SD_SA_019~KWERT_COS_OH
  YSE_SD_SA_019~ZPROFIT_OH
  YSE_SD_SA_019~ZPROFPC_OH
  YSE_SD_SA_019~KWERT_COS_IN
  YSE_SD_SA_019~ZPROFIT_IN
  YSE_SD_SA_019~ZPROFPC_IN
  YSE_SD_SA_019~ZUONR
  YSE_SD_SA_019~ABGRU
  YSE_SD_SA_019~ECCUSTN
  YSE_SD_SA_019~ECPARTF
  YSE_SD_SA_019~ECNAICS
  YSE_SD_SA_019~ECHLCUS
  YSE_SD_SA_019~ZPROFIT_CC
  YSE_SD_SA_019~WAERK_CC
  YSE_SD_SA_019~COUNTRY
  YSE_SD_SA_019~BELNR
  YSE_SD_SA_019~MSTAV
  YSE_SD_SA_019~MMSTA
  YSE_SD_SA_019~KZAUS
  YSE_SD_SA_019~FKSAK
  YSE_SD_SA_019~GBSTK
  YSE_SD_SA_019~WBSTK
  YSE_SD_SA_019~LFSTA
  YSE_SD_SA_019~GBSTA
  YSE_SD_SA_019~ZTERM
  YSE_SD_SA_019~KTGRD
  YSE_SD_SA_019~ZFREIGHT_HDR
  YSE_SD_SA_019~ZFR_HDR_CC
  YSE_SD_SA_019~ZFREIGHT_ITM
  YSE_SD_SA_019~ZFR_ITM_CC
  TVKBT9~BEZEI
  TVKBT9~SPRAS
  TVKBT9~VKBUR
into (YSE_SD_SA_019MANDT,
  YSE_SD_SA_019VBELN_ORD,
  YSE_SD_SA_019POSNR_ORD,
  YSE_SD_SA_019VBELN_DEL,
  YSE_SD_SA_019POSNR_DEL,
  YSE_SD_SA_019VBELN_INV,
  YSE_SD_SA_019POSNR_INV,
  YSE_SD_SA_019VKORG,
  YSE_SD_SA_019VTWEG,
  YSE_SD_SA_019SPART,
  YSE_SD_SA_019SPARTD,
  YSE_SD_SA_019VKBUR,
  YSE_SD_SA_019VKGRP,
  YSE_SD_SA_019PRCTR,
  YSE_SD_SA_019WW002,
  YSE_SD_SA_019WW006,
  YSE_SD_SA_019WW007,
  YSE_SD_SA_019CMGST,
  YSE_SD_SA_019BSTKD,
  YSE_SD_SA_019BZIRK,
  YSE_SD_SA_019VDATU,
  YSE_SD_SA_019EDATU,
  YSE_SD_SA_019EBELN,
  YSE_SD_SA_019EBELP,
  YSE_SD_SA_019ERDAT_ORD,
  YSE_SD_SA_019ERNAM,
  YSE_SD_SA_019AUART,
  YSE_SD_SA_019BNDDT,
  YSE_SD_SA_019WERKS,
  YSE_SD_SA_019MATNR,
  YSE_SD_SA_019MATKL,
  YSE_SD_SA_019PSTYV,
  YSE_SD_SA_019MTPOS,
  YSE_SD_SA_019KUNAG,
  YSE_SD_SA_019KUNWE,
  YSE_SD_SA_019SH_NAICS,
  YSE_SD_SA_019KUNRE,
  YSE_SD_SA_019HKUNNR,
  YSE_SD_SA_019BRAN1,
  YSE_SD_SA_019FAKSK,
  YSE_SD_SA_019LIFSK,
  YSE_SD_SA_019ERDAT,
  YSE_SD_SA_019PARVW_VE,
  YSE_SD_SA_019PERNR_VE,
  YSE_SD_SA_019PARVW_ZX,
  YSE_SD_SA_019PERNR_ZX,
  YSE_SD_SA_019PARVW_ZY,
  YSE_SD_SA_019PERNR_ZY,
  YSE_SD_SA_019KWERT_ZPRO,
  YSE_SD_SA_019WAERK_ZPRO,
  YSE_SD_SA_019KZWI3_ORD,
  YSE_SD_SA_019WAERK_ORD,
  YSE_SD_SA_019KZWI3_ORD_CC,
  YSE_SD_SA_019ZUNITPR,
  YSE_SD_SA_019ZUNITPRCURR,
  YSE_SD_SA_019ZUNITPR_CC,
  YSE_SD_SA_019KWERT_ZPRS,
  YSE_SD_SA_019WAERK_ZPRS,
  YSE_SD_SA_019ZPROFIT,
  YSE_SD_SA_019ZPROFCURR,
  YSE_SD_SA_019ZPROFPERC,
  YSE_SD_SA_019KWMENG,
  YSE_SD_SA_019VRKME_ORD,
  YSE_SD_SA_019LIFNR,
  YSE_SD_SA_019LFIMG,
  YSE_SD_SA_019VRKME_DEL,
  YSE_SD_SA_019ZQUANT_DEL,
  YSE_SD_SA_019ZVRKME_DEL,
  YSE_SD_SA_019WADAT_IST,
  YSE_SD_SA_019FKART,
  YSE_SD_SA_019FAREG,
  YSE_SD_SA_019FKIMG,
  YSE_SD_SA_019VRKME_INV,
  YSE_SD_SA_019KZWI3_INV,
  YSE_SD_SA_019WAERK_INV,
  YSE_SD_SA_019KZWI3_INV_CC,
  YSE_SD_SA_019ERDAT_INV,
  YSE_SD_SA_019FKDAT,
  YSE_SD_SA_019ZQUANT_INV,
  YSE_SD_SA_019ZVRKME_INV,
  YSE_SD_SA_019ZAMOUNT,
  YSE_SD_SA_019ZWAERK_INV,
  YSE_SD_SA_019FPROZ,
  YSE_SD_SA_019ZFPLVAL,
  YSE_SD_SA_019FAKSP,
  YSE_SD_SA_019KWMENG_OH,
  YSE_SD_SA_019KZWI3_OH,
  YSE_SD_SA_019KZWI3_OH_CC,
  YSE_SD_SA_019KWERT_COS_OH,
  YSE_SD_SA_019ZPROFIT_OH,
  YSE_SD_SA_019ZPROFPC_OH,
  YSE_SD_SA_019KWERT_COS_IN,
  YSE_SD_SA_019ZPROFIT_IN,
  YSE_SD_SA_019ZPROFPC_IN,
  YSE_SD_SA_019ZUONR,
  YSE_SD_SA_019ABGRU,
  YSE_SD_SA_019ECCUSTN,
  YSE_SD_SA_019ECPARTF,
  YSE_SD_SA_019ECNAICS,
  YSE_SD_SA_019ECHLCUS,
  YSE_SD_SA_019ZPROFIT_CC,
  YSE_SD_SA_019WAERK_CC,
  YSE_SD_SA_019COUNTRY,
  YSE_SD_SA_019BELNR,
  YSE_SD_SA_019MSTAV,
  YSE_SD_SA_019MMSTA,
  YSE_SD_SA_019KZAUS,
  YSE_SD_SA_019FKSAK,
  YSE_SD_SA_019GBSTK,
  YSE_SD_SA_019WBSTK,
  YSE_SD_SA_019LFSTA,
  YSE_SD_SA_019GBSTA,
  YSE_SD_SA_019ZTERM,
  YSE_SD_SA_019KTGRD,
  YSE_SD_SA_019ZFREIGHT_HDR,
  YSE_SD_SA_019ZFR_HDR_CC,
  YSE_SD_SA_019ZFREIGHT_ITM,
  YSE_SD_SA_019ZFR_ITM_CC,
  TVKBT9BEZEI,
  TVKBT9SPRAS,
  TVKBT9VKBUR)
FROM YSE_SD_SALES_INV AS YSE_SD_SA_019
 INNER JOIN TVKBT AS TVKBT9
 ON ( TVKBT9~VKBUR = YSE_SD_SA_019~VKBUR )
WHERE ( ( TVKBT9~SPRAS = 'E' )
 AND YSE_SD_SA_019~VKORG IN ('CN01',
'CN04',
'HK01',
'RU01') ).
ALTMP1 = YSE_SD_SA_019MANDT.
ALTMP2 = YSE_SD_SA_019VBELN_ORD.
ALTMP3 = YSE_SD_SA_019POSNR_ORD.
ALTMP4 = YSE_SD_SA_019VBELN_DEL.
ALTMP5 = YSE_SD_SA_019POSNR_DEL.
ALTMP6 = YSE_SD_SA_019VBELN_INV.
ALTMP7 = YSE_SD_SA_019POSNR_INV.
ALTMP8 = YSE_SD_SA_019VKORG.
ALTMP9 = YSE_SD_SA_019VTWEG.
ALTMP10 = YSE_SD_SA_019SPART.
ALTMP11 = YSE_SD_SA_019SPARTD.
ALTMP12 = YSE_SD_SA_019VKBUR.
ALTMP13 = YSE_SD_SA_019VKGRP.
ALTMP14 = YSE_SD_SA_019PRCTR.
ALTMP15 = YSE_SD_SA_019WW002.
ALTMP16 = YSE_SD_SA_019WW006.
ALTMP17 = YSE_SD_SA_019WW007.
ALTMP18 = YSE_SD_SA_019CMGST.
ALTMP19 = YSE_SD_SA_019BSTKD.
ALTMP20 = YSE_SD_SA_019BZIRK.
ALTMP21 = YSE_SD_SA_019VDATU.
ALTMP22 = YSE_SD_SA_019EDATU.
ALTMP23 = YSE_SD_SA_019EBELN.
ALTMP24 = YSE_SD_SA_019EBELP.
ALTMP25 = YSE_SD_SA_019ERDAT_ORD.
ALTMP26 = YSE_SD_SA_019ERNAM.
ALTMP27 = YSE_SD_SA_019AUART.
ALTMP28 = YSE_SD_SA_019BNDDT.
ALTMP29 = YSE_SD_SA_019WERKS.
ALTMP30 = YSE_SD_SA_019MATNR.
ALTMP31 = YSE_SD_SA_019MATKL.
ALTMP32 = YSE_SD_SA_019PSTYV.
ALTMP33 = YSE_SD_SA_019MTPOS.
ALTMP34 = YSE_SD_SA_019KUNAG.
ALTMP35 = YSE_SD_SA_019KUNWE.
ALTMP36 = YSE_SD_SA_019SH_NAICS.
ALTMP37 = YSE_SD_SA_019KUNRE.
ALTMP38 = YSE_SD_SA_019HKUNNR.
ALTMP39 = YSE_SD_SA_019BRAN1.
ALTMP40 = YSE_SD_SA_019FAKSK.
ALTMP41 = YSE_SD_SA_019LIFSK.
ALTMP42 = YSE_SD_SA_019ERDAT.
ALTMP43 = YSE_SD_SA_019PARVW_VE.
ALTMP44 = YSE_SD_SA_019PERNR_VE.
ALTMP45 = YSE_SD_SA_019PARVW_ZX.
ALTMP46 = YSE_SD_SA_019PERNR_ZX.
ALTMP47 = YSE_SD_SA_019PARVW_ZY.
ALTMP48 = YSE_SD_SA_019PERNR_ZY.
ALTMP49 = YSE_SD_SA_019KWERT_ZPRO.
ALTMP50 = YSE_SD_SA_019WAERK_ZPRO.
ALTMP51 = YSE_SD_SA_019KZWI3_ORD.
ALTMP52 = YSE_SD_SA_019WAERK_ORD.
ALTMP53 = YSE_SD_SA_019KZWI3_ORD_CC.
ALTMP54 = YSE_SD_SA_019ZUNITPR.
ALTMP55 = YSE_SD_SA_019ZUNITPRCURR.
ALTMP56 = YSE_SD_SA_019ZUNITPR_CC.
ALTMP57 = YSE_SD_SA_019KWERT_ZPRS.
ALTMP58 = YSE_SD_SA_019WAERK_ZPRS.
ALTMP59 = YSE_SD_SA_019ZPROFIT.
ALTMP60 = YSE_SD_SA_019ZPROFCURR.
ALTMP61 = YSE_SD_SA_019ZPROFPERC.
ALTMP62 = YSE_SD_SA_019KWMENG.
ALTMP63 = YSE_SD_SA_019VRKME_ORD.
ALTMP64 = YSE_SD_SA_019LIFNR.
ALTMP65 = YSE_SD_SA_019LFIMG.
ALTMP66 = YSE_SD_SA_019VRKME_DEL.
ALTMP67 = YSE_SD_SA_019ZQUANT_DEL.
ALTMP68 = YSE_SD_SA_019ZVRKME_DEL.
ALTMP69 = YSE_SD_SA_019WADAT_IST.
ALTMP70 = YSE_SD_SA_019FKART.
ALTMP71 = YSE_SD_SA_019FAREG.
ALTMP72 = YSE_SD_SA_019FKIMG.
ALTMP73 = YSE_SD_SA_019VRKME_INV.
ALTMP74 = YSE_SD_SA_019KZWI3_INV.
ALTMP75 = YSE_SD_SA_019WAERK_INV.
ALTMP76 = YSE_SD_SA_019KZWI3_INV_CC.
ALTMP77 = YSE_SD_SA_019ERDAT_INV.
ALTMP78 = YSE_SD_SA_019FKDAT.
ALTMP79 = YSE_SD_SA_019ZQUANT_INV.
ALTMP80 = YSE_SD_SA_019ZVRKME_INV.
ALTMP81 = YSE_SD_SA_019ZAMOUNT.
ALTMP82 = YSE_SD_SA_019ZWAERK_INV.
ALTMP83 = YSE_SD_SA_019FPROZ.
ALTMP84 = YSE_SD_SA_019ZFPLVAL.
ALTMP85 = YSE_SD_SA_019FAKSP.
ALTMP86 = YSE_SD_SA_019KWMENG_OH.
ALTMP87 = YSE_SD_SA_019KZWI3_OH.
ALTMP88 = YSE_SD_SA_019KZWI3_OH_CC.
ALTMP89 = YSE_SD_SA_019KWERT_COS_OH.
ALTMP90 = YSE_SD_SA_019ZPROFIT_OH.
ALTMP91 = YSE_SD_SA_019ZPROFPC_OH.
ALTMP92 = YSE_SD_SA_019KWERT_COS_IN.
ALTMP93 = YSE_SD_SA_019ZPROFIT_IN.
ALTMP94 = YSE_SD_SA_019ZPROFPC_IN.
ALTMP95 = YSE_SD_SA_019ZUONR.
ALTMP96 = YSE_SD_SA_019ABGRU.
ALTMP97 = YSE_SD_SA_019ECCUSTN.
ALTMP98 = YSE_SD_SA_019ECPARTF.
ALTMP99 = YSE_SD_SA_019ECNAICS.
ALTMP100 = YSE_SD_SA_019ECHLCUS.
ALTMP101 = YSE_SD_SA_019ZPROFIT_CC.
ALTMP102 = YSE_SD_SA_019WAERK_CC.
ALTMP103 = YSE_SD_SA_019COUNTRY.
ALTMP104 = YSE_SD_SA_019BELNR.
ALTMP105 = YSE_SD_SA_019MSTAV.
ALTMP106 = YSE_SD_SA_019MMSTA.
ALTMP107 = YSE_SD_SA_019KZAUS.
ALTMP108 = YSE_SD_SA_019FKSAK.
ALTMP109 = YSE_SD_SA_019GBSTK.
ALTMP110 = YSE_SD_SA_019WBSTK.
ALTMP111 = YSE_SD_SA_019LFSTA.
ALTMP112 = YSE_SD_SA_019GBSTA.
ALTMP113 = YSE_SD_SA_019ZTERM.
ALTMP114 = YSE_SD_SA_019KTGRD.
ALTMP115 = YSE_SD_SA_019ZFREIGHT_HDR.
ALTMP116 = YSE_SD_SA_019ZFR_HDR_CC.
ALTMP117 = YSE_SD_SA_019ZFREIGHT_ITM.
ALTMP118 = YSE_SD_SA_019ZFR_ITM_CC.
ALTMP119 = TVKBT9BEZEI.
 move ALTMP1 to ITAB3-MANDT.
 move ALTMP2 to ITAB3-VBELN_ORD.
 move ALTMP3 to ITAB3-POSNR_ORD.
 move ALTMP4 to ITAB3-VBELN_DEL.
 move ALTMP5 to ITAB3-POSNR_DEL.
 move ALTMP6 to ITAB3-VBELN_INV.
 move ALTMP7 to ITAB3-POSNR_INV.
 move ALTMP8 to ITAB3-VKORG.
 move ALTMP9 to ITAB3-VTWEG.
 move ALTMP10 to ITAB3-SPART.
 move ALTMP11 to ITAB3-SPARTD.
 move ALTMP12 to ITAB3-VKBUR.
 move ALTMP13 to ITAB3-VKGRP.
 move ALTMP14 to ITAB3-PRCTR.
 move ALTMP15 to ITAB3-WW002.
 move ALTMP16 to ITAB3-WW006.
 move ALTMP17 to ITAB3-WW007.
 move ALTMP18 to ITAB3-CMGST.
 move ALTMP19 to ITAB3-BSTKD.
 move ALTMP20 to ITAB3-BZIRK.
 move ALTMP21 to ITAB3-VDATU.
 move ALTMP22 to ITAB3-EDATU.
 move ALTMP23 to ITAB3-EBELN.
 move ALTMP24 to ITAB3-EBELP.
 move ALTMP25 to ITAB3-ERDAT_ORD.
 move ALTMP26 to ITAB3-ERNAM.
 move ALTMP27 to ITAB3-AUART.
 move ALTMP28 to ITAB3-BNDDT.
 move ALTMP29 to ITAB3-WERKS.
 move ALTMP30 to ITAB3-MATNR.
 move ALTMP31 to ITAB3-MATKL.
 move ALTMP32 to ITAB3-PSTYV.
 move ALTMP33 to ITAB3-MTPOS.
 move ALTMP34 to ITAB3-KUNAG.
 move ALTMP35 to ITAB3-KUNWE.
 move ALTMP36 to ITAB3-SH_NAICS.
 move ALTMP37 to ITAB3-KUNRE.
 move ALTMP38 to ITAB3-HKUNNR.
 move ALTMP39 to ITAB3-BRAN1.
 move ALTMP40 to ITAB3-FAKSK.
 move ALTMP41 to ITAB3-LIFSK.
 move ALTMP42 to ITAB3-ERDAT.
 move ALTMP43 to ITAB3-PARVW_VE.
 move ALTMP44 to ITAB3-PERNR_VE.
 move ALTMP45 to ITAB3-PARVW_ZX.
 move ALTMP46 to ITAB3-PERNR_ZX.
 move ALTMP47 to ITAB3-PARVW_ZY.
 move ALTMP48 to ITAB3-PERNR_ZY.
 move ALTMP49 to ITAB3-KWERT_ZPRO.
 move ALTMP50 to ITAB3-WAERK_ZPRO.
 move ALTMP51 to ITAB3-KZWI3_ORD.
 move ALTMP52 to ITAB3-WAERK_ORD.
 move ALTMP53 to ITAB3-KZWI3_ORD_CC.
 move ALTMP54 to ITAB3-ZUNITPR.
 move ALTMP55 to ITAB3-ZUNITPRCURR.
 move ALTMP56 to ITAB3-ZUNITPR_CC.
 move ALTMP57 to ITAB3-KWERT_ZPRS.
 move ALTMP58 to ITAB3-WAERK_ZPRS.
 move ALTMP59 to ITAB3-ZPROFIT.
 move ALTMP60 to ITAB3-ZPROFCURR.
 move ALTMP61 to ITAB3-ZPROFPERC.
 move ALTMP62 to ITAB3-KWMENG.
 move ALTMP63 to ITAB3-VRKME_ORD.
 move ALTMP64 to ITAB3-LIFNR.
 move ALTMP65 to ITAB3-LFIMG.
 move ALTMP66 to ITAB3-VRKME_DEL.
 move ALTMP67 to ITAB3-ZQUANT_DEL.
 move ALTMP68 to ITAB3-ZVRKME_DEL.
 move ALTMP69 to ITAB3-WADAT_IST.
 move ALTMP70 to ITAB3-FKART.
 move ALTMP71 to ITAB3-FAREG.
 move ALTMP72 to ITAB3-FKIMG.
 move ALTMP73 to ITAB3-VRKME_INV.
 move ALTMP74 to ITAB3-KZWI3_INV.
 move ALTMP75 to ITAB3-WAERK_INV.
 move ALTMP76 to ITAB3-KZWI3_INV_CC.
 move ALTMP77 to ITAB3-ERDAT_INV.
 move ALTMP78 to ITAB3-FKDAT.
 move ALTMP79 to ITAB3-ZQUANT_INV.
 move ALTMP80 to ITAB3-ZVRKME_INV.
 move ALTMP81 to ITAB3-ZAMOUNT.
 move ALTMP82 to ITAB3-ZWAERK_INV.
 move ALTMP83 to ITAB3-FPROZ.
 move ALTMP84 to ITAB3-ZFPLVAL.
 move ALTMP85 to ITAB3-FAKSP.
 move ALTMP86 to ITAB3-KWMENG_OH.
 move ALTMP87 to ITAB3-KZWI3_OH.
 move ALTMP88 to ITAB3-KZWI3_OH_CC.
 move ALTMP89 to ITAB3-KWERT_COS_OH.
 move ALTMP90 to ITAB3-ZPROFIT_OH.
 move ALTMP91 to ITAB3-ZPROFPC_OH.
 move ALTMP92 to ITAB3-KWERT_COS_IN.
 move ALTMP93 to ITAB3-ZPROFIT_IN.
 move ALTMP94 to ITAB3-ZPROFPC_IN.
 move ALTMP95 to ITAB3-ZUONR.
 move ALTMP96 to ITAB3-ABGRU.
 move ALTMP97 to ITAB3-ECCUSTN.
 move ALTMP98 to ITAB3-ECPARTF.
 move ALTMP99 to ITAB3-ECNAICS.
 move ALTMP100 to ITAB3-ECHLCUS.
 move ALTMP101 to ITAB3-ZPROFIT_CC.
 move ALTMP102 to ITAB3-WAERK_CC.
 move ALTMP103 to ITAB3-COUNTRY.
 move ALTMP104 to ITAB3-BELNR.
 move ALTMP105 to ITAB3-MSTAV.
 move ALTMP106 to ITAB3-MMSTA.
 move ALTMP107 to ITAB3-KZAUS.
 move ALTMP108 to ITAB3-FKSAK.
 move ALTMP109 to ITAB3-GBSTK.
 move ALTMP110 to ITAB3-WBSTK.
 move ALTMP111 to ITAB3-LFSTA.
 move ALTMP112 to ITAB3-GBSTA.
 move ALTMP113 to ITAB3-ZTERM.
 move ALTMP114 to ITAB3-KTGRD.
 move ALTMP115 to ITAB3-ZFREIGHT_HDR.
 move ALTMP116 to ITAB3-ZFR_HDR_CC.
 move ALTMP117 to ITAB3-ZFREIGHT_ITM.
 move ALTMP118 to ITAB3-ZFR_ITM_CC.
 move ALTMP119 to ITAB3-VKBURTXT.
 append ITAB3.
 cntbuf = cntbuf + 1.
 if download = 'N'.
  if cntbuf > 5000.
    perform FORM4.
    clear cntbuf.
    refresh ITAB3.
    append_flag = 'A'.
  endif.
 endif.
ENDSELECT.
ENDFORM.

FORM FORM4.
data: outfile(128), ldfile(50).
ldfile = 'YSESDSALESINV_SALESORDERSINV'.
concatenate out_dir ldfile into outfile
  separated by '/'.
data  dlmtlen type i value '1'.
data xdlmtlen type i value '1'.
data:
  ht(1) type c,
  xht(1) type x,
  conv type ref to cl_abap_conv_in_ce.
xht = '7F'.
conv = cl_abap_conv_in_ce=>create(
  encoding = '4110'
  input = xht
).
call method conv->read(
  exporting n    = xdlmtlen
  importing data = ht
            len = dlmtlen
).
data return_code type i.
 perform write_delimited_file
           tables   ITAB3
           using    outfile
                    append_flag
                    ht
                    dlmtlen
                    download
           changing return_code.

  case return_code.
    when 1.
      IF EXECMODE = 'D'.
        WRITE: /5 'No line selected'.
      ELSE.
        MESSAGE E098.
      ENDIF.
    when 2.
      IF EXECMODE = 'D'.
        WRITE: /5 'Open File Error -- ', 25 OUTFILE.
      ELSE.
        MESSAGE  E107 WITH OUTFILE.
      ENDIF.
    when 3.
      IF EXECMODE = 'D'.
        WRITE: /5 'Data exceed length limit (8192) '.
      ELSE.
        MESSAGE  E000 WITH
             'Data exceed length limit (8192) '.
      ENDIF.
    when 4.
      IF EXECMODE = 'D'.
        WRITE: /5 'Call function WS_DOWNLOAD error'.
      ELSE.
        MESSAGE  E000 WITH
             'Call function WS_DOWNLOAD error'.
      ENDIF.
  endcase.
ENDFORM.

FORM SUBSTRING USING SRC BEG LEN CHANGING RET.

DATA: VA1 TYPE I.
DATA: VA2 TYPE I.
DATA: VA3 TYPE I.

VA3 = STRLEN( SRC ).

IF  BEG = 0.   VA1 = 0.
ELSE.
  IF  BEG < 0.
    VA1 = VA3 + BEG.
    IF  VA1 < 0.   VA1 = 0.
    ENDIF.
  ELSE.          VA1 = BEG - 1.
  ENDIF.
ENDIF.

IF  LEN < 0.   VA2 = 0.
ELSE.          VA2 = VA3 - VA1.
ENDIF.

IF  VA2 > LEN. VA2 = LEN.
ENDIF.

IF  VA2 < 1.   MOVE ''           TO RET.
ELSE.          MOVE SRC+VA1(VA2) TO RET.
ENDIF.

ENDFORM.

form write_delimited_file
           tables   datatab
           using    file
                    append
                    delimit
                    dlength
                    dwnload
          changing rc.

  data: type1,
        appd(1),
        temp(32),
        time1(8),
        date1(10),
        output(8192),
        rcount type i,
        offset type i,
        tablen type i,
        maxlen type i value '8192'.

  data: begin of clientab occurs 0,
             output(8192),
          end of clientab.

  field-symbols: <f>.
  field-symbols <delim1>.
  data delim2(16).
  data l_filename type string.

  appd = append.
  if appd is not initial.
     appd = 'X'.
  endif.
  move file to l_filename.
  describe table datatab lines tablen.


  if dwnload = 'Y'.
     clear clientab. refresh clientab.
     rcount = 0.
  else.
     if appd = space.
         open dataset file for output in text mode ENCODING
UTF-8.
     else.
         open dataset file for appending in text mode ENCODING
UTF-8.
     endif.
     if sy-subrc <> 0.
         rc = 2. exit.
     endif.
  endif.

  loop at datatab.
    clear: tablen, offset, output.
    do.
      assign component sy-index of
         structure datatab to <f>.
      if sy-subrc <> 0. exit. endif.
      if sy-index > 1.
         assign delimit(dlength) TO <delim1> CASTING TYPE C.
         delim2 = <delim1>.
         write delim2(dlength) to output+offset(dlength).
         add dlength to offset.
      endif.

      describe field <f> type type1.

      if type1 = 'I' or type1 = 'N'.
          type1 = 'P'.
      endif.

      case type1.
        when 'D'.
          if <f> = '00000000'.
             <f> = ' '.
          else.
             move <f> to time1.
             assign time1 to <f>.
          endif.
        when 'F'.
          if <f> = '0.0'.
            temp = '0.0'.
          else.
             write <f> to temp exponent 0.
          endif.
          condense temp no-gaps.
          translate temp using ',.'.
          assign temp to <f>.
        when 'P'.
          if <f> < 0.
             write '-' to output+offset(1).
             add 1 to offset.
             <f> = <f> * ( -1 ).
          endif.
          move <f> to temp.
          condense temp no-gaps.
          translate temp using ',.'.
          assign temp to <f>.
      endcase.

      sy-fdpos = strlen( <f> ).

      tablen = offset + sy-fdpos.
      if tablen > maxlen.
         rc = 3. exit.
      endif.
      write <f> to output+offset(sy-fdpos).
      add sy-fdpos to offset.
    enddo.

    if dwnload = 'Y'.
       clientab-output = output.
       append clientab.
       rcount = rcount + 1.
       if rcount >= 50.
          SY-BATCH = SPACE.
          CALL FUNCTION 'GUI_DOWNLOAD'
            EXPORTING
              FILENAME = l_filename
              FILETYPE = 'ASC'
              CODEPAGE = '4110'
              APPEND   = appd
              WRITE_FIELD_SEPARATOR = 'X'
*            IMPORTING
*              FILELENGTH =
            TABLES
              DATA_TAB = clientab
            EXCEPTIONS
              OTHERS = 1.
          if sy-subrc <> 0.
             rc = 4.
          endif.
          clear clientab. refresh clientab.
          rcount = 0. appd = 'A'.
       endif.
    else.
       transfer output to file.
    endif.
  endloop.

  if dwnload = 'Y'.
       SY-BATCH = SPACE.
       CALL FUNCTION 'GUI_DOWNLOAD'
         EXPORTING
           FILENAME = l_filename
           FILETYPE = 'ASC'
              CODEPAGE = '4110'
           APPEND   = appd
           WRITE_FIELD_SEPARATOR = 'X'
*         IMPORTING
*           FILELENGTH =
         TABLES
           DATA_TAB = clientab
         EXCEPTIONS
           OTHERS = 1.
          if sy-subrc <> 0.
             rc = 4.
          endif.
  else.
       close dataset file.
  endif.
endform.
