REPORT ZRMAFRU01 MESSAGE-ID RU.
  TABLES: T490.
  DATA: HERKUNFT LIKE AFRH-AFORI.

* Auftragstypen
  INCLUDE LCOKOTYP.
* Vorratsherkunft und Applikation
  INCLUDE LCORPHER.

START-OF-SELECTION.

IF SY-TCODE EQ 'PK51'.       "bei Kanban nicht ¨¹ber T490 suchen, sondern
   HERKUNFT = '5'.      "gleich Herkunft hart setzen.
ELSE.
* Auftragtyp bestimmen
  SELECT SINGLE * FROM T490
         WHERE TCODE = SY-TCODE.

  CASE T490-AUTYP.
    WHEN AUFTRAGSTYP-FERT.
      HERKUNFT = AFRHORI-PP.
    WHEN AUFTRAGSTYP-BORD.
      HERKUNFT = AFRHORI-PI.
    WHEN AUFTRAGSTYP-INST.
      HERKUNFT = AFRHORI-PM.
    WHEN AUFTRAGSTYP-NETW.
      HERKUNFT = AFRHORI-PS.
    WHEN OTHERS.
      MESSAGE A187.
  ENDCASE.
ENDIF.
  SUBMIT ZRMAFRU00 WITH HERKUNFT = HERKUNFT AND RETURN.
