*----------------------------------------------------------------------*
* PROGRAM ID           : YAM_DOWNLOAD_SEO                              *
* PROGRAM TITLE        : Download Service Orders                       *
* AUTHOR               : Geert Rutten                                  *
* DATE                 : 05/10/2012                                    *
* DEVELOPMENT ID       :                                               *
*                                                                      *
* CHANGE REQUEST NUMBER:  CD1K973418                                   *
*                                                                      *
* Program Description:  Download of service orders for cutover         *
*                       Act! program                                   *
************************************************************************
* MOD-001 - 20/08/2015 - ACTEXTSF
* Reason: - adding columns WAERS and NETWR_SD to SEO_HEADER
************************************************************************
REPORT yam_download_seo MESSAGE-ID yam_inf.

************************************************************************
*                   T A B L E S                                        *
************************************************************************
TABLES: vbak,
        aufk,
        tj02t,
        mpos,
        pmsdo,
        ihpa,
        kna1,
        knvv.

************************************************************************
*                   T Y P E - P O O L S                                *
************************************************************************
TYPE-POOLS: ibco2.

************************************************************************
*                   C O N S T A N T S                                  *
************************************************************************
CONSTANTS: gc_stat_dl  TYPE j_status  VALUE 'I0076',
           c_rec_h(10)     TYPE c        VALUE 'Seo_Header',
           c_rec_p(12)     TYPE c        VALUE 'seo_Partners',
*           c_rec_p(17)     TYPE c        VALUE 'seo_Parts_Ordered',
*           c_rec_l1(20)     TYPE c        VALUE 'seo_header_longtxt',
*           c_rec_l2(18)     TYPE c        VALUE 'seo_item_longtxt',
           gc_charx(1) TYPE c VALUE 'X',
           gc_vw(2)    TYPE c VALUE 'VW'.

************************************************************************
*                  I N T E R N A L   T A B L E S                       *
************************************************************************
DATA: BEGIN OF gt_equi OCCURS 0,
        equnr     LIKE equi-equnr,
        objnr     LIKE equi-objnr,
        eqktx     LIKE eqkt-eqktx,
      END OF gt_equi.



DATA: BEGIN OF h_status_tab OCCURS 30.
        INCLUDE STRUCTURE jstat.
DATA: END OF h_status_tab.

DATA: BEGIN OF gt_seo OCCURS 0,
       qmnum LIKE qmel-qmnum,
       objnr LIKE qmel-objnr,
      END OF gt_seo.
DATA: lv_sttxt(40)  TYPE c.
DATA: lv_sttxtu(40)  TYPE c.

DATA: BEGIN OF gt_seo_p_c OCCURS 0,
        aufnr      LIKE dd03l-fieldname,
        deli1      TYPE c,
        parnr_h    LIKE dd03l-fieldname,
        deli2      TYPE c,
        name_h     LIKE dd03l-fieldname,
        deli3      TYPE c,
        parnr_s    LIKE dd03l-fieldname,
        deli4      TYPE c,
        name_s     LIKE dd03l-fieldname,
        deli5      TYPE c,
        parnr_p      LIKE dd03l-fieldname,
        deli6      TYPE c,
        name_p      LIKE dd03l-fieldname,
        deli7      TYPE c,
        parnr_b      LIKE dd03l-fieldname,
        deli8      TYPE c,
        name_b      LIKE dd03l-fieldname,
      END OF gt_seo_p_c.

DATA: BEGIN OF gt_seo_p OCCURS 0,
        aufnr      LIKE aufk-aufnr,
        deli1      TYPE c,
        parnr_h    LIKE ihpa-parnr,
        deli2      TYPE c,
        name_h     LIKE kna1-name1,
        deli3      TYPE c,
        parnr_s    LIKE ihpa-parnr,
        deli4      TYPE c,
        name_s     LIKE kna1-name1,
        deli5      TYPE c,
        parnr_p    LIKE ihpa-parnr,
        deli6      TYPE c,
        name_p     LIKE kna1-name1,
        deli7      TYPE c,
        parnr_b    LIKE ihpa-parnr,
        deli8      TYPE c,
        name_b     LIKE kna1-name1,
      END OF gt_seo_p.


DATA: BEGIN OF gt_seo_h_c OCCURS 0,
  qmnum      LIKE dd03l-fieldname,
  deli1      TYPE c,
  aufnr      LIKE dd03l-fieldname,
  deli2      TYPE c,
  auart      LIKE dd03l-fieldname,
  deli3      TYPE c,
  autyp      LIKE dd03l-fieldname,
  deli4      TYPE c,
  refnr      LIKE dd03l-fieldname,
  deli5      TYPE c,
  ernam      LIKE dd03l-fieldname,
  deli6      TYPE c,
  erdat      LIKE dd03l-fieldname,
  deli7      TYPE c,
  aenam      LIKE dd03l-fieldname,
  deli8      TYPE c,

  aedat      LIKE dd03l-fieldname,
  deli9      TYPE c,
  ktext      LIKE dd03l-fieldname,
  deli10     TYPE c,
  ltext      LIKE dd03l-fieldname,
  deli11     TYPE c,
  bstkd      LIKE dd03l-fieldname,
  deli12     TYPE c,
  bstdk      LIKE dd03l-fieldname,
  deli13     TYPE c,
  bukrs      LIKE dd03l-fieldname,
  deli14     TYPE c,
  werks      LIKE dd03l-fieldname,
  deli15     TYPE c,
  gsber      LIKE dd03l-fieldname,
  deli16     TYPE c,


  kokrs      LIKE dd03l-fieldname,
  deli17     TYPE c,
  kostv      LIKE dd03l-fieldname,
  deli18     TYPE c,
  loekz      LIKE dd03l-fieldname,
  deli19     TYPE c,
  prctr      LIKE dd03l-fieldname,
  deli20     TYPE c,
  pspel      LIKE dd03l-fieldname,
  deli21     TYPE c,
  kalsm      LIKE dd03l-fieldname,
  deli22     TYPE c,
  zschl      LIKE dd03l-fieldname,
  deli23     TYPE c,
  awsls      LIKE dd03l-fieldname,
  deli24     TYPE c,
  abgsl      LIKE dd03l-fieldname,
  deli25     TYPE c,


  txjcd      LIKE dd03l-fieldname,
  deli26     TYPE c,
  sdate      LIKE dd03l-fieldname,
  deli27     TYPE c,
  user2      LIKE dd03l-fieldname,
  deli28     TYPE c,
  user7      LIKE dd03l-fieldname,
  deli29     TYPE c,
  user8      LIKE dd03l-fieldname,
  deli30     TYPE c,
  objnr      LIKE dd03l-fieldname,
  deli31     TYPE c,
  kdauf      LIKE dd03l-fieldname,
  deli32     TYPE c,
  kdpos      LIKE dd03l-fieldname,
  deli33     TYPE c,
  akstl      LIKE dd03l-fieldname,
  deli34     TYPE c,


  adrnra     LIKE dd03l-fieldname,
  deli35     TYPE c,
  cstg_vrnt  LIKE dd03l-fieldname,
  deli36     TYPE c,
  zzsdc      LIKE dd03l-fieldname,
  deli37     TYPE c,
  zzapc      LIKE dd03l-fieldname,
  deli38     TYPE c,
  zzcon      LIKE dd03l-fieldname,
  deli39     TYPE c,
  zzpsf      LIKE dd03l-fieldname,
  deli40     TYPE c,
  zzcom      LIKE dd03l-fieldname,
  deli41     TYPE c,
  zzrem      LIKE dd03l-fieldname,
  deli42     TYPE c,


  zztrc      LIKE dd03l-fieldname,
  deli43     TYPE c,
  gltrp      LIKE dd03l-fieldname,
  deli44     TYPE c,
  gstrp      LIKE dd03l-fieldname,
  deli45     TYPE c,
  ftrms      LIKE dd03l-fieldname,
  deli46     TYPE c,
  gltrs      LIKE dd03l-fieldname,
  deli47     TYPE c,
  gstrs      LIKE dd03l-fieldname,
  deli48     TYPE c,
  gstri      LIKE dd03l-fieldname,
  deli49     TYPE c,
  getri      LIKE dd03l-fieldname,
  deli50     TYPE c,
  gltri      LIKE dd03l-fieldname,
  deli51     TYPE c,


  ftrmi      LIKE dd03l-fieldname,
  deli52     TYPE c,
  ftrmp      LIKE dd03l-fieldname,
  deli53     TYPE c,
  plnty      LIKE dd03l-fieldname,
  deli54     TYPE c,
  plnnr      LIKE dd03l-fieldname,
  deli55     TYPE c,
  plnaw      LIKE dd03l-fieldname,
  deli56     TYPE c,
  plnal      LIKE dd03l-fieldname,
  deli57     TYPE c,
  pverw      LIKE dd03l-fieldname,
  deli58     TYPE c,
  plsvb      LIKE dd03l-fieldname,
  deli59     TYPE c,
  plnme      LIKE dd03l-fieldname,
  deli60     TYPE c,


  plsvn      LIKE dd03l-fieldname,
  deli61     TYPE c,
  pdatv      LIKE dd03l-fieldname,
  deli62     TYPE c,
  plgrp      LIKE dd03l-fieldname,
  deli63     TYPE c,
  lodiv      LIKE dd03l-fieldname,
  deli64     TYPE c,
  stlty      LIKE dd03l-fieldname,
  deli65     TYPE c,
  stlbez      LIKE dd03l-fieldname,
  deli66     TYPE c,
  stlst      LIKE dd03l-fieldname,
  deli67     TYPE c,
  stlnr      LIKE dd03l-fieldname,
  deli68     TYPE c,
  sdatv      LIKE dd03l-fieldname,
  deli69     TYPE c,


  sbmng      LIKE dd03l-fieldname,
  deli70     TYPE c,
  sbmeh      LIKE dd03l-fieldname,
  deli71     TYPE c,
  saenr      LIKE dd03l-fieldname,
  deli72     TYPE c,
  stlal      LIKE dd03l-fieldname,
  deli73     TYPE c,
  stlan      LIKE dd03l-fieldname,
  deli74     TYPE c,
  slsvn      LIKE dd03l-fieldname,
  deli75     TYPE c,
  slsbs      LIKE dd03l-fieldname,
  deli76     TYPE c,
  artpr      LIKE dd03l-fieldname,
  deli77     TYPE c,
  priok      LIKE dd03l-fieldname,
  deli78     TYPE c,


  equnr      LIKE dd03l-fieldname,
  deli79     TYPE c,
  bautl      LIKE dd03l-fieldname,
  deli80     TYPE c,
  anlzu      LIKE dd03l-fieldname,
  deli81     TYPE c,
  iwerk      LIKE dd03l-fieldname,
  deli82     TYPE c,
  ingpr      LIKE dd03l-fieldname,
  deli83     TYPE c,
  apgrp      LIKE dd03l-fieldname,
  deli84     TYPE c,
  gewrk      LIKE dd03l-fieldname,
  deli85     TYPE c,
  kunum      LIKE dd03l-fieldname,
  deli86     TYPE c,
  aning      LIKE dd03l-fieldname,
  deli87     TYPE c,


  warpl      LIKE dd03l-fieldname,
  deli88     TYPE c,
  abnum      LIKE dd03l-fieldname,
  deli89     TYPE c,
  wapos      LIKE dd03l-fieldname,
  deli90     TYPE c,
  aduhr      LIKE dd03l-fieldname,
  deli91     TYPE c,
  iphas      LIKE dd03l-fieldname,
  deli92     TYPE c,
  ilart      LIKE dd03l-fieldname,
  deli93     TYPE c,
  plknz      LIKE dd03l-fieldname,
  deli94     TYPE c,
  serialnr   LIKE dd03l-fieldname,
  deli95     TYPE c,
  sermat     LIKE dd03l-fieldname,
  deli96     TYPE c,

  objnr_p    LIKE dd03l-fieldname,
  deli97     TYPE c,
  vkorg      LIKE dd03l-fieldname,
  deli98     TYPE c,
  vaplz      LIKE dd03l-fieldname,
  deli99     TYPE c,
  wawrk      LIKE dd03l-fieldname,
  deli100    TYPE c,
  kostl      LIKE dd03l-fieldname,
  deli101    TYPE c,
  proid      LIKE dd03l-fieldname,
  deli102    TYPE c,
  stort      LIKE dd03l-fieldname,
  deli103    TYPE c,
  sowrk      LIKE dd03l-fieldname,
  deli104    TYPE c,
  vtweg      LIKE dd03l-fieldname,
  deli105    TYPE c,


  spart       LIKE dd03l-fieldname,
  deli106     TYPE c,
  vkgrp       LIKE dd03l-fieldname,
  deli107     TYPE c,
  vkbur       LIKE dd03l-fieldname,
  deli108     TYPE c,
  cuobj       LIKE dd03l-fieldname,
  deli109     TYPE c,
  iloan       LIKE dd03l-fieldname,
  deli110     TYPE c,
  tplnr       LIKE dd03l-fieldname,
  deli111     TYPE c,
  abckz       LIKE dd03l-fieldname,
  deli112     TYPE c,
  abckzi      LIKE dd03l-fieldname,
  deli113     TYPE c,
  eqfnr       LIKE dd03l-fieldname,
  deli114     TYPE c,


  eqfnri       LIKE dd03l-fieldname,
  deli115      TYPE c,
  swerk        LIKE dd03l-fieldname,
  deli116      TYPE c,
  swerki       LIKE dd03l-fieldname,
  deli117      TYPE c,
  stort_il     LIKE dd03l-fieldname,
  deli118      TYPE c,
  storti       LIKE dd03l-fieldname,
  deli119      TYPE c,
  msgrp        LIKE dd03l-fieldname,
  deli120      TYPE c,
  msgrpi       LIKE dd03l-fieldname,
  deli121      TYPE c,
  beber        LIKE dd03l-fieldname,
  deli122      TYPE c,
  beberi       LIKE dd03l-fieldname,
  deli123      TYPE c,

  cr_objty     LIKE dd03l-fieldname,
  deli124      TYPE c,
  ppsid        LIKE dd03l-fieldname,
  deli125      TYPE c,
  ppsidi       LIKE dd03l-fieldname,
  deli126      TYPE c,
  gsber_il     LIKE dd03l-fieldname,
  deli127      TYPE c,
  gsberi       LIKE dd03l-fieldname,
  deli128      TYPE c,
  kokrs_il     LIKE dd03l-fieldname,
  deli129      TYPE c,
  proidi       LIKE dd03l-fieldname,
  deli130      TYPE c,
  bukrs_il     LIKE dd03l-fieldname,
  deli131      TYPE c,
  bukrsi       LIKE dd03l-fieldname,
  deli132      TYPE c,


  anlnr        LIKE dd03l-fieldname,
  deli133      TYPE c,
  anlnri       LIKE dd03l-fieldname,
  deli134      TYPE c,
  anlun        LIKE dd03l-fieldname,
  deli135      TYPE c,
  anluni       LIKE dd03l-fieldname,
  deli136      TYPE c,
  daufn        LIKE dd03l-fieldname,
  deli137      TYPE c,
  daufni       LIKE dd03l-fieldname,
  deli138      TYPE c,
  aufnr_il     LIKE dd03l-fieldname,
  deli139      TYPE c,
  aufnri       LIKE dd03l-fieldname,
  deli140      TYPE c,
  tplnri       LIKE dd03l-fieldname,
  deli141      TYPE c,

  vkorg_il     LIKE dd03l-fieldname,
  deli142      TYPE c,
  vkorgi       LIKE dd03l-fieldname,
  deli143      TYPE c,
  vtweg_il     LIKE dd03l-fieldname,
  deli144      TYPE c,
  vtwegi       LIKE dd03l-fieldname,
  deli145      TYPE c,
  spart_il       LIKE dd03l-fieldname,
  deli146      TYPE c,
  sparti       LIKE dd03l-fieldname,
  deli147      TYPE c,
  adrnr        LIKE dd03l-fieldname,
  deli148      TYPE c,
  adrnri       LIKE dd03l-fieldname,
  deli149      TYPE c,
  owner        LIKE dd03l-fieldname,
  deli150      TYPE c,
  vkbur_il     LIKE dd03l-fieldname,
  deli151      TYPE c,
  vkgrp_il     LIKE dd03l-fieldname,
  deli152      TYPE c,
  sstatus      LIKE dd03l-fieldname,
  deli153      TYPE c,
  sstatus2     LIKE dd03l-fieldname,
  deli154      TYPE c,
  ustatus      LIKE dd03l-fieldname,
  deli155      TYPE c,
  ustatus2      LIKE dd03l-fieldname,
  deli156      TYPE c,
  vbeln         LIKE dd03l-fieldname,
  deli157      TYPE c,
  netwr     LIKE dd03l-fieldname,
  deli158      TYPE c,
  waerk      LIKE dd03l-fieldname,
  deli159      TYPE c,
  vbeln_d         LIKE dd03l-fieldname,
  deli160      TYPE c,
  netwr_d     LIKE dd03l-fieldname,
  deli161      TYPE c,
  waerk_d      LIKE dd03l-fieldname,
  deli162      TYPE c,
  bemot        TYPE dd03l-fieldname,
  deli163      TYPE c,
  matnr_p      TYPE dd03l-fieldname,
  deli164      TYPE c,
  menge_p      TYPE dd03l-fieldname,
  deli165      TYPE c,
  meins_p      TYPE dd03l-fieldname,
  deli166      TYPE c,
  faktf_p      TYPE dd03l-fieldname,

  deli167      TYPE c,                "MOD-001+
  waers        TYPE dd03l-fieldname,  "MOD-001+
  deli168      TYPE c,                "MOD-001+
  netwr_sd     TYPE dd03l-fieldname,  "MOD-001+
  deli169      TYPE c,                "MOD-001+
  waerk_f      TYPE dd03l-fieldname,  "MOD-001+
  deli170      TYPE c,                "MOD-001+
  stceg_l      TYPE dd03l-fieldname,  "MOD-001+
  deli171      TYPE c,                "MOD-001+
  inco1        TYPE dd03l-fieldname,  "MOD-001+
  deli172      TYPE c,                "MOD-001+
  inco2        TYPE dd03l-fieldname,  "MOD-001+
  deli173      TYPE c,                "MOD-001+
  zterm        TYPE dd03l-fieldname,  "MOD-001+
  deli174      TYPE c,                "MOD-002+
  bismt        TYPE dd03l-fieldname,  "MOD-002+
  deli175      TYPE c,                "MOD-002+
  zzvisam1     TYPE dd03l-fieldname,  "MOD-002+
  deli176      TYPE c,                "MOD-002+
  zzvisam2     TYPE dd03l-fieldname,  "MOD-002+
  deli177      TYPE c,                "MOD-002+
  maufnr       TYPE dd03l-fieldname,  "MOD-002+
END OF gt_seo_h_c.


DATA: BEGIN OF gt_seo_h OCCURS 0,
  qmnum      LIKE afih-qmnum,
  deli1      TYPE c,
  aufnr      LIKE aufk-aufnr,
  deli2      TYPE c,
  auart      LIKE aufk-auart,
  deli3      TYPE c,
  autyp      LIKE aufk-autyp,
  deli4      TYPE c,
  refnr      LIKE aufk-refnr,
  deli5      TYPE c,
  ernam      LIKE aufk-ernam,
  deli6      TYPE c,
  erdat      LIKE aufk-erdat,
  deli7      TYPE c,
  aenam      LIKE aufk-aenam,
  deli8      TYPE c,
  aedat      LIKE aufk-aedat,
  deli9      TYPE c,
  ktext      LIKE aufk-ktext,
  deli10     TYPE c,
  ltext      LIKE aufk-ltext,
  deli11     TYPE c,
  bstkd      LIKE pmsdo-bstkd,
  deli12     TYPE c,
  bstdk      LIKE pmsdo-bstdk,
  deli13     TYPE c,
  bukrs      LIKE aufk-bukrs,
  deli14     TYPE c,
  werks      LIKE aufk-werks,
  deli15     TYPE c,
  gsber      LIKE aufk-gsber,
  deli16     TYPE c,
  kokrs      LIKE aufk-kokrs,
  deli17     TYPE c,
  kostv      LIKE aufk-kostv,
  deli18     TYPE c,
  loekz      LIKE aufk-loekz,
  deli19     TYPE c,
  prctr      LIKE aufk-prctr,
  deli20     TYPE c,
  pspel      LIKE aufk-pspel,
  deli21     TYPE c,
  kalsm      LIKE aufk-kalsm,
  deli22     TYPE c,
  zschl      LIKE aufk-zschl,
  deli23     TYPE c,
  awsls      LIKE aufk-awsls,
  deli24     TYPE c,
  abgsl      LIKE aufk-abgsl,
  deli25     TYPE c,
  txjcd      LIKE aufk-txjcd,
  deli26     TYPE c,
  sdate      LIKE aufk-sdate,
  deli27     TYPE c,
  user2      LIKE aufk-user2,
  deli28     TYPE c,
  user7      LIKE aufk-user7,
  deli29     TYPE c,
  user8      LIKE aufk-user8,
  deli30     TYPE c,
  objnr      LIKE aufk-objnr,
  deli31     TYPE c,
  kdauf      LIKE aufk-kdauf,
  deli32     TYPE c,
  kdpos      LIKE aufk-kdpos,
  deli33     TYPE c,
  akstl      LIKE aufk-akstl,
  deli34     TYPE c,
  adrnra     LIKE aufk-adrnra,
  deli35     TYPE c,
  cstg_vrnt  LIKE aufk-cstg_vrnt,
  deli36     TYPE c,
  zzsdc      LIKE aufk-zzsdc,
  deli37     TYPE c,
  zzapc      LIKE aufk-zzapc,
  deli38     TYPE c,
  zzcon      LIKE aufk-zzcon,
  deli39     TYPE c,
  zzpsf      LIKE aufk-zzpsf,
  deli40     TYPE c,
  zzcom      LIKE aufk-zzcom,
  deli41     TYPE c,
  zzrem      LIKE aufk-zzrem,
  deli42     TYPE c,
  zztrc      LIKE aufk-zztrc,
  deli43     TYPE c,
  gltrp      LIKE afko-gltrp,
  deli44     TYPE c,
  gstrp      LIKE afko-gstrp,
  deli45     TYPE c,
  ftrms      LIKE afko-ftrms,
  deli46     TYPE c,
  gltrs      LIKE afko-gltrs,
  deli47     TYPE c,
  gstrs      LIKE afko-gstrs,
  deli48     TYPE c,
  gstri      LIKE afko-gstri,
  deli49     TYPE c,
  getri      LIKE afko-getri,
  deli50     TYPE c,
  gltri      LIKE afko-gltri,
  deli51     TYPE c,
  ftrmi      LIKE afko-ftrmi,
  deli52     TYPE c,
  ftrmp      LIKE afko-ftrmp,
  deli53     TYPE c,
  plnty      LIKE afko-plnty,
  deli54     TYPE c,
  plnnr      LIKE afko-plnnr,
  deli55     TYPE c,
  plnaw      LIKE afko-plnaw,
  deli56     TYPE c,
  plnal      LIKE afko-plnal,
  deli57     TYPE c,
  pverw      LIKE afko-pverw,
  deli58     TYPE c,
  plsvb(17)  TYPE c,
  deli59     TYPE c,
  plnme(3)   TYPE c,
  deli60     TYPE c,
  plsvn(17)  TYPE c,
  deli61     TYPE c,
  pdatv      LIKE afko-pdatv,
  deli62     TYPE c,
  plgrp      LIKE afko-plgrp,
  deli63     TYPE c,
  lodiv(17)  TYPE c,
  deli64     TYPE c,
  stlty      LIKE afko-stlty,
  deli65     TYPE c,
  stlbez      LIKE afko-stlbez,
  deli66     TYPE c,
  stlst      LIKE afko-stlst,
  deli67     TYPE c,
  stlnr      LIKE afko-stlnr,
  deli68     TYPE c,
  sdatv      LIKE afko-sdatv,
  deli69     TYPE c,
  sbmng(17)  TYPE c,
  deli70     TYPE c,
  sbmeh(3)   TYPE c,
  deli71     TYPE c,
  saenr      LIKE afko-saenr,
  deli72     TYPE c,
  stlal      LIKE afko-stlal,
  deli73     TYPE c,
  stlan      LIKE afko-stlan,
  deli74     TYPE c,
  slsvn(17)  TYPE c,
  deli75     TYPE c,
  slsbs(17)  TYPE c,
  deli76     TYPE c,
  artpr      LIKE afih-artpr,
  deli77     TYPE c,
  priok      LIKE afih-priok,
  deli78     TYPE c,
  equnr      LIKE afih-equnr,
  deli79     TYPE c,
  bautl      LIKE afih-bautl,
  deli80     TYPE c,
  anlzu      LIKE afih-anlzu,
  deli81     TYPE c,
  iwerk      LIKE afih-iwerk,
  deli82     TYPE c,
  ingpr      LIKE afih-ingpr,
  deli83     TYPE c,
  apgrp      LIKE afih-apgrp,
  deli84     TYPE c,
  gewrk      LIKE afih-gewrk,
  deli85     TYPE c,
  kunum      LIKE afih-kunum,
  deli86     TYPE c,
  aning      LIKE afih-aning,
  deli87     TYPE c,
  warpl      LIKE afih-warpl,
  deli88     TYPE c,
  abnum(10)  TYPE c,
  deli89     TYPE c,
  wapos      LIKE afih-wapos,
  deli90     TYPE c,
  aduhr      LIKE afih-aduhr,
  deli91     TYPE c,
  iphas      LIKE afih-iphas,
  deli92     TYPE c,
  ilart      LIKE afih-ilart,
  deli93     TYPE c,
  plknz      LIKE afih-plknz,
  deli94     TYPE c,
  serialnr   LIKE afih-serialnr,
  deli95     TYPE c,
  sermat     LIKE afih-sermat,
  deli96     TYPE c,
  objnr_p    LIKE pmsdo-objnr,
  deli97     TYPE c,
  vkorg      LIKE pmsdo-vkorg,
  deli98     TYPE c,
  vaplz      LIKE aufk-vaplz,
  deli99     TYPE c,
  wawrk      LIKE aufk-wawrk,
  deli100    TYPE c,
  kostl      LIKE iloa-kostl,
  deli101    TYPE c,
  proid       LIKE iloa-proid,
  deli102    TYPE c,
  stort      LIKE aufk-stort,
  deli103    TYPE c,
  sowrk      LIKE aufk-sowrk,
  deli104    TYPE c,
  vtweg      LIKE pmsdo-vtweg,
  deli105    TYPE c,
  spart       LIKE pmsdo-spart,
  deli106     TYPE c,
  vkgrp       LIKE pmsdo-vkgrp,
  deli107     TYPE c,
  vkbur       LIKE pmsdo-vkbur,
  deli108     TYPE c,
  cuobj       LIKE pmsdo-cuobj,
  deli109     TYPE c,
  iloan       LIKE iloa-iloan,
  deli110     TYPE c,
  tplnr       LIKE iloa-tplnr,
  deli111     TYPE c,
  abckz       LIKE iloa-abckz,
  deli112     TYPE c,
  abckzi      LIKE iloa-abckzi,
  deli113     TYPE c,
  eqfnr       LIKE iloa-eqfnr,
  deli114     TYPE c,
  eqfnri       LIKE iloa-eqfnri,
  deli115      TYPE c,
  swerk        LIKE iloa-swerk,
  deli116      TYPE c,
  swerki       LIKE iloa-swerki,
  deli117      TYPE c,
  stort_il     LIKE iloa-stort,
  deli118      TYPE c,
  storti       LIKE iloa-storti,
  deli119      TYPE c,
  msgrp        LIKE iloa-msgrp,
  deli120      TYPE c,
  msgrpi       LIKE iloa-msgrpi,
  deli121      TYPE c,
  beber        LIKE iloa-beber,
  deli122      TYPE c,
  beberi       LIKE iloa-beberi,
  deli123      TYPE c,
  cr_objty     LIKE iloa-cr_objty,
  deli124      TYPE c,
  ppsid        LIKE iloa-ppsid,
  deli125      TYPE c,
  ppsidi       LIKE iloa-ppsidi,
  deli126      TYPE c,
  gsber_il     LIKE iloa-gsber,
  deli127      TYPE c,
  gsberi       LIKE iloa-gsberi,
  deli128      TYPE c,
  kokrs_il     LIKE iloa-kokrs,
  deli129      TYPE c,
  proidi       LIKE iloa-proidi,
  deli130      TYPE c,
  bukrs_il     LIKE iloa-bukrs,
  deli131      TYPE c,
  bukrsi       LIKE iloa-bukrsi,
  deli132      TYPE c,
  anlnr        LIKE iloa-anlnr,
  deli133      TYPE c,
  anlnri       LIKE iloa-anlnri,
  deli134      TYPE c,
  anlun        LIKE iloa-anlun,
  deli135      TYPE c,
  anluni       LIKE iloa-anluni,
  deli136      TYPE c,
  daufn        LIKE iloa-daufn,
  deli137      TYPE c,
  daufni       LIKE iloa-daufni,
  deli138      TYPE c,
  aufnr_il     LIKE iloa-aufnr,
  deli139      TYPE c,
  aufnri       LIKE iloa-aufnri,
  deli140      TYPE c,
  tplnri       LIKE iloa-tplnri,
  deli141      TYPE c,
  vkorg_il     LIKE iloa-vkorg,
  deli142      TYPE c,
  vkorgi       LIKE iloa-vkorgi,
  deli143      TYPE c,
  vtweg_il     LIKE iloa-vtweg,
  deli144      TYPE c,
  vtwegi       LIKE iloa-vtwegi,
  deli145      TYPE c,
  spart_il     LIKE iloa-spart,
  deli146      TYPE c,
  sparti       LIKE iloa-sparti,
  deli147      TYPE c,
  adrnr        LIKE iloa-adrnr,
  deli148      TYPE c,
  adrnri       LIKE iloa-adrnri,
  deli149      TYPE c,
  owner        LIKE iloa-owner,
  deli150      TYPE c,
  vkbur_il     LIKE iloa-vkbur,
  deli151      TYPE c,
  vkgrp_il     LIKE iloa-vkgrp,
  deli152      TYPE c,
  sstatus(80)  TYPE c,
  deli153      TYPE c,
  sstatus2(40)  TYPE c,
  deli154      TYPE c,
  ustatus(80)  TYPE c,
  deli155      TYPE c,
  ustatus2(40) TYPE c,
  deli156      TYPE c,
  vbeln        TYPE vbeln,
  deli157      TYPE c,
  netwr(21)    TYPE c,
  deli158      TYPE c,
  waerk(5)     TYPE c,
  deli159      TYPE c,
  vbeln_d      TYPE vbeln,
  deli160      TYPE c,
  netwr_d(21)  TYPE c,
  deli161      TYPE c,
  waerk_d(5)   TYPE c,
  deli162      TYPE c,
  bemot        TYPE bemot,
  deli163      TYPE c,
  matnr_p      TYPE matnr,
  deli164      TYPE c,
  menge_p(17)  TYPE c,
  deli165      TYPE c,
  meins_p(3)   TYPE c,
  deli166      TYPE c,
  faktf_p      TYPE faktf,
  deli167      TYPE c,                "MOD-001+
  waers        TYPE dd03l-fieldname,  "MOD-001+
  deli168      TYPE c,                "MOD-001+
  netwr_sd     TYPE dd03l-fieldname,  "MOD-001+
  deli169      TYPE c,                "MOD-001+
  waerk_f      TYPE vbak-waerk,       "MOD-001+
  deli170      TYPE c,                "MOD-001+
  stceg_l      TYPE vbak-stceg_l,     "MOD-001+
  deli171      TYPE c,                "MOD-001+
  inco1        TYPE vbkd-inco1,       "MOD-001+
  deli172      TYPE c,                "MOD-001+
  inco2        TYPE vbkd-inco2,       "MOD-001+
  deli173      TYPE c,                "MOD-001+
  zterm        TYPE vbkd-zterm,       "MOD-001+
  deli174      TYPE c,                "MOD-002+
  bismt        TYPE mara-bismt,       "MOD-002+
  deli175      TYPE c,                "MOD-002+
  zzvisam1     TYPE aufk-zzvisam1,    "MOD-002+
  deli176      TYPE c,                "MOD-002+
  zzvisam2     TYPE aufk-zzvisam2,    "MOD-002+
  deli177      TYPE c,                "MOD-002+
  maufnr       TYPE afko-maufnr,      "MOD-002+
END OF gt_seo_h.

DATA: BEGIN OF gt_seo_h2 OCCURS 0,
  qmnum      LIKE afih-qmnum,
  deli1      TYPE c,
  aufnr      LIKE aufk-aufnr,
  deli2      TYPE c,
  auart      LIKE aufk-auart,
  deli3      TYPE c,
  autyp      LIKE aufk-autyp,
  deli4      TYPE c,
  refnr      LIKE aufk-refnr,
  deli5      TYPE c,
  ernam      LIKE aufk-ernam,
  deli6      TYPE c,
  erdat      LIKE aufk-erdat,
  deli7      TYPE c,
  aenam      LIKE aufk-aenam,
  deli8      TYPE c,
  aedat      LIKE aufk-aedat,
  deli9      TYPE c,
  ktext      LIKE aufk-ktext,
  deli10     TYPE c,
  ltext      LIKE aufk-ltext,
  deli11     TYPE c,
  bstkd      LIKE pmsdo-bstkd,
  deli12     TYPE c,
  bstdk      LIKE pmsdo-bstdk,
  deli13     TYPE c,
  bukrs      LIKE aufk-bukrs,
  deli14     TYPE c,
  werks      LIKE aufk-werks,
  deli15     TYPE c,
  gsber      LIKE aufk-gsber,
  deli16     TYPE c,
  kokrs      LIKE aufk-kokrs,
  deli17     TYPE c,
  kostv      LIKE aufk-kostv,
  deli18     TYPE c,
  loekz      LIKE aufk-loekz,
  deli19     TYPE c,
  prctr      LIKE aufk-prctr,
  deli20     TYPE c,
  pspel      LIKE aufk-pspel,
  deli21     TYPE c,
  kalsm      LIKE aufk-kalsm,
  deli22     TYPE c,
  zschl      LIKE aufk-zschl,
  deli23     TYPE c,
  awsls      LIKE aufk-awsls,
  deli24     TYPE c,
  abgsl      LIKE aufk-abgsl,
  deli25     TYPE c,
  txjcd      LIKE aufk-txjcd,
  deli26     TYPE c,
  sdate      LIKE aufk-sdate,
  deli27     TYPE c,
  user2      LIKE aufk-user2,
  deli28     TYPE c,
  user7      LIKE aufk-user7,
  deli29     TYPE c,
  user8      LIKE aufk-user8,
  deli30     TYPE c,
  objnr      LIKE aufk-objnr,
  deli31     TYPE c,
  kdauf      LIKE aufk-kdauf,
  deli32     TYPE c,
  kdpos      LIKE aufk-kdpos,
  deli33     TYPE c,
  akstl      LIKE aufk-akstl,
  deli34     TYPE c,
  adrnra     LIKE aufk-adrnra,
  deli35     TYPE c,
  cstg_vrnt  LIKE aufk-cstg_vrnt,
  deli36     TYPE c,
  zzsdc      LIKE aufk-zzsdc,
  deli37     TYPE c,
  zzapc      LIKE aufk-zzapc,
  deli38     TYPE c,
  zzcon      LIKE aufk-zzcon,
  deli39     TYPE c,
  zzpsf      LIKE aufk-zzpsf,
  deli40     TYPE c,
  zzcom      LIKE aufk-zzcom,
  deli41     TYPE c,
  zzrem      LIKE aufk-zzrem,
  deli42     TYPE c,
  zztrc      LIKE aufk-zztrc,
  deli43     TYPE c,
  gltrp      LIKE afko-gltrp,
  deli44     TYPE c,
  gstrp      LIKE afko-gstrp,
  deli45     TYPE c,
  ftrms      LIKE afko-ftrms,
  deli46     TYPE c,
  gltrs      LIKE afko-gltrs,
  deli47     TYPE c,
  gstrs      LIKE afko-gstrs,
  deli48     TYPE c,
  gstri      LIKE afko-gstri,
  deli49     TYPE c,
  getri      LIKE afko-getri,
  deli50     TYPE c,
  gltri      LIKE afko-gltri,
  deli51     TYPE c,
  ftrmi      LIKE afko-ftrmi,
  deli52     TYPE c,
  ftrmp      LIKE afko-ftrmp,
  deli53     TYPE c,
  plnty      LIKE afko-plnty,
  deli54     TYPE c,
  plnnr      LIKE afko-plnnr,
  deli55     TYPE c,
  plnaw      LIKE afko-plnaw,
  deli56     TYPE c,
  plnal      LIKE afko-plnal,
  deli57     TYPE c,
  pverw      LIKE afko-pverw,
  deli58     TYPE c,
  plsvb      LIKE afko-plsvb,
  deli59     TYPE c,
  plnme      LIKE afko-plnme,
  deli60     TYPE c,
  plsvn      LIKE afko-plsvn,
  deli61     TYPE c,
  pdatv      LIKE afko-pdatv,
  deli62     TYPE c,
  plgrp      LIKE afko-plgrp,
  deli63     TYPE c,
  lodiv      LIKE afko-lodiv,
  deli64     TYPE c,
  stlty      LIKE afko-stlty,
  deli65     TYPE c,
  stlbez      LIKE afko-stlbez,
  deli66     TYPE c,
  stlst      LIKE afko-stlst,
  deli67     TYPE c,
  stlnr      LIKE afko-stlnr,
  deli68     TYPE c,
  sdatv      LIKE afko-sdatv,
  deli69     TYPE c,
  sbmng      LIKE afko-sbmng,
  deli70     TYPE c,
  sbmeh      LIKE afko-sbmeh,
  deli71     TYPE c,
  saenr      LIKE afko-saenr,
  deli72     TYPE c,
  stlal      LIKE afko-stlal,
  deli73     TYPE c,
  stlan      LIKE afko-stlan,
  deli74     TYPE c,
  slsvn      LIKE afko-slsvn,
  deli75     TYPE c,
  slsbs      LIKE afko-slsbs,
  deli76     TYPE c,
  artpr      LIKE afih-artpr,
  deli77     TYPE c,
  priok      LIKE afih-priok,
  deli78     TYPE c,
  equnr      LIKE afih-equnr,
  deli79     TYPE c,
  bautl      LIKE afih-bautl,
  deli80     TYPE c,
  anlzu      LIKE afih-anlzu,
  deli81     TYPE c,
  iwerk      LIKE afih-iwerk,
  deli82     TYPE c,
  ingpr      LIKE afih-ingpr,
  deli83     TYPE c,
  apgrp      LIKE afih-apgrp,
  deli84     TYPE c,
  gewrk      LIKE afih-gewrk,
  deli85     TYPE c,
  kunum      LIKE afih-kunum,
  deli86     TYPE c,
  aning      LIKE afih-aning,
  deli87     TYPE c,
  warpl      LIKE afih-warpl,
  deli88     TYPE c,
  abnum      LIKE afih-abnum,
  deli89     TYPE c,
  wapos      LIKE afih-wapos,
  deli90     TYPE c,
  aduhr      LIKE afih-aduhr,
  deli91     TYPE c,
  iphas      LIKE afih-iphas,
  deli92     TYPE c,
  ilart      LIKE afih-ilart,
  deli93     TYPE c,
  plknz      LIKE afih-plknz,
  deli94     TYPE c,
  serialnr   LIKE afih-serialnr,
  deli95     TYPE c,
  sermat     LIKE afih-sermat,
  deli96     TYPE c,
  objnr_p    LIKE pmsdo-objnr,
  deli97     TYPE c,
  vkorg      LIKE pmsdo-vkorg,
  deli98     TYPE c,
  vaplz      LIKE aufk-vaplz,
  deli99     TYPE c,
  wawrk      LIKE aufk-wawrk,
  deli100    TYPE c,
  kostl      LIKE iloa-kostl,
  deli101    TYPE c,
  proid       LIKE iloa-proid,
  deli102    TYPE c,
  stort      LIKE aufk-stort,
  deli103    TYPE c,
  sowrk      LIKE aufk-sowrk,
  deli104    TYPE c,
  vtweg      LIKE pmsdo-vtweg,
  deli105    TYPE c,
  spart       LIKE pmsdo-spart,
  deli106     TYPE c,
  vkgrp       LIKE pmsdo-vkgrp,
  deli107     TYPE c,
  vkbur       LIKE pmsdo-vkbur,
  deli108     TYPE c,
  cuobj       LIKE pmsdo-cuobj,
  deli109     TYPE c,
  iloan       LIKE iloa-iloan,
  deli110     TYPE c,
  tplnr       LIKE iloa-tplnr,
  deli111     TYPE c,
  abckz       LIKE iloa-abckz,
  deli112     TYPE c,
  abckzi      LIKE iloa-abckzi,
  deli113     TYPE c,
  eqfnr       LIKE iloa-eqfnr,
  deli114     TYPE c,
  eqfnri       LIKE iloa-eqfnri,
  deli115      TYPE c,
  swerk        LIKE iloa-swerk,
  deli116      TYPE c,
  swerki       LIKE iloa-swerki,
  deli117      TYPE c,
  stort_il     LIKE iloa-stort,
  deli118      TYPE c,
  storti       LIKE iloa-storti,
  deli119      TYPE c,
  msgrp        LIKE iloa-msgrp,
  deli120      TYPE c,
  msgrpi       LIKE iloa-msgrpi,
  deli121      TYPE c,
  beber        LIKE iloa-beber,
  deli122      TYPE c,
  beberi       LIKE iloa-beberi,
  deli123      TYPE c,
  cr_objty     LIKE iloa-cr_objty,
  deli124      TYPE c,
  ppsid        LIKE iloa-ppsid,
  deli125      TYPE c,
  ppsidi       LIKE iloa-ppsidi,
  deli126      TYPE c,
  gsber_il     LIKE iloa-gsber,
  deli127      TYPE c,
  gsberi       LIKE iloa-gsberi,
  deli128      TYPE c,
  kokrs_il     LIKE iloa-kokrs,
  deli129      TYPE c,
  proidi       LIKE iloa-proidi,
  deli130      TYPE c,
  bukrs_il     LIKE iloa-bukrs,
  deli131      TYPE c,
  bukrsi       LIKE iloa-bukrsi,
  deli132      TYPE c,
  anlnr        LIKE iloa-anlnr,
  deli133      TYPE c,
  anlnri       LIKE iloa-anlnri,
  deli134      TYPE c,
  anlun        LIKE iloa-anlun,
  deli135      TYPE c,
  anluni       LIKE iloa-anluni,
  deli136      TYPE c,
  daufn        LIKE iloa-daufn,
  deli137      TYPE c,
  daufni       LIKE iloa-daufni,
  deli138      TYPE c,
  aufnr_il     LIKE iloa-aufnr,
  deli139      TYPE c,
  aufnri       LIKE iloa-aufnri,
  deli140      TYPE c,
  tplnri       LIKE iloa-tplnri,
  deli141      TYPE c,
  vkorg_il     LIKE iloa-vkorg,
  deli142      TYPE c,
  vkorgi       LIKE iloa-vkorgi,
  deli143      TYPE c,
  vtweg_il     LIKE iloa-vtweg,
  deli144      TYPE c,
  vtwegi       LIKE iloa-vtwegi,
  deli145      TYPE c,
  spart_il     LIKE iloa-spart,
  deli146      TYPE c,
  sparti       LIKE iloa-sparti,
  deli147      TYPE c,
  adrnr        LIKE iloa-adrnr,
  deli148      TYPE c,
  adrnri       LIKE iloa-adrnri,
  deli149      TYPE c,
  owner        LIKE iloa-owner,
  deli150      TYPE c,
  vkbur_il     LIKE iloa-vkbur,
  deli151      TYPE c,
  vkgrp_il     LIKE iloa-vkgrp,
  deli152      TYPE c,
  sstatus(80)  TYPE c,
  deli153      TYPE c,
  sstatus2(40)  TYPE c,
  deli154      TYPE c,
  ustatus(80)  TYPE c,
  deli155      TYPE c,
  ustatus2(40)  TYPE c,
  deli156      TYPE c,
  vbeln         TYPE vbak-vbeln,
  deli157      TYPE c,
  netwr     TYPE vbak-netwr,
  deli158      TYPE c,
  waerk      TYPE vbak-waerk,
  deli159      TYPE c,
  vbeln_d         TYPE vbak-vbeln,
  deli160      TYPE c,
  netwr_d     TYPE vbak-netwr,
  deli161      TYPE c,
  waerk_d      TYPE vbak-waerk,
  deli162      TYPE c,
  bemot        TYPE bemot,
  deli163      TYPE c,
  matnr_p      TYPE matnr,
  deli164      TYPE c,
  menge_p      TYPE menge,
  deli165      TYPE c,
  meins_p      TYPE meins,
  deli166      TYPE c,
  faktf_p      TYPE faktf,
  deli167      TYPE c,                "MOD-001+
  waers        TYPE dd03l-fieldname,  "MOD-001+
  deli168      TYPE c,                "MOD-001+
  netwr_sd     TYPE dd03l-fieldname,  "MOD-001+
  deli169      TYPE c,                "MOD-001+
  waerk_f      TYPE dd03l-fieldname,  "MOD-001+
  deli170      TYPE c,                "MOD-001+
  stceg_l      TYPE vbak-stceg_l,     "MOD-001+
  deli171      TYPE c,                "MOD-001+
  inco1        TYPE vbkd-inco1,       "MOD-001+
  deli172      TYPE c,                "MOD-001+
  inco2        TYPE vbkd-inco2,       "MOD-001+
  deli173      TYPE c,                "MOD-001+
  zterm        TYPE vbkd-zterm,       "MOD-001+
  deli174      TYPE c,                "MOD-002+
  bismt        TYPE mara-bismt,       "MOD-002+
  deli175      TYPE c,                "MOD-002+
  zzvisam1     TYPE aufk-zzvisam1,    "MOD-002+
  deli176      TYPE c,                "MOD-002+
  zzvisam2     TYPE aufk-zzvisam2,    "MOD-002+
  deli177      TYPE c,                "MOD-002+
  maufnr       TYPE afko-maufnr,      "MOD-002+
END OF gt_seo_h2.


DATA: lv_atinn  TYPE atinn,
      lv_mpobj  LIKE imptt-mpobj,
      lv1_point LIKE imptt-point,
      lv_index TYPE sy-tabix.


DATA: h_stat_flag,
      lv_objnr_ord LIKE aufk-objnr,
      ls_pmsdo TYPE pmsdo,
      ls_iloan TYPE iloa.

*------------------------------------------------------------------
* Variables
DATA: lt_viqmfe TYPE TABLE OF wqmfe,
      ls_viqmfe TYPE wqmfe,
      lt_viqmur TYPE TABLE OF wqmur,
      ls_viqmur TYPE wqmur,
      es_viqmel TYPE viqmel,
      lt_longtxt TYPE TABLE OF alm_me_longtext,
      ls_longtxt TYPE alm_me_longtext,
      lt_longtxt_item TYPE TABLE OF alm_me_longtext.

DATA  gv_werks TYPE werks.


DATA: g_directory(25) TYPE c VALUE '/var/load/xxx/UK/read/',
      g_ofile         LIKE /sapdmc/lsoinp-filename,
      p_logsys        LIKE tbdlst-logsys.


FIELD-SYMBOLS: <gs_value>  TYPE ibco2_value_rec.


TABLES: qmel.
DATA:  lv_kdauf TYPE kdauf,
       lv_kdpos TYPE kdpos,
       lv_plnnr TYPE mpos-plnnr,
       lv_plnal TYPE mpos-plnal,
       lv_plnty TYPE mpos-plnty,
       lv_pstxt TYPE mpos-pstxt,
       lv_vbeln TYPE vbeln,
       lv_vbeln_dmr TYPE vbeln,
       lv_waerk TYPE waerk,
       lv_netwr TYPE netwr,
       lv_objk     TYPE ihpa-objnr,
       lv_parnr    TYPE ihpa-parnr,
       lv_name TYPE kna1-name1.
*DATA: gt_afih TYPE TABLE OF afih.

************************************************************************
*       S E L E C T - O P T I O N S / P A R A M E T E R S              *
************************************************************************
SELECTION-SCREEN : BEGIN OF BLOCK b1 WITH FRAME TITLE text-001.
PARAMETERS:     p_werks  TYPE aufk-werks MEMORY ID wrk.
SELECT-OPTIONS: s_aufnr  FOR  aufk-aufnr.
SELECT-OPTIONS: s_auart  FOR  aufk-auart.
SELECT-OPTIONS: s_erdat  FOR  aufk-erdat.
SELECT-OPTIONS: s_aedat  FOR  aufk-aedat.
SELECT-OPTIONS: s_vtweg  FOR  knvv-vtweg.
PARAMETERS:     p_bukrs  TYPE aufk-bukrs OBLIGATORY MEMORY ID buk,
                p_vkorg  TYPE knvv-vkorg MEMORY ID vko.

PARAMETERS:     h_filet  LIKE rlgrap-filename
                    DEFAULT 'C:\SAP\Seo_Header'.

PARAMETERS:     p_filet  LIKE rlgrap-filename
                    DEFAULT 'C:\SAP\Seo_partners'.
*PARAMETERS:     o_filet  LIKE rlgrap-filename
*                    DEFAULT 'C:\SAP\seo_Operations'.
*PARAMETERS:     p_filet  LIKE rlgrap-filename
*                    DEFAULT 'C:\SAP\seo_Parts_Ordered'.
*PARAMETERS:     l1_filet  LIKE rlgrap-filename
*                    DEFAULT 'C:\SAP\seo_header_longtext'.
*PARAMETERS:     l2_filet  LIKE rlgrap-filename
*                    DEFAULT 'C:\SAP\seo_item_longtext'.
SELECTION-SCREEN: END OF BLOCK b1.

* Comment
SELECTION-SCREEN BEGIN OF BLOCK b2 WITH FRAME TITLE text-002.
SELECTION-SCREEN BEGIN OF LINE.
SELECTION-SCREEN COMMENT 1(72) text-c01.
SELECTION-SCREEN END OF LINE.
SELECTION-SCREEN BEGIN OF LINE.
SELECTION-SCREEN COMMENT 1(72) text-c02.
SELECTION-SCREEN END OF LINE.
SELECTION-SCREEN BEGIN OF LINE.
SELECTION-SCREEN COMMENT 1(72) text-c03.
SELECTION-SCREEN END OF LINE.
SELECTION-SCREEN END OF BLOCK b2.


*.................. Selection screen validations...................... *
AT SELECTION-SCREEN ON p_werks.

  IF p_werks IS NOT INITIAL.
* Check planning plant
    SELECT SINGLE werks
         INTO gv_werks
         FROM t001w
         WHERE werks = p_werks.

    IF sy-subrc <> 0.
*.. Planning plant does not exist
      MESSAGE e001(00) WITH text-e02.
    ENDIF.
  ENDIF.


*- Initialization -----------------------------------------------------*
INITIALIZATION.

  CALL FUNCTION 'OWN_LOGICAL_SYSTEM_GET'
    IMPORTING
      own_logical_system             = p_logsys
    EXCEPTIONS
      own_logical_system_not_defined = 1
      OTHERS                         = 2.
  IF sy-subrc <> 0.
    MESSAGE ID sy-msgid TYPE sy-msgty NUMBER sy-msgno
         WITH sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4.
  ENDIF.

************************************************************************
*       S T A R T - O F - S E L E C T I O N    E V E N T               *
************************************************************************
START-OF-SELECTION.

* Select all seoications
*  SELECT qmnum objnr
*    INTO CORRESPONDING FIELDS OF TABLE gt_seo
*    FROM viqmel
*    WHERE qmnum IN s_qmnum
*      AND qmart IN s_qmart
*      AND iwerk EQ p_iwerk .

*  SELECT *
*    INTO CORRESPONDING FIELDS OF TABLE gt_seo_h2
*     FROM viaufkst
*     WHERE aufnr IN s_aufnr
*       AND auart IN s_auart
*       AND erdat IN s_erdat
*       AND aedat IN s_aedat
*       AND werks EQ p_werks
**       AND loekz NE 'X'
*       AND iphas NE '6'
*       AND vtweg IN s_vtweg.
  DATA: lv_where TYPE string.
  lv_where = 'aufnr IN s_aufnr AND auart IN s_auart AND erdat IN s_erdat AND aedat IN s_aedat AND bukrs EQ p_bukrs'.
  IF p_werks IS NOT INITIAL.
    CONCATENATE lv_where 'AND werks EQ p_werks' INTO lv_where SEPARATED BY space.
  ENDIF.
  IF p_vkorg IS NOT INITIAL.
    CONCATENATE lv_where 'AND vkorg EQ p_vkorg' INTO lv_where SEPARATED BY space.
  ENDIF.
  CONCATENATE lv_where 'AND iphas NE ''6'' AND vtweg IN s_vtweg' INTO lv_where SEPARATED BY space.
  SELECT *
    INTO CORRESPONDING FIELDS OF TABLE gt_seo_h2
     FROM viaufkst
     WHERE (lv_where).

** Filter out orders which aren't linked in QMEL
*  IF gt_seo_h2[] IS NOT INITIAL.
*    SELECT aufnr qmnum FROM afih
*      INTO CORRESPONDING FIELDS OF TABLE gt_afih
*      FOR ALL ENTRIES IN gt_seo_h2
*      WHERE aufnr EQ gt_seo_h2-aufnr.
*    SORT gt_afih ASCENDING BY aufnr.
*    LOOP AT gt_seo_h2.
*      READ TABLE gt_afih WITH KEY aufnr = gt_seo_h2-aufnr BINARY SEARCH TRANSPORTING NO FIELDS.
*      IF sy-subrc NE 0.
*        "Remove order
*        DELETE gt_seo_h2 WHERE aufnr EQ gt_seo_h2-aufnr.
*      ENDIF.
*    ENDLOOP.
*  ENDIF.

  PERFORM get_data.

  IF NOT gt_seo_h2[] IS INITIAL.
    PERFORM download_files.
  ENDIF.


*&---------------------------------------------------------------------*
*&      Form  get_details
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
FORM get_data.

*>>> Begin insert MOD-001
  TYPES: BEGIN OF lty_vbak,
           vbeln TYPE vbeln_va,
           netwr TYPE netwr,
           waerk TYPE waerk,
           stceg_l TYPE land1tx,
           vbtyp TYPE vbtyp,
         END OF lty_vbak.

  TYPES: BEGIN OF lty_vbkd,
           vbeln TYPE vbeln_va,
           inco1 TYPE inco1,
           inco2 TYPE inco2,
           zterm TYPE dzterm,
         END OF lty_vbkd.

  DATA: lt_vbak TYPE TABLE OF lty_vbak,
        lt_vbkd TYPE TABLE OF lty_vbkd.

  DATA: lv_no_contract TYPE flag,
        lt_cobrb TYPE TABLE OF cobrb.

  DATA: ls_ctam TYPE yam_ctam_ccodes.
  DATA: ls_vbap TYPE vbap,
        ls_vbak TYPE vbak.

  FIELD-SYMBOLS: <ls_vbak> TYPE lty_vbak,
                 <ls_vbkd> TYPE lty_vbkd.

  IF gt_seo_h2[] IS NOT INITIAL.
    SELECT vbeln netwr waerk stceg_l vbtyp FROM vbak
      INTO TABLE lt_vbak
      FOR ALL ENTRIES IN gt_seo_h2
      WHERE vbeln EQ gt_seo_h2-kdauf.
    SORT lt_vbak ASCENDING BY vbeln.

    SELECT vbeln inco1 inco2 zterm FROM vbkd
      INTO TABLE lt_vbkd
      FOR ALL ENTRIES IN gt_seo_h2
      WHERE vbeln EQ gt_seo_h2-kdauf
        AND posnr EQ '000000'.
    SORT lt_vbkd ASCENDING BY vbeln.
  ENDIF.
*<<< End insert MOD-001

  LOOP AT gt_seo_h2.

    CLEAR: lv_no_contract.

    SELECT SINGLE * FROM pmsdo INTO CORRESPONDING FIELDS OF ls_pmsdo
     WHERE objnr = gt_seo_h2-objnr.

    SELECT SINGLE * FROM iloa INTO CORRESPONDING FIELDS OF ls_iloan
     WHERE iloan = gt_seo_h2-iloan.


    REFRESH: h_status_tab.
    CONCATENATE 'OR' gt_seo_h2-aufnr INTO lv_objnr_ord.

    CALL FUNCTION 'STATUS_READ'
      EXPORTING
        objnr            = lv_objnr_ord
        only_active      = 'X'
      TABLES
        status           = h_status_tab
      EXCEPTIONS
        object_not_found = 01.


    LOOP AT h_status_tab.
      IF h_status_tab-stat(1) = 'I'.
        CONCATENATE gt_seo_h2-sstatus h_status_tab-stat INTO gt_seo_h2-sstatus SEPARATED BY ' '.
      ELSEIF h_status_tab-stat(1) = 'E'.
        CONCATENATE gt_seo_h2-ustatus h_status_tab-stat INTO gt_seo_h2-ustatus SEPARATED BY ' '.
      ENDIF.
    ENDLOOP.

    CLEAR: lv_sttxt, lv_sttxtu.
    CALL FUNCTION 'STATUS_TEXT_EDIT'
      EXPORTING
        objnr         = lv_objnr_ord
        spras         = sy-langu
        flg_user_stat = 'X'
        only_active   = 'X'
      IMPORTING
        line          = lv_sttxt
        user_line     = lv_sttxtu.

    gt_seo_h2-sstatus2 = lv_sttxt.
    gt_seo_h2-ustatus2 = lv_sttxtu.


    IF lv_sttxt CS 'CLSD'.
      CONTINUE.
    ENDIF.
* Detect quotation/DMR
    CLEAR: lv_netwr, lv_waerk, lv_vbeln, lv_vbeln_dmr.

    SELECT SINGLE netwr waerk vbeln
      FROM vbak INTO (lv_netwr, lv_waerk, lv_vbeln)
      WHERE aufnr = gt_seo_h2-aufnr
            AND vbtyp = 'B'.
    IF sy-subrc = 0.
      gt_seo_h2-netwr = lv_netwr.
      gt_seo_h2-waerk = lv_waerk.
      gt_seo_h2-vbeln = lv_vbeln.
      SELECT SINGLE vbeln FROM vbfa INTO lv_vbeln_dmr
        WHERE vbelv = lv_vbeln
        AND vbtyp_n = 'L'.
      IF sy-subrc = 0.
***
      SELECT SINGLE netwr waerk
      FROM vbak INTO (lv_netwr, lv_waerk)
      WHERE vbeln = lv_vbeln_dmr.
***
        gt_seo_h2-netwr_d = lv_netwr.
        gt_seo_h2-waerk_d = lv_waerk.
        gt_seo_h2-vbeln_d = lv_vbeln_dmr.
      ENDIF.
    ELSE.
      SELECT SINGLE netwr waerk vbeln
        FROM vbak INTO (lv_netwr, lv_waerk, lv_vbeln_dmr)
        WHERE aufnr = gt_seo_h2-aufnr
              AND vbtyp = 'L'.
      IF sy-subrc = 0.
        gt_seo_h2-netwr_d = lv_netwr.
        gt_seo_h2-waerk_d = lv_waerk.
        gt_seo_h2-vbeln_d = lv_vbeln_dmr.
      ENDIF.
    ENDIF.

*>>> Begin insert MOD-001
    READ TABLE lt_vbak ASSIGNING <ls_vbak>
      WITH KEY vbeln = gt_seo_h2-kdauf
      BINARY SEARCH.
    IF sy-subrc EQ 0.
      gt_seo_h2-netwr_sd = <ls_vbak>-netwr.
      gt_seo_h2-waerk_f = <ls_vbak>-waerk.
      gt_seo_h2-stceg_l = <ls_vbak>-stceg_l.
*      "Check if it's a contract
*      IF <ls_vbak>-vbtyp NE 'G'.
*        SELECT cobrb~kdauf cobrb~kdpos
*          INTO CORRESPONDING FIELDS OF TABLE lt_cobrb
*          FROM aufk AS aufk
*          INNER JOIN cobrb AS cobrb
*            ON cobrb~objnr EQ aufk~objnr
*          WHERE aufk~aufnr EQ gt_seo_h2-aufnr
*            AND cobrb~urzuo EQ '1C'.
*        IF sy-subrc NE 0.
*          lv_no_contract = 'X'.
*        ENDIF.
*      ENDIF.
    ENDIF.
    READ TABLE lt_vbkd ASSIGNING <ls_vbkd>
      WITH KEY vbeln = gt_seo_h2-kdauf
      BINARY SEARCH.
    IF sy-subrc EQ 0.
      gt_seo_h2-inco1 = <ls_vbkd>-inco1.
      gt_seo_h2-inco2 = <ls_vbkd>-inco2.
      gt_seo_h2-zterm = <ls_vbkd>-zterm.
    ENDIF.

    "Check if it's a contract
    SELECT SINGLE * FROM vbak
      INTO ls_vbak
      WHERE vbeln EQ gt_seo_h2-kdauf
        AND vbtyp EQ 'G'.
    IF sy-subrc NE 0.
      SELECT SINGLE * FROM yam_ctam_ccodes
        INTO ls_ctam
        WHERE bukrs EQ gt_seo_h2-bukrs.
      IF sy-subrc NE 0.
        "SEED code clearing KDAUF & KDPOS
        SELECT SINGLE vbeln posnr vgbel vgpos
          FROM vbap
          INTO CORRESPONDING FIELDS OF ls_vbap
          WHERE vbeln EQ gt_seo_h2-kdauf
            AND posnr EQ gt_seo_h2-kdpos.
        IF sy-subrc EQ 0.
          SELECT SINGLE * FROM vbak
            INTO ls_vbak
            WHERE vbeln EQ ls_vbap-vgbel
              AND vbtyp EQ 'G'.
          IF sy-subrc NE 0.
            CLEAR: gt_seo_h2-kdauf, gt_seo_h2-kdpos.
          ELSE.
            gt_seo_h2-kdauf = ls_vbap-vgbel.
            gt_seo_h2-kdpos = ls_vbap-vgpos.
          ENDIF.
        ENDIF.
      ENDIF.
    ENDIF.
*<<< End insert MOD-001

    MOVE '|' TO: gt_seo_h2-deli1, gt_seo_h2-deli2, gt_seo_h2-deli3,
                  gt_seo_h2-deli4, gt_seo_h2-deli5, gt_seo_h2-deli6,
                  gt_seo_h2-deli7, gt_seo_h2-deli8, gt_seo_h2-deli9,
                  gt_seo_h2-deli10, gt_seo_h2-deli11, gt_seo_h2-deli12,
                  gt_seo_h2-deli13, gt_seo_h2-deli14, gt_seo_h2-deli15,
                  gt_seo_h2-deli16, gt_seo_h2-deli17, gt_seo_h2-deli18,
                  gt_seo_h2-deli19, gt_seo_h2-deli20, gt_seo_h2-deli21,
                  gt_seo_h2-deli22, gt_seo_h2-deli23, gt_seo_h2-deli24,
                  gt_seo_h2-deli23, gt_seo_h2-deli24, gt_seo_h2-deli25,
                  gt_seo_h2-deli26, gt_seo_h2-deli27, gt_seo_h2-deli28,
                  gt_seo_h2-deli29, gt_seo_h2-deli30, gt_seo_h2-deli31,
                  gt_seo_h2-deli32, gt_seo_h2-deli33, gt_seo_h2-deli34,
                  gt_seo_h2-deli35, gt_seo_h2-deli36, gt_seo_h2-deli37,
                  gt_seo_h2-deli38, gt_seo_h2-deli39, gt_seo_h2-deli40,
                  gt_seo_h2-deli41, gt_seo_h2-deli42, gt_seo_h2-deli43,
                  gt_seo_h2-deli44, gt_seo_h2-deli45, gt_seo_h2-deli46,
                  gt_seo_h2-deli47, gt_seo_h2-deli48, gt_seo_h2-deli49,
                  gt_seo_h2-deli50, gt_seo_h2-deli51, gt_seo_h2-deli52,
                  gt_seo_h2-deli53, gt_seo_h2-deli54, gt_seo_h2-deli55,
                  gt_seo_h2-deli56, gt_seo_h2-deli57, gt_seo_h2-deli58,
                  gt_seo_h2-deli59, gt_seo_h2-deli60, gt_seo_h2-deli61,
                  gt_seo_h2-deli62, gt_seo_h2-deli63, gt_seo_h2-deli64,
                  gt_seo_h2-deli65, gt_seo_h2-deli66, gt_seo_h2-deli67,
                  gt_seo_h2-deli68, gt_seo_h2-deli69, gt_seo_h2-deli70,
                  gt_seo_h2-deli71, gt_seo_h2-deli72, gt_seo_h2-deli73,
                  gt_seo_h2-deli74, gt_seo_h2-deli75, gt_seo_h2-deli76,
                  gt_seo_h2-deli77, gt_seo_h2-deli78, gt_seo_h2-deli79,
                  gt_seo_h2-deli80, gt_seo_h2-deli81, gt_seo_h2-deli82,
                  gt_seo_h2-deli83, gt_seo_h2-deli84, gt_seo_h2-deli85,
                  gt_seo_h2-deli86, gt_seo_h2-deli87, gt_seo_h2-deli88,
                  gt_seo_h2-deli89, gt_seo_h2-deli90, gt_seo_h2-deli91,
                  gt_seo_h2-deli92, gt_seo_h2-deli93, gt_seo_h2-deli94,
                  gt_seo_h2-deli95, gt_seo_h2-deli96, gt_seo_h2-deli97,
                  gt_seo_h2-deli98, gt_seo_h2-deli99, gt_seo_h2-deli100,
                  gt_seo_h2-deli101, gt_seo_h2-deli102, gt_seo_h2-deli103,
                  gt_seo_h2-deli104, gt_seo_h2-deli105, gt_seo_h2-deli106,
                  gt_seo_h2-deli107, gt_seo_h2-deli108, gt_seo_h2-deli109,
                  gt_seo_h2-deli110, gt_seo_h2-deli111, gt_seo_h2-deli112,
                  gt_seo_h2-deli113, gt_seo_h2-deli114, gt_seo_h2-deli115,
                  gt_seo_h2-deli116, gt_seo_h2-deli117, gt_seo_h2-deli118,
                  gt_seo_h2-deli119, gt_seo_h2-deli120, gt_seo_h2-deli121,
                  gt_seo_h2-deli122, gt_seo_h2-deli123, gt_seo_h2-deli124,
                  gt_seo_h2-deli125, gt_seo_h2-deli126, gt_seo_h2-deli127,
                  gt_seo_h2-deli128, gt_seo_h2-deli129, gt_seo_h2-deli130,
                  gt_seo_h2-deli131, gt_seo_h2-deli132, gt_seo_h2-deli133,
                  gt_seo_h2-deli134, gt_seo_h2-deli135, gt_seo_h2-deli136,
                  gt_seo_h2-deli137, gt_seo_h2-deli138, gt_seo_h2-deli139,
                  gt_seo_h2-deli140, gt_seo_h2-deli141, gt_seo_h2-deli142,
                  gt_seo_h2-deli143, gt_seo_h2-deli144, gt_seo_h2-deli145,
                  gt_seo_h2-deli146, gt_seo_h2-deli147, gt_seo_h2-deli148,
                  gt_seo_h2-deli149, gt_seo_h2-deli150, gt_seo_h2-deli151,
                  gt_seo_h2-deli152, gt_seo_h2-deli153, gt_seo_h2-deli154,
                  gt_seo_h2-deli155,gt_seo_h2-deli156, gt_seo_h2-deli157,
                  gt_seo_h2-deli158, gt_seo_h2-deli159, gt_seo_h2-deli160,
                  gt_seo_h2-deli161, gt_seo_h2-deli162, gt_seo_h2-deli163,
                  gt_seo_h2-deli164, gt_seo_h2-deli165, gt_seo_h2-deli166,
                  gt_seo_h2-deli167, gt_seo_h2-deli168, gt_seo_h2-deli169,  "MOD-001+
                  gt_seo_h2-deli170, gt_seo_h2-deli171, gt_seo_h2-deli172,  "MOD-001+
                  gt_seo_h2-deli173,                                        "MOD-001+
                  gt_seo_h2-deli174,                                        "MOD-002+
                  gt_seo_h2-deli175,                                        "MOD-002+
                  gt_seo_h2-deli176,                                        "MOD-002+
                  gt_seo_h2-deli177.                                        "MOD-002+



    MOVE-CORRESPONDING gt_seo_h2 TO gt_seo_h.

      CALL FUNCTION 'CONVERSION_EXIT_ALPHA_INPUT'
    EXPORTING
      input  = gt_seo_h2-sermat
    IMPORTING
      output = gt_seo_h2-sermat.

    SELECT SINGLE bismt FROM mara INTO gt_seo_h-bismt
      WHERE matnr = gt_seo_h2-sermat.

    gt_seo_h-bstkd = ls_pmsdo-bstkd.
    gt_seo_h-bstdk = ls_pmsdo-bstdk.
    gt_seo_h-objnr_p = ls_pmsdo-objnr.
    gt_seo_h-vkorg = ls_pmsdo-vkorg.
    gt_seo_h-vtweg = ls_pmsdo-vtweg.
    gt_seo_h-spart = ls_pmsdo-spart.
    gt_seo_h-vkgrp = ls_pmsdo-vkgrp.
    gt_seo_h-vkbur = ls_pmsdo-vkbur.
    gt_seo_h-cuobj = ls_pmsdo-cuobj.
    gt_seo_h-matnr_p = ls_pmsdo-matnr.
    gt_seo_h-menge_p = ls_pmsdo-menge.
    gt_seo_h-meins_p = ls_pmsdo-meins.
    gt_seo_h-faktf_p = ls_pmsdo-faktf.

    gt_seo_h-stort_il = ls_iloan-stort.
    gt_seo_h-gsber_il = ls_iloan-gsber.
    gt_seo_h-kokrs_il = ls_iloan-kokrs.
    gt_seo_h-bukrs_il = ls_iloan-bukrs.
    gt_seo_h-aufnr_il = ls_iloan-aufnr.
    gt_seo_h-vkorg_il = ls_iloan-vkorg.
    gt_seo_h-vtweg_il = ls_iloan-vtweg.
    gt_seo_h-spart_il = ls_iloan-spart.
    gt_seo_h-vkbur_il = ls_iloan-vkbur.
    gt_seo_h-vkgrp_il = ls_iloan-vkgrp.

    gt_seo_h-plsvb = gt_seo_h2-plsvb.
    gt_seo_h-plnme = gt_seo_h2-plnme.
    gt_seo_h-plsvn = gt_seo_h2-plsvn.
    gt_seo_h-lodiv = gt_seo_h2-lodiv.
    gt_seo_h-sbmng = gt_seo_h2-sbmng.
    gt_seo_h-sbmeh = gt_seo_h2-sbmeh.
    gt_seo_h-slsvn = gt_seo_h2-slsvn.
    gt_seo_h-slsbs = gt_seo_h2-slsbs.
    gt_seo_h-abnum = gt_seo_h2-abnum.

*    IF lv_no_contract IS NOT INITIAL.
*      CLEAR: gt_seo_h-kdauf, gt_seo_h-kdpos.
*    ENDIF.
    APPEND gt_seo_h.

* Retrieve partners

* Take partners from SEO.

    MOVE '|' TO: gt_seo_p-deli1, gt_seo_p-deli2, gt_seo_p-deli3,
                     gt_seo_p-deli4, gt_seo_p-deli5, gt_seo_p-deli6,
                     gt_seo_p-deli7, gt_seo_p-deli8.

    CONCATENATE 'OR' gt_seo_h2-aufnr INTO lv_objk.

    gt_seo_p-aufnr = gt_seo_h2-aufnr.

    CLEAR lv_parnr.
    SELECT SINGLE parnr FROM ihpa INTO lv_parnr
     WHERE objnr    EQ lv_objk
       AND parvw    EQ 'WE'
       AND kzloesch NE 'X'.
    gt_seo_p-parnr_h = lv_parnr.

    CLEAR lv_name.
    SELECT SINGLE name1 INTO lv_name
        FROM kna1 WHERE kunnr = lv_parnr.
    gt_seo_p-name_h = lv_name.

    CLEAR lv_parnr.
    SELECT SINGLE parnr FROM ihpa INTO lv_parnr
     WHERE objnr    EQ lv_objk
       AND parvw    EQ 'AG'
       AND kzloesch NE 'X'.
    gt_seo_p-parnr_s = lv_parnr.


    CLEAR lv_name.
    SELECT SINGLE name1 INTO lv_name
        FROM kna1 WHERE kunnr = lv_parnr.
    gt_seo_p-name_s = lv_name.

    CLEAR lv_parnr.
    SELECT SINGLE parnr FROM ihpa INTO lv_parnr
     WHERE objnr    EQ lv_objk
       AND parvw    EQ 'RG'
       AND kzloesch NE 'X'.
    gt_seo_p-parnr_p = lv_parnr.

    CLEAR lv_name.
    SELECT SINGLE name1 INTO lv_name
        FROM kna1 WHERE kunnr = lv_parnr.
    gt_seo_p-name_p = lv_name.

    CLEAR lv_parnr.
    SELECT SINGLE parnr FROM ihpa INTO lv_parnr
     WHERE objnr    EQ lv_objk
       AND parvw    EQ 'RE'
       AND kzloesch NE 'X'.
    gt_seo_p-parnr_b = lv_parnr.
    APPEND gt_seo_p.


    CLEAR lv_name.
    SELECT SINGLE name1 INTO lv_name
        FROM kna1 WHERE kunnr = lv_parnr.
    gt_seo_p-name_b = lv_name.

  ENDLOOP.

ENDFORM.                    "get_data

*&---------------------------------------------------------------------*
*&      Form  download_files
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
FORM download_files.

  DATA: file TYPE string.
  DATA: lv_selections TYPE string.

  lv_selections = p_bukrs.
  IF p_werks IS NOT INITIAL.
    CONCATENATE lv_selections p_werks INTO lv_selections SEPARATED BY '_'.
  ENDIF.
  IF p_vkorg IS NOT INITIAL.
    CONCATENATE lv_selections p_vkorg INTO lv_selections SEPARATED BY '_'.
  ENDIF.


  PERFORM header_fill.
  PERFORM header_fill2.

  IF sy-batch = 'X'.
    REPLACE 'xxx' IN g_directory WITH p_logsys(3).

*   Header
*    CONCATENATE g_directory c_rec_h '_' p_werks '_' syst-datlo syst-timlo INTO g_ofile.
    CONCATENATE g_directory c_rec_h '_' lv_selections '_' syst-datlo syst-timlo INTO g_ofile.

    OPEN DATASET g_ofile FOR OUTPUT IN TEXT MODE ENCODING DEFAULT.
    IF sy-subrc <> 0.
      WRITE: / text-e04, g_ofile.
      EXIT.
    ENDIF.

*   Header
    LOOP AT gt_seo_h_c.
      TRANSFER gt_seo_h_c TO g_ofile.
    ENDLOOP.

*   Data
    LOOP AT gt_seo_h.
      TRANSFER gt_seo_h TO g_ofile.
    ENDLOOP.

    CLOSE DATASET g_ofile.
    IF sy-subrc <> 0.
      WRITE: / text-e05, g_ofile.
      EXIT.
    ENDIF.
***
    REPLACE 'xxx' IN g_directory WITH p_logsys(3).

*   Header
*    CONCATENATE g_directory c_rec_p '_' p_werks '_' syst-datlo syst-timlo INTO g_ofile.
    CONCATENATE g_directory c_rec_p '_' lv_selections '_' syst-datlo syst-timlo INTO g_ofile.

    OPEN DATASET g_ofile FOR OUTPUT IN TEXT MODE ENCODING DEFAULT.
    IF sy-subrc <> 0.
      WRITE: / text-e04, g_ofile.
      EXIT.
    ENDIF.

*   Header
    LOOP AT gt_seo_p_c.
      TRANSFER gt_seo_p_c TO g_ofile.
    ENDLOOP.

*   Data
    LOOP AT gt_seo_p.
      TRANSFER gt_seo_p TO g_ofile.
    ENDLOOP.

    CLOSE DATASET g_ofile.
    IF sy-subrc <> 0.
      WRITE: / text-e05, g_ofile.
      EXIT.
    ENDIF.
  ELSE.
    file = h_filet.
*    CONCATENATE file '_' p_werks '_' syst-datlo syst-timlo '.txt' INTO file.
    CONCATENATE file '_' lv_selections '_' syst-datlo syst-timlo '.txt' INTO file.

    CALL FUNCTION 'GUI_DOWNLOAD'
      EXPORTING
        filename                = file
        append                  = ' '
        filetype                = 'DAT'
        write_field_separator   = 'X'
      TABLES
        data_tab                = gt_seo_h_c
      EXCEPTIONS
        file_write_error        = 1
        no_batch                = 2
        gui_refuse_filetransfer = 3
        invalid_type            = 4
        no_authority            = 5
        unknown_error           = 6
        header_not_allowed      = 7
        separator_not_allowed   = 8
        filesize_not_allowed    = 9
        header_too_long         = 10
        dp_error_create         = 11
        dp_error_send           = 12
        dp_error_write          = 13
        unknown_dp_error        = 14
        access_denied           = 15
        dp_out_of_memory        = 16
        disk_full               = 17
        dp_timeout              = 18
        file_not_found          = 19
        dataprovider_exception  = 20
        control_flush_error     = 21
        OTHERS                  = 22.

    CALL FUNCTION 'GUI_DOWNLOAD'
      EXPORTING
        filename                = file
        append                  = 'X'
        filetype                = 'DAT'
        write_field_separator   = 'X'
      TABLES
        data_tab                = gt_seo_h
      EXCEPTIONS
        file_write_error        = 1
        no_batch                = 2
        gui_refuse_filetransfer = 3
        invalid_type            = 4
        no_authority            = 5
        unknown_error           = 6
        header_not_allowed      = 7
        separator_not_allowed   = 8
        filesize_not_allowed    = 9
        header_too_long         = 10
        dp_error_create         = 11
        dp_error_send           = 12
        dp_error_write          = 13
        unknown_dp_error        = 14
        access_denied           = 15
        dp_out_of_memory        = 16
        disk_full               = 17
        dp_timeout              = 18
        file_not_found          = 19
        dataprovider_exception  = 20
        control_flush_error     = 21
        OTHERS                  = 22.

    file = p_filet.
*    CONCATENATE file '_' p_werks '_' syst-datlo syst-timlo '.txt' INTO file.
    CONCATENATE file '_' lv_selections '_' syst-datlo syst-timlo '.txt' INTO file.

    CALL FUNCTION 'GUI_DOWNLOAD'
      EXPORTING
        filename                = file
        append                  = ' '
        filetype                = 'DAT'
        write_field_separator   = 'X'
      TABLES
        data_tab                = gt_seo_p_c
      EXCEPTIONS
        file_write_error        = 1
        no_batch                = 2
        gui_refuse_filetransfer = 3
        invalid_type            = 4
        no_authority            = 5
        unknown_error           = 6
        header_not_allowed      = 7
        separator_not_allowed   = 8
        filesize_not_allowed    = 9
        header_too_long         = 10
        dp_error_create         = 11
        dp_error_send           = 12
        dp_error_write          = 13
        unknown_dp_error        = 14
        access_denied           = 15
        dp_out_of_memory        = 16
        disk_full               = 17
        dp_timeout              = 18
        file_not_found          = 19
        dataprovider_exception  = 20
        control_flush_error     = 21
        OTHERS                  = 22.

    CALL FUNCTION 'GUI_DOWNLOAD'
      EXPORTING
        filename                = file
        append                  = 'X'
        filetype                = 'DAT'
        write_field_separator   = 'X'
      TABLES
        data_tab                = gt_seo_p
      EXCEPTIONS
        file_write_error        = 1
        no_batch                = 2
        gui_refuse_filetransfer = 3
        invalid_type            = 4
        no_authority            = 5
        unknown_error           = 6
        header_not_allowed      = 7
        separator_not_allowed   = 8
        filesize_not_allowed    = 9
        header_too_long         = 10
        dp_error_create         = 11
        dp_error_send           = 12
        dp_error_write          = 13
        unknown_dp_error        = 14
        access_denied           = 15
        dp_out_of_memory        = 16
        disk_full               = 17
        dp_timeout              = 18
        file_not_found          = 19
        dataprovider_exception  = 20
        control_flush_error     = 21
        OTHERS                  = 22.
  ENDIF.

ENDFORM.                    "download_file

*&---------------------------------------------------------------------*
*&      Form  header_fill
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
FORM header_fill.

  MOVE '|' TO: gt_seo_h_c-deli1, gt_seo_h_c-deli2, gt_seo_h_c-deli3,
               gt_seo_h_c-deli4, gt_seo_h_c-deli5, gt_seo_h_c-deli6,
               gt_seo_h_c-deli7, gt_seo_h_c-deli8, gt_seo_h_c-deli9,
               gt_seo_h_c-deli10, gt_seo_h_c-deli11, gt_seo_h_c-deli12,
               gt_seo_h_c-deli13, gt_seo_h_c-deli14, gt_seo_h_c-deli15,
               gt_seo_h_c-deli16, gt_seo_h_c-deli17, gt_seo_h_c-deli18,
               gt_seo_h_c-deli19, gt_seo_h_c-deli20, gt_seo_h_c-deli21,
               gt_seo_h_c-deli22, gt_seo_h_c-deli23, gt_seo_h_c-deli24,
               gt_seo_h_c-deli23, gt_seo_h_c-deli24, gt_seo_h_c-deli25,
               gt_seo_h_c-deli26, gt_seo_h_c-deli27, gt_seo_h_c-deli28,
               gt_seo_h_c-deli29, gt_seo_h_c-deli30, gt_seo_h_c-deli31,
               gt_seo_h_c-deli32, gt_seo_h_c-deli33, gt_seo_h_c-deli34,
               gt_seo_h_c-deli35, gt_seo_h_c-deli36, gt_seo_h_c-deli37,
               gt_seo_h_c-deli38, gt_seo_h_c-deli39, gt_seo_h_c-deli40,
               gt_seo_h_c-deli41, gt_seo_h_c-deli42, gt_seo_h_c-deli43,
               gt_seo_h_c-deli44, gt_seo_h_c-deli45, gt_seo_h_c-deli46,
               gt_seo_h_c-deli47, gt_seo_h_c-deli48, gt_seo_h_c-deli49,
               gt_seo_h_c-deli50, gt_seo_h_c-deli51, gt_seo_h_c-deli52,
               gt_seo_h_c-deli53, gt_seo_h_c-deli54, gt_seo_h_c-deli55,
               gt_seo_h_c-deli56, gt_seo_h_c-deli57, gt_seo_h_c-deli58,
               gt_seo_h_c-deli59, gt_seo_h_c-deli60, gt_seo_h_c-deli61,
               gt_seo_h_c-deli62, gt_seo_h_c-deli63, gt_seo_h_c-deli64,
               gt_seo_h_c-deli65, gt_seo_h_c-deli66, gt_seo_h_c-deli67,
               gt_seo_h_c-deli68, gt_seo_h_c-deli69, gt_seo_h_c-deli70,
               gt_seo_h_c-deli71, gt_seo_h_c-deli72, gt_seo_h_c-deli73,
               gt_seo_h_c-deli74, gt_seo_h_c-deli75, gt_seo_h_c-deli76,
               gt_seo_h_c-deli77, gt_seo_h_c-deli78, gt_seo_h_c-deli79,
               gt_seo_h_c-deli80, gt_seo_h_c-deli81, gt_seo_h_c-deli82,
               gt_seo_h_c-deli83, gt_seo_h_c-deli84, gt_seo_h_c-deli85,
               gt_seo_h_c-deli86, gt_seo_h_c-deli87, gt_seo_h_c-deli88,
               gt_seo_h_c-deli89, gt_seo_h_c-deli90, gt_seo_h_c-deli91,
               gt_seo_h_c-deli92, gt_seo_h_c-deli93, gt_seo_h_c-deli94,
               gt_seo_h_c-deli95, gt_seo_h_c-deli96, gt_seo_h_c-deli97,
               gt_seo_h_c-deli98, gt_seo_h_c-deli99, gt_seo_h_c-deli100,
               gt_seo_h_c-deli101, gt_seo_h_c-deli102, gt_seo_h_c-deli103,
               gt_seo_h_c-deli104, gt_seo_h_c-deli105, gt_seo_h_c-deli106,
               gt_seo_h_c-deli107, gt_seo_h_c-deli108, gt_seo_h_c-deli109,
               gt_seo_h_c-deli110, gt_seo_h_c-deli111, gt_seo_h_c-deli112,
               gt_seo_h_c-deli113, gt_seo_h_c-deli114, gt_seo_h_c-deli115,
               gt_seo_h_c-deli116, gt_seo_h_c-deli117, gt_seo_h_c-deli118,
               gt_seo_h_c-deli119, gt_seo_h_c-deli120, gt_seo_h_c-deli121,
               gt_seo_h_c-deli122, gt_seo_h_c-deli123, gt_seo_h_c-deli124,
               gt_seo_h_c-deli125, gt_seo_h_c-deli126, gt_seo_h_c-deli127,
               gt_seo_h_c-deli128, gt_seo_h_c-deli129, gt_seo_h_c-deli130,
               gt_seo_h_c-deli131, gt_seo_h_c-deli132, gt_seo_h_c-deli133,
               gt_seo_h_c-deli134, gt_seo_h_c-deli135, gt_seo_h_c-deli136,
               gt_seo_h_c-deli137, gt_seo_h_c-deli138, gt_seo_h_c-deli139,
               gt_seo_h_c-deli140, gt_seo_h_c-deli141, gt_seo_h_c-deli142,
               gt_seo_h_c-deli143, gt_seo_h_c-deli144, gt_seo_h_c-deli145,
               gt_seo_h_c-deli146, gt_seo_h_c-deli147, gt_seo_h_c-deli148,
               gt_seo_h_c-deli149, gt_seo_h_c-deli150, gt_seo_h_c-deli151,
               gt_seo_h_c-deli152, gt_seo_h_c-deli153, gt_seo_h_c-deli154,
               gt_seo_h_c-deli155, gt_seo_h_c-deli156, gt_seo_h_c-deli157,
               gt_seo_h_c-deli158, gt_seo_h_c-deli159, gt_seo_h_c-deli160,
               gt_seo_h_c-deli161, gt_seo_h_c-deli162, gt_seo_h_c-deli163,
               gt_seo_h_c-deli164, gt_seo_h_c-deli165, gt_seo_h_c-deli166,
               gt_seo_h_c-deli167, gt_seo_h_c-deli168, gt_seo_h_c-deli169,  "MOD-001+
               gt_seo_h_c-deli170, gt_seo_h_c-deli171, gt_seo_h_c-deli172,  "MOD-001+
               gt_seo_h_c-deli173,                                          "MOD-001+
               gt_seo_h_c-deli174,                                          "MOD-001+
               gt_seo_h_c-deli175,                                          "MOD-002+
               gt_seo_h_c-deli176,                                          "MOD-002+
               gt_seo_h_c-deli177.                                          "MOD-002+


  gt_seo_h_c-qmnum = 'QMNUM'.
  gt_seo_h_c-aufnr = 'AUFNR'.
  gt_seo_h_c-auart = 'AUART'.
  gt_seo_h_c-autyp = 'AUTYP'.
  gt_seo_h_c-refnr = 'REFNR'.
  gt_seo_h_c-ernam = 'ERNAM'.
  gt_seo_h_c-erdat = 'ERDAT'.
  gt_seo_h_c-aenam = 'AENAM'.
  gt_seo_h_c-aedat = 'AEDAT'.
  gt_seo_h_c-ktext = 'KTEXT'.
  gt_seo_h_c-ltext = 'LTEXT'.
  gt_seo_h_c-bstkd = 'BSTKD'.
  gt_seo_h_c-bstdk = 'BSTDK'.
  gt_seo_h_c-bukrs = 'BUKRS'.
  gt_seo_h_c-werks = 'WERKS'.
  gt_seo_h_c-gsber = 'GSBER'.
  gt_seo_h_c-kokrs = 'KOKRS'.
  gt_seo_h_c-kostv = 'KOSTV'.
  gt_seo_h_c-loekz = 'LOEKZ'.
  gt_seo_h_c-prctr = 'PRCTR'.
  gt_seo_h_c-pspel = 'PSPEL'.
  gt_seo_h_c-kalsm  = 'KALSM'.
  gt_seo_h_c-zschl = 'ZSCHL'.
  gt_seo_h_c-awsls  = 'AWSLS'.
  gt_seo_h_c-abgsl  = 'ABGSL'.
  gt_seo_h_c-txjcd  = 'TXJCD'.
  gt_seo_h_c-sdate  = 'SDATE'.
  gt_seo_h_c-user2  = 'USER2'.
  gt_seo_h_c-user7 = 'USER7'.
  gt_seo_h_c-user8 = 'USER8'.
  gt_seo_h_c-objnr = 'OBJNR'.
  gt_seo_h_c-kdauf = 'KDAUF'.
  gt_seo_h_c-kdpos = 'KDPOS'.
  gt_seo_h_c-akstl = 'AKSTL'.
  gt_seo_h_c-adrnra  = 'ADRNRA'.
  gt_seo_h_c-cstg_vrnt = 'CSTG_VRNT'.
  gt_seo_h_c-zzsdc  = 'ZZSDC'.
  gt_seo_h_c-zzapc  = 'ZZAPC'.
  gt_seo_h_c-zzcon = 'ZZCON'.
  gt_seo_h_c-zzpsf = 'ZZPSF'.
  gt_seo_h_c-zzcom = 'ZZCOM'.
  gt_seo_h_c-zzrem = 'ZZREM'.
  gt_seo_h_c-zztrc = 'ZZTRC'.
  gt_seo_h_c-gltrp  = 'GLTRP'.
  gt_seo_h_c-gstrp = 'GSTRP'.
  gt_seo_h_c-ftrms  = 'FTRMS'.
  gt_seo_h_c-gltrs  = 'GLTRS'.
  gt_seo_h_c-gstrs  = 'GSTRS'.
  gt_seo_h_c-gstri  = 'GSTRI'.
  gt_seo_h_c-getri  = 'GETRI'.
  gt_seo_h_c-gltri  = 'GLTRI'.
  gt_seo_h_c-ftrmi  = 'FTRMI'.
  gt_seo_h_c-ftrmp  = 'FTRMP'.
  gt_seo_h_c-plnty  = 'PLNTY'.
  gt_seo_h_c-plnnr  = 'PLNNR'.
  gt_seo_h_c-plnaw  = 'PLNAW'.
  gt_seo_h_c-plnal  = 'PLNAL'.
  gt_seo_h_c-pverw  = 'PVERW'.
  gt_seo_h_c-plsvb  = 'PLSVB'.
  gt_seo_h_c-plnme  = 'PLNME'.
  gt_seo_h_c-plsvn  = 'PLSVN'.
  gt_seo_h_c-pdatv  = 'PDATV'.
  gt_seo_h_c-plgrp  = 'PLGRP'.
  gt_seo_h_c-lodiv  = 'LODIV'.
  gt_seo_h_c-stlty  = 'STLTY'.
  gt_seo_h_c-stlbez  = 'STLBEZ'.
  gt_seo_h_c-stlst  = 'STLST'.
  gt_seo_h_c-stlnr  = 'STLNR'.
  gt_seo_h_c-sdatv  = 'SDATV'.
  gt_seo_h_c-sbmng  = 'SBMNG'.
  gt_seo_h_c-sbmeh  = 'SBMEH'.
  gt_seo_h_c-saenr  = 'SAENR'.
  gt_seo_h_c-stlal  = 'STLAL'.
  gt_seo_h_c-stlan  = 'STLAN'.
  gt_seo_h_c-slsvn  = 'SLSVN'.
  gt_seo_h_c-slsbs  = 'SLSBS'.
  gt_seo_h_c-artpr  = 'ARTPR'.
  gt_seo_h_c-priok  = 'PRIOK'.
  gt_seo_h_c-equnr  = 'EQUNR'.
  gt_seo_h_c-bautl  = 'BAUTL'.
  gt_seo_h_c-anlzu  = 'ANLZU'.
  gt_seo_h_c-iwerk  = 'IWERK'.
  gt_seo_h_c-ingpr  = 'INGPR'.
  gt_seo_h_c-apgrp  = 'APGRP'.
  gt_seo_h_c-gewrk  = 'GEWRK'.
  gt_seo_h_c-kunum  = 'KUNUM'.
  gt_seo_h_c-aning  = 'ANING'.
  gt_seo_h_c-warpl  = 'WARPL'.
  gt_seo_h_c-abnum  = 'ABNUM'.
  gt_seo_h_c-wapos  = 'WAPOS'.
  gt_seo_h_c-aduhr  = 'ADUHR'.
  gt_seo_h_c-iphas  = 'IPHAS'.
  gt_seo_h_c-ilart  = 'ILART'.
  gt_seo_h_c-plknz  = 'PLKNZ'.
  gt_seo_h_c-serialnr  = 'SERIALNR'.
  gt_seo_h_c-sermat  = 'SERMAT'.
  gt_seo_h_c-objnr_p  = 'OBJNR_PMSDO'.
  gt_seo_h_c-vkorg   = 'VKORG_PMSDO'.
  gt_seo_h_c-vaplz  = 'VAPLZ'.
  gt_seo_h_c-wawrk  = 'WAWRK'.
  gt_seo_h_c-kostl  = 'KOSTL'.
  gt_seo_h_c-proid  = 'PROID'.
  gt_seo_h_c-stort  = 'STORT'.
  gt_seo_h_c-sowrk  = 'SOWRK'.
  gt_seo_h_c-vtweg  = 'VTWEG'.
  gt_seo_h_c-spart  = 'SPART'.
  gt_seo_h_c-vkgrp  = 'VKGRP'.
  gt_seo_h_c-vkbur  = 'VKBUR'.
  gt_seo_h_c-cuobj  = 'CUOBJ'.
  gt_seo_h_c-iloan  = 'ILOAN'.
  gt_seo_h_c-tplnr  = 'TPLNR'.
  gt_seo_h_c-abckz  = 'ABCKZ'.
  gt_seo_h_c-abckzi  = 'ABCKZI'.
  gt_seo_h_c-eqfnr  = 'EQFNR'.
  gt_seo_h_c-eqfnri  = 'EQFNRI'.
  gt_seo_h_c-swerk  = 'SWERK'.
  gt_seo_h_c-swerki  = 'SWERKI'.
  gt_seo_h_c-stort_il  = 'STORT_ILOA'.
  gt_seo_h_c-storti  = 'STORTI'.
  gt_seo_h_c-msgrp  = 'MSGRP'.
  gt_seo_h_c-msgrpi  = 'MSGRPI'.
  gt_seo_h_c-beber  = 'BEBER'.
  gt_seo_h_c-beberi  = 'BEBERI'.
  gt_seo_h_c-cr_objty  = 'CR_OBJTY'.
  gt_seo_h_c-ppsid  = 'PPSID'.
  gt_seo_h_c-ppsidi  = 'PPSIDI'.
  gt_seo_h_c-gsber_il  = 'GSBER_ILOA'.
  gt_seo_h_c-gsberi  = 'GSBERI'.
  gt_seo_h_c-kokrs_il  = 'KOKRS_ILOA'.
  gt_seo_h_c-proidi  = 'PROIDI'.
  gt_seo_h_c-bukrs_il  = 'BUKRS_ILOA'.
  gt_seo_h_c-bukrsi  = 'BUKRSI'.
  gt_seo_h_c-anlnr  = 'ANLNR'.
  gt_seo_h_c-anlnri  = 'ANLNRI'.
  gt_seo_h_c-anlun  = 'ANLUN'.
  gt_seo_h_c-anluni  = 'ANLUNI'.
  gt_seo_h_c-daufn = 'DAUFN'.
  gt_seo_h_c-daufni  = 'DAUFNI'.
  gt_seo_h_c-aufnr_il  = 'AUFNR_ILOA'.
  gt_seo_h_c-aufnri  = 'AUFNRI'.
  gt_seo_h_c-tplnri  = 'TPLNRI'.
  gt_seo_h_c-vkorg_il  = 'VKORG_IlOA'.
  gt_seo_h_c-vkorgi  = 'VKORGI'.
  gt_seo_h_c-vtweg_il  = 'VTWEG_ILOA'.
  gt_seo_h_c-vtwegi  = 'VTWEGI'.
  gt_seo_h_c-spart_il  = 'SPART_ILOA'.
  gt_seo_h_c-sparti  = 'SPARTI'.
  gt_seo_h_c-adrnr  = 'ADRNR'.
  gt_seo_h_c-adrnri  = 'ADRNRI'.
  gt_seo_h_c-owner  = 'OWNER'.
  gt_seo_h_c-vkbur_il  = 'VKBUR_ILOA'.
  gt_seo_h_c-vkgrp_il  = 'VKGRP_ILOA'.
  gt_seo_h_c-sstatus  = 'SYSTEM_STATUS'.
  gt_seo_h_c-sstatus2 = 'SYSTEM_STATUS_TEXT'.
  gt_seo_h_c-ustatus  = 'USER_STATUS'.
  gt_seo_h_c-ustatus2 = 'USER_STATUS_TEXT'.
  gt_seo_h_c-vbeln = 'VBELN_QUOTATION'.
  gt_seo_h_c-netwr = 'NETWR_QUOTATION'.
  gt_seo_h_c-waerk = 'UOM_QUOTATION'.
  gt_seo_h_c-vbeln_d = 'VBELN_DMR'.
  gt_seo_h_c-netwr_d = 'NETWR_DMR'.
  gt_seo_h_c-waerk_d = 'UOM_DMR'.
  gt_seo_h_c-bemot = 'BEMOT'.
  gt_seo_h_c-matnr_p = 'MATNR_PMSDO'.
  gt_seo_h_c-menge_p = 'MENGE_PMSDO'.
  gt_seo_h_c-meins_p = 'MEINS_PMSDO'.
  gt_seo_h_c-faktf_p = 'FAKTF_PMSDO'.
  gt_seo_h_c-waers = 'WAERS'.       "MOD-001+
  gt_seo_h_c-netwr_sd = 'NETWR_SD'. "MOD-001+
  gt_seo_h_c-waerk_f = 'WAERK'.     "MOD-001+
  gt_seo_h_c-stceg_l = 'STCEG_L'.   "MOD-001+
  gt_seo_h_c-inco1 = 'INCO1'.       "MOD-001+
  gt_seo_h_c-inco2 = 'INCO2'.       "MOD-001+
  gt_seo_h_c-zterm = 'ZTERM'.       "MOD-001+
  gt_seo_h_c-bismt = 'BISMT'.       "MOD-002+
  gt_seo_h_c-zzvisam1 = 'ZZVISA1'.  "MOD-002+
  gt_seo_h_c-zzvisam2 = 'ZZVISA2'.  "MOD-002+
  gt_seo_h_c-maufnr = 'MAUFNR'.  "MOD-002+
  APPEND gt_seo_h_c.

  gt_seo_h_c-qmnum = 'Notification'.
  gt_seo_h_c-aufnr = 'SEO No.'.
  gt_seo_h_c-auart = 'Type'.
  gt_seo_h_c-autyp = 'Cat.'.
  gt_seo_h_c-refnr = 'Reference'.
  gt_seo_h_c-ernam = 'Created By'.
  gt_seo_h_c-erdat = 'Created On'.
  gt_seo_h_c-aenam = 'Changed By'.
  gt_seo_h_c-aedat = 'Changed On'.
  gt_seo_h_c-ktext = 'Description'.
  gt_seo_h_c-ltext = 'Long Txt'.
  gt_seo_h_c-bstkd = 'PO no.'.
  gt_seo_h_c-bstdk = 'PO date'.
  gt_seo_h_c-bukrs = 'Company'.
  gt_seo_h_c-werks = 'Plant'.
  gt_seo_h_c-gsber = 'Bus. Area'.
  gt_seo_h_c-kokrs = 'Contr. Ar.'.
  gt_seo_h_c-kostv = 'Responsible CC'.
  gt_seo_h_c-loekz = 'Del.'.
  gt_seo_h_c-prctr = 'Profit Ctr'.
  gt_seo_h_c-pspel = 'WBS element'.
  gt_seo_h_c-kalsm = 'Cost. Sheet'.
  gt_seo_h_c-zschl = 'Overh. Key'.
  gt_seo_h_c-awsls = 'Var. Key'.
  gt_seo_h_c-abgsl = 'RA Key'.
  gt_seo_h_c-txjcd = 'Tax Jurisdict.'.
  gt_seo_h_c-sdate = 'Start Date'.
  gt_seo_h_c-user2 = 'Person Responsible'.
  gt_seo_h_c-user7 = 'Work Start'.
  gt_seo_h_c-user8 = 'Work End'.
  gt_seo_h_c-objnr = 'Object No.'.
  gt_seo_h_c-kdauf = 'Sales Order'.
  gt_seo_h_c-kdpos = 'SO Item'.
  gt_seo_h_c-akstl = 'Request. CC'.
  gt_seo_h_c-adrnra = 'Address No.'.
  gt_seo_h_c-cstg_vrnt = 'Cost. Var.'.
  gt_seo_h_c-zzsdc = 'Speed Deliv.'.
  gt_seo_h_c-zzapc = 'Airpower Prior.'.
  gt_seo_h_c-zzcon = 'Consignee'.
  gt_seo_h_c-zzpsf = 'Part. Shipm.'.
  gt_seo_h_c-zzcom = 'Internal Comment'.
  gt_seo_h_c-zzrem = 'Add. SEO Remark'.
  gt_seo_h_c-zztrc = 'Transp.'.
  gt_seo_h_c-gltrp = 'Basic Finish'.
  gt_seo_h_c-gstrp = 'Basic Start'.
  gt_seo_h_c-ftrms = 'Sched. Rel.'.
  gt_seo_h_c-gltrs = 'Sched. Finish'.
  gt_seo_h_c-gstrs = 'Sched. Start'.
  gt_seo_h_c-gstri = 'Act. Start'.
  gt_seo_h_c-getri = 'Conf. Finish'.
  gt_seo_h_c-gltri = 'Act. Finish'.
  gt_seo_h_c-ftrmi = 'Actual Rel.'.
  gt_seo_h_c-ftrmp = 'Planned Rel.'.
  gt_seo_h_c-plnty = 'TL Type'.
  gt_seo_h_c-plnnr = 'Task List'.
  gt_seo_h_c-plnaw = 'Appl.'.
  gt_seo_h_c-plnal = 'Gr.C.'.
  gt_seo_h_c-pverw = 'Usage'.
  gt_seo_h_c-plsvb = 'Lot Size (To)'.
  gt_seo_h_c-plnme = 'UoM'.
  gt_seo_h_c-plsvn = 'Lot Size (Fr.)'.
  gt_seo_h_c-pdatv = 'Valid-From'.
  gt_seo_h_c-plgrp = 'Resp.'.
  gt_seo_h_c-lodiv = 'Lot Size Div.'.
  gt_seo_h_c-stlty = 'BOM Cat.'.
  gt_seo_h_c-stlbez = 'Material'.
  gt_seo_h_c-stlst = 'BOM Stat.'.
  gt_seo_h_c-stlnr = 'Bill Of Mat.'.
  gt_seo_h_c-sdatv = 'Valid-From'.
  gt_seo_h_c-sbmng = 'Base Qty'.
  gt_seo_h_c-sbmeh = 'UoM'.
  gt_seo_h_c-saenr = 'Change No.'.
  gt_seo_h_c-stlal = 'Alt. BOM'.
  gt_seo_h_c-stlan = 'Usage'.
  gt_seo_h_c-slsvn = 'Lot Size (Fr.)'.
  gt_seo_h_c-slsbs = 'Lot Size (To)'.
  gt_seo_h_c-artpr = 'Pr. Type'.
  gt_seo_h_c-priok = 'Priority'.
  gt_seo_h_c-equnr = 'Equipment'.
  gt_seo_h_c-bautl = 'Assembly'.
  gt_seo_h_c-anlzu = 'Syst.Cond.'.
  gt_seo_h_c-iwerk = 'Pl. Plant'.
  gt_seo_h_c-ingpr = 'Planner Gr.'.
  gt_seo_h_c-apgrp = 'Resp.'.
  gt_seo_h_c-gewrk = 'Work Center'.
  gt_seo_h_c-kunum = 'Customer'.
  gt_seo_h_c-aning = 'Person Resp.'.
  gt_seo_h_c-warpl = 'Mainten. Plan'.
  gt_seo_h_c-abnum = 'MP Call No.'.
  gt_seo_h_c-wapos = 'Mainten. Item'.
  gt_seo_h_c-aduhr = 'Ref. Time'.
  gt_seo_h_c-iphas = 'Proc. Stage'.
  gt_seo_h_c-ilart = 'Act.Type'.
  gt_seo_h_c-plknz = 'Planning'.
  gt_seo_h_c-serialnr = 'Serial No.'.
  gt_seo_h_c-sermat = 'Material'.
  gt_seo_h_c-objnr_p = 'Object PM'.
  gt_seo_h_c-vkorg = 'Sales Org.'.
  gt_seo_h_c-vaplz = 'Main Work C.'.
  gt_seo_h_c-wawrk = 'Plant'.
  gt_seo_h_c-kostl = 'Cost Center'.
  gt_seo_h_c-proid = 'WBS Element'.
  gt_seo_h_c-stort = 'Location'.
  gt_seo_h_c-sowrk = 'Plant'.
  gt_seo_h_c-vtweg = 'Distr.Ch.'.
  gt_seo_h_c-spart = 'Div.'.
  gt_seo_h_c-vkgrp = 'Sales Gr.'.
  gt_seo_h_c-vkbur = 'Sales Off.'.
  gt_seo_h_c-cuobj = 'Configuration'.
  gt_seo_h_c-iloan = 'Techn.Object'.
  gt_seo_h_c-tplnr = 'Funct. Loc.'.
  gt_seo_h_c-abckz = 'ABC'.
  gt_seo_h_c-abckzi = 'Orig.'.
  gt_seo_h_c-eqfnr = 'Sort Field'.
  gt_seo_h_c-eqfnri = 'Orig.'.
  gt_seo_h_c-swerk = 'Maint. Plant'.
  gt_seo_h_c-swerki = 'Orig.'.
  gt_seo_h_c-stort_il = 'Location PM'.
  gt_seo_h_c-storti = 'Orig.'.
  gt_seo_h_c-msgrp  = 'Room'.
  gt_seo_h_c-msgrpi = 'Orig.'.
  gt_seo_h_c-beber  = 'Plant Sect.'.
  gt_seo_h_c-beberi = 'Orig.'.
  gt_seo_h_c-cr_objty = 'Obj. type CIM'.
  gt_seo_h_c-ppsid  = 'PP Wrk Ctr'.
  gt_seo_h_c-ppsidi = 'Orig.'.
  gt_seo_h_c-gsber_il = 'Bus. Ar. PM'.
  gt_seo_h_c-gsberi = 'Orig.'.
  gt_seo_h_c-kokrs_il = 'Contr. Ar. PM'.
  gt_seo_h_c-proidi = 'Orig. WBS el.'.
  gt_seo_h_c-bukrs_il = 'Company PM'.
  gt_seo_h_c-bukrsi = 'Orig.'.
  gt_seo_h_c-anlnr  = 'Asset No.'.
  gt_seo_h_c-anlnri = 'Orig.'.
  gt_seo_h_c-anlun  = 'Asset SubNo.'.
  gt_seo_h_c-anluni = 'Orig.'.
  gt_seo_h_c-daufn  = 'Standing Order'.
  gt_seo_h_c-daufni = 'Orig.'.
  gt_seo_h_c-aufnr_il = 'Settlem. Order'.
  gt_seo_h_c-aufnri = 'Orig.'.
  gt_seo_h_c-tplnri = 'Orig. FL'.
  gt_seo_h_c-vkorg_il = 'Sales Org. PM'.
  gt_seo_h_c-vkorgi = 'Orig.'.
  gt_seo_h_c-vtweg_il = 'Distr.Ch. PM'.
  gt_seo_h_c-vtwegi = 'Orig.'.
  gt_seo_h_c-spart_il = 'Div. PM'.
  gt_seo_h_c-sparti = 'Orig.'.
  gt_seo_h_c-adrnr  = 'Address No.'.
  gt_seo_h_c-adrnri = 'Orig.'.
  gt_seo_h_c-owner  = 'Obj.Ref.'.
  gt_seo_h_c-vkbur_il = 'Sales Off. PM'.
  gt_seo_h_c-vkgrp_il = 'Sales Gr. PM'.
  gt_seo_h_c-sstatus  = 'System Status'.
  gt_seo_h_c-sstatus2 = 'System Status Text'.
  gt_seo_h_c-ustatus  = 'User Status'.
  gt_seo_h_c-ustatus2 = 'User Status Text'.
  gt_seo_h_c-vbeln = 'Quotation'.
  gt_seo_h_c-netwr = 'Nett Value Quot.'.
  gt_seo_h_c-waerk = 'Curr. Quot.'.
  gt_seo_h_c-vbeln_d = 'DMR'.
  gt_seo_h_c-netwr_d = 'Nett Value DMR'.
  gt_seo_h_c-waerk_d = 'Curr. DMR'.
  gt_seo_h_c-bemot = 'Acc.Ind.'.
  gt_seo_h_c-matnr_p = 'Material PM'.
  gt_seo_h_c-menge_p = 'Qty PM'.
  gt_seo_h_c-meins_p = 'UoM PM'.
  gt_seo_h_c-faktf_p = 'Bill. Form PM'.
  gt_seo_h_c-waers = 'Curr. SO'.              "MOD-001+
  gt_seo_h_c-netwr_sd = 'Net Value SO'.       "MOD-001+
  gt_seo_h_c-waerk_f = 'Curr. SD'.            "MOD-001+
  gt_seo_h_c-stceg_l = 'Tax dest. country'.   "MOD-001+
  gt_seo_h_c-inco1 = 'Incoterms (Part 1)'.    "MOD-001+
  gt_seo_h_c-inco2 = 'Incoterms (Part 2)'.    "MOD-001+
  gt_seo_h_c-zterm = 'Terms of Payment Key'.  "MOD-001+
  gt_seo_h_c-bismt = 'Old Material Number'.   "MOD-002+
  gt_seo_h_c-zzvisam1 = 'VISA1'.  "MOD-002+
  gt_seo_h_c-zzvisam2 = 'VISA2'.  "MOD-002+
  gt_seo_h_c-maufnr = 'Number of superior order'.  "MOD-002+
  APPEND gt_seo_h_c.

ENDFORM.                    "header_fill

*&---------------------------------------------------------------------*
*&      Form  header_fill
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
FORM header_fill2.

  MOVE '|' TO: gt_seo_p_c-deli1, gt_seo_p_c-deli2, gt_seo_p_c-deli3,
               gt_seo_p_c-deli4, gt_seo_p_c-deli5, gt_seo_p_c-deli6,
               gt_seo_p_c-deli7, gt_seo_p_c-deli8.


  gt_seo_p_c-aufnr = 'AUFNR'.
  gt_seo_p_c-parnr_s = 'PARNR_SOLD'.
  gt_seo_p_c-name_s = 'NAME_SOLD'.
  gt_seo_p_c-parnr_b = 'PARNR_BILL'.
  gt_seo_p_c-name_b = 'NAME_BILL'.
  gt_seo_p_c-parnr_p = 'PARNR_PAY'.
  gt_seo_p_c-name_p = 'NAME_PAY'.
  gt_seo_p_c-parnr_h = 'PARNR_SHIP'.
  gt_seo_p_c-name_h = 'NAME_SHIP'.

  APPEND gt_seo_p_c.

  gt_seo_p_c-aufnr = 'Order Number'.
  gt_seo_p_c-parnr_s = 'Soldto Partner nbr'.
  gt_seo_p_c-name_s = 'Soldto Partner descr'.

  gt_seo_p_c-parnr_b = 'Billto Partner nbr'.
  gt_seo_p_c-name_b = 'Billto Partner descr'.

  gt_seo_p_c-parnr_p = 'Payer Partner nbr'.
  gt_seo_p_c-name_p = 'Payer Partner descr'.

  gt_seo_p_c-parnr_h = 'Shipto Partner nbr'.
  gt_seo_p_c-name_h = 'Shipto Partner descr'.

*  APPEND gt_seo_h_c. "MOD-001-
  APPEND gt_seo_p_c.  "MOD-001+

ENDFORM.                    "header_fill

*Text symbol text
*001:Selection Screen Input
*002:Remarks
*C01:* If started in background, files are stored on the application server
*C02:* /var/load/xxx/UK/read/
*C03:* xxx = logical system
*E02:Planning plant does not exist
*E03:No authorization for plant :
*E04:Open dataset failed for :
*E05:Close dataset failed for :
*I01:No maintenance plans selected !
*I02:No variant table for Central Task Lists found (CU60)

*I03:Could not find caracteristic :
*Selection text
*H_FILET:        Filename seo Header
*P_BUKRS:D       .
*P_FILET:        Filename seo Partners
*P_VKORG:D       .
*P_WERKS:        Plant
*S_AEDAT:        Date of last change
*S_AUART:        Order Type
*S_AUFNR:        Order Number
*S_ERDAT:        Creation Date
*S_VTWEG:D       .
