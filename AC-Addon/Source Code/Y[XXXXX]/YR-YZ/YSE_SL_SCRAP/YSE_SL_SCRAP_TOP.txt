*&---------------------------------------------------------------------*
*&  Include          YSE_ITEMLIST_BE_RETURNED_TOP                      *
*&---------------------------------------------------------------------*

DATA:

* INTERNAL TABLES
* ***************
  BEGIN OF IT_MARD    OCCURS 0,
    MATNR LIKE MARA-MATNR,
    WERKS LIKE MARD-WERKS,
    LGORT LIKE MARD-LGORT,
    DISMM LIKE MARC-DISMM,
    LABST LIKE MARD-LABST,
    EISBE LIKE MARC-EISBE,
    MAXLZ LIKE MARC-MAXLZ,
    MMSTA LIKE MARC-MMSTA,
    MMSTD LIKE MARC-MMSTD,
    PRDHA LIKE MARA-PRDHA,
    MAKTX LIKE MAKT-MAKTX,
    MTPOS LIKE MVKE-MTPOS,
    MVGR4 LIKE MVKE-MVGR4,
    MATKL TYPE MARA-MATKL,
    ERSDA LIKE MARA-ERSDA,
    NFMAT LIKE MARC-NFMAT,
  END OF IT_MARD,
  BEGIN OF IT_MATNR   OCCURS 0,
    MATNR LIKE MARA-MATNR,
  END OF IT_MATNR,
  BEGIN OF IT_KONDD   OCCURS 0,
    KAPPL LIKE KOTD002-KAPPL,
    KSCHL LIKE KOTD002-KSCHL,
    VKORG LIKE KOTD002-VKORG,
    VTWEG LIKE KOTD002-VTWEG,
    MATWA LIKE KOTD002-MATWA,
    DATBI LIKE KOTD002-DATBI,
    KNUMH LIKE KOTD002-KNUMH,
    SMATN LIKE KONDD-SMATN,
    SUGRD LIKE KONDD-SUGRD,
  END OF IT_KONDD,
  BEGIN OF IT_EORD OCCURS 0,
    MATNR LIKE VBAP-MATNR,
    WERKS LIKE EORD-WERKS,
    ZEORD LIKE EORD-ZEORD,
    LIFNR LIKE EORD-LIFNR,
    FLIFN LIKE EORD-FLIFN,
  END OF IT_EORD,
  BEGIN OF IT_EM_SOHIST_AGGR           OCCURS 0,
    MATNR LIKE VBAP-MATNR,
    ZMENG LIKE YSE_EM_SOHIST-ZMENG,
    ZLINE LIKE YSE_EM_SOHIST-ZLINE,
  END OF IT_EM_SOHIST_AGGR,
  IT_ALLOC       TYPE YSE_ALLOCATIONS  OCCURS 0 WITH HEADER LINE,
  IT_EM_PL_CENTR TYPE YSE_EM_PL_CENTR  OCCURS 0 WITH HEADER LINE,
  IT_EM_PL_DISTR TYPE YSE_EM_PL_DISTR  OCCURS 0 WITH HEADER LINE,
  IT_TVKWZ       TYPE TVKWZ            OCCURS 0 WITH HEADER LINE,
  IT_EM_SOHIST   LIKE YSE_EM_SOHIST    OCCURS 0 WITH HEADER LINE,
  IT_EM_MATSO    LIKE YSE_EM_MATSO     OCCURS 0 WITH HEADER LINE,
  IT_OUTPUT      TYPE YSE_SL_SCRAP_OUT OCCURS 0 WITH HEADER LINE,
  BEGIN OF IT_MBEW                     OCCURS 0,
    MATNR          LIKE MBEW-MATNR,
    BWKEY          LIKE MBEW-BWKEY,
    BWTAR          LIKE MBEW-BWTAR,
    STPRS          LIKE MBEW-STPRS,
    WAERS          LIKE T001-WAERS,
  END OF IT_MBEW,
  BEGIN OF IT_MSEG                     OCCURS 0,
    MBLNR TYPE MKPF-MBLNR,
    MJAHR TYPE MKPF-MJAHR,
    ZEILE TYPE MSEG-ZEILE,
    BUDAT TYPE MKPF-BUDAT,
    BWART TYPE MSEG-BWART,
    MATNR TYPE MSEG-MATNR,
    EBELN TYPE MSEG-EBELN,
  END OF IT_MSEG,
  BEGIN OF IT_REC OCCURS 0,
    MATNR TYPE MSEG-MATNR,
    BUDAT TYPE MKPF-BUDAT,
  END OF IT_REC,
  BEGIN OF IT_ISS OCCURS 0,
    MATNR TYPE MSEG-MATNR,
    BUDAT TYPE MKPF-BUDAT,
  END OF IT_ISS,
  IT_SURPLUS TYPE YSE_SURPLUS_HD01     OCCURS 0 WITH HEADER LINE,
  BEGIN OF IT_EKPO                     OCCURS 0,
    EBELN LIKE EKPO-EBELN,
    EBELP LIKE EKPO-EBELP,
    MENGE LIKE EKPO-MENGE,
    MATNR LIKE EKPO-MATNR,
    ELIKZ LIKE EKPO-ELIKZ,
  END OF IT_EKPO,
  BEGIN OF IT_EKBE                     OCCURS 0,
    EBELN LIKE EKBE-EBELN,
    EBELP LIKE EKBE-EBELP,
    ZEKKN LIKE EKBE-ZEKKN,
    VGABE LIKE EKBE-VGABE,
    GJAHR LIKE EKBE-GJAHR,
    BELNR LIKE EKBE-BELNR,
    BUZEI LIKE EKBE-BUZEI,
    MENGE LIKE EKBE-MENGE,
    BPMNG LIKE EKBE-BPMNG,
    SHKZG LIKE EKBE-SHKZG,
  END OF IT_EKBE,

* GLOBAL VARIABLES
* ****************
  GV_WAERS    TYPE WAERS,
  V_DAT LIKE SY-DATUM,
  V_TIM LIKE SY-UZEIT,
  USER_NAME LIKE SY-UNAME,

* WORKING AREAS
* *************
  WA_EM_WHSTYPAR LIKE  YSE_EM_WHSTYPAR.

* RANGES
* ******
RANGES:
  R_BZIRK         FOR YSE_EM_PL_DISTR-BZIRK,
  R_BWART_ALL     FOR MSEG-BWART,
  R_BWART_RECEIPT FOR MSEG-BWART,
  R_BWART_ISSUE   FOR MSEG-BWART.

TABLES:
  yse_em_sohistmig,
  vbap,
  mara,
  CDPOS,                  "CR122 MOD001
  CDHDR.                  "CR122 MOD001

* >> BEGIN OF INSERT MOD001 REF# CR122
DATA :  BEGIN OF IT_CDPOS OCCURS 0,
            MANDANT TYPE MANDT,
            OBJECTCLAS TYPE CDOBJECTCL,
            OBJECTID TYPE CDOBJECTV,
            CHANGENR TYPE CDCHANGENR,
            TABNAME TYPE TABNAME,
            TABKEY TYPE CDTABKEY,
            FNAME TYPE FIELDNAME,
            CHNGIND TYPE CDCHNGIND,
        END OF IT_CDPOS.
DATA :  BEGIN OF IT_CDHDR OCCURS 0,
            MANDANT TYPE MANDANT,
            OBJECTCLAS TYPE CDOBJECTCL,
            OBJECTID TYPE CDOBJECTV,
            CHANGENR TYPE CDCHANGENR,
            UDATE TYPE CDDATUM,
        END OF IT_CDHDR.

DATA : BEGIN OF IT_TEMP OCCURS 0,
          MATNR TYPE MARD-MATNR,
          WERKS LIKE MARD-WERKS,
          LGORT LIKE MARD-LGORT,
          DISMM LIKE MARC-DISMM,
          LABST LIKE MARD-LABST,
          EISBE LIKE MARC-EISBE,
          MAXLZ LIKE MARC-MAXLZ,
          MMSTA LIKE MARC-MMSTA,
          MMSTD LIKE MARC-MMSTD,
          PRDHA LIKE MARA-PRDHA,
          MAKTX LIKE MAKT-MAKTX,
          MTPOS LIKE MVKE-MTPOS,
          MVGR4 LIKE MVKE-MVGR4,
          MATKL TYPE MARA-MATKL,
          ERSDA LIKE MARA-ERSDA,
          NFMAT LIKE MARC-NFMAT,
          OBJECTID TYPE CDOBJECTV,
        END OF IT_TEMP.

DATA : LS_CDPOS LIKE IT_CDPOS,
       LS_CDHDR LIKE IT_CDHDR,
       LS_TEMP  LIKE IT_TEMP.

* >> END  OF INSERT MOD001 REF# CR122

DATA: BEGIN OF it_return_tab OCCURS 0.
        INCLUDE STRUCTURE ddshretval.
DATA: END OF it_return_tab.
DATA: BEGIN OF it_plant OCCURS 0,
    werks LIKE yse_em_plant-werks,
    whtype LIKE yse_em_plant-whtype,
    whstdes LIKE yse_em_plant-whstdes,
    name1        LIKE t001w-name1,
  END OF  it_plant,
  GV_ABPER LIKE yse_em_sohist-period,   " Start of period (12 months)
  GV_ENPER LIKE yse_em_sohist-period,   " End of period   (12 months)
  ok_code LIKE sy-ucomm,
  save_ok_code LIKE sy-ucomm,
  my_container TYPE REF TO cl_gui_docking_container,
  OBJ_EVENT_HANDLER1 TYPE REF TO lcl_event_handler,
  my_alv TYPE REF TO cl_gui_alv_grid.
DATA: wa_variant TYPE disvariant,
      wa_layout TYPE lvc_s_layo,
      it_fieldcat TYPE lvc_t_fcat.
data: begin of it_vkorg occurs 0,
        werks like marc-werks,
        vkorg like mvke-vkorg,
      end of it_vkorg.
data: p_vkorg like mvke-vkorg.
