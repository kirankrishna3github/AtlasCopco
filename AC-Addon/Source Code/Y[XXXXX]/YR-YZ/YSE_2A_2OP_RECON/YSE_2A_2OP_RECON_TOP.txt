*&---------------------------------------------------------------------*
*&  Include           YSE_2A_2OP_RECON_TOP
*&---------------------------------------------------------------------*
REPORT  YSE_2A_2OP_RECON NO STANDARD PAGE HEADING.

TABLES: CE11000,
        GLPCT,
        COSB,
        GLPCA,
        BSIS,
        BSAS.

TYPE-POOLS : FIBS,STREE.
TYPE-POOLS: SLIS.

RANGES: GR_VRGAR    FOR CE11000-VRGAR,
        GR_HIER_2A FOR CE11000-BEMOT,
        GR_HIER_0G FOR CE11000-BEMOT,
        GR_HIER_0W FOR CE11000-BEMOT,
        GR_PRCTR   FOR GLPCT-RPRCTR,
        GR_FAREA_UNCOS FOR GLPCT-RFAREA,
        GR_FAREA_WARCOS FOR GLPCT-RFAREA,
        GR_FAREA_GWCOS FOR GLPCT-RFAREA.

DATA: GT_CE11000 TYPE STANDARD TABLE OF CE11000,
      GT_GLPCT TYPE STANDARD TABLE OF GLPCT.

FIELD-SYMBOLS: <FS_CE11000> TYPE CE11000,
               <FS_GLPCT>   TYPE GLPCT.

TYPES: BEGIN OF GTY_RESULT,
          2A_UNCOGS TYPE RKE2_VV130,  "2A Unadjusted COGS
          2A_WARCOS TYPE RKE2_VV710,  "2A Warranty Cost & Prov
          2A_GOODCOS TYPE RKE2_VV710, "2A Goodwill
          2OP_UNCOGS TYPE HSLXX_PCA,  "2OP Unadjusted COGS
          2OP_WARCOS TYPE HSLXX_PCA,  "2OP Warranty Cost
          2OP_GWCOS TYPE HSLXX_PCA,  "2OP Goodwill Cost
          DIFF_UNCOGS TYPE RKE2_VV130,  "Difference Unadjusted COGS
          DIFF_WARCOS TYPE RKE2_VV710,  "Difference Warranty Cost & Prov
          DIFF_GWCOS  TYPE HSLXX_PCA,  "Difference Goodwill Cost
          TOTAL_2A    TYPE RKE2_VV130,                      "2A Total
          TOTAL_2OP   TYPE RKE2_VV130,                      "2OP total
          TOTAL_DIFF  TYPE RKE2_VV130,  "Difference total
       END OF GTY_RESULT,

       BEGIN OF GTY_2A_DETAIL,
          CAT(4) TYPE C,
          KSTAR TYPE KSTAR,
          BEMOT TYPE BEMOT,
          AMOUNT TYPE RKE2_VV710,
       END OF GTY_2A_DETAIL,

       GTTY_2A_DETAIL TYPE STANDARD TABLE OF GTY_2A_DETAIL,


       BEGIN OF GTY_2OP_DETAIL,
         CAT(4) TYPE C,
         RACCT TYPE RACCT,
         RFAREA TYPE FKBER,
         AMOUNT TYPE HSLXX_PCA,
       END OF GTY_2OP_DETAIL,


       GTTY_2OP_DETAIL TYPE STANDARD TABLE OF GTY_2OP_DETAIL WITH KEY CAT RFAREA RACCT,

       BEGIN OF GTY_GLPCA,
         AUFNR TYPE AUFNR,
         HSL TYPE VLCUR_PCA,
       END OF GTY_GLPCA,

       GTTY_GLPCA TYPE STANDARD TABLE OF GTY_GLPCA WITH KEY AUFNR.


DATA: GS_RESULT TYPE GTY_RESULT,
      GT_2A_DETAIL TYPE GTTY_2A_DETAIL,
      GS_2A_DETAIL TYPE GTY_2A_DETAIL,
      GT_2OP_DETAIL TYPE GTTY_2OP_DETAIL,
      GS_2OP_DETAIL TYPE GTY_2OP_DETAIL,
      GT_GLPCA TYPE GTTY_GLPCA.


DATA: GT_Z2A TYPE STANDARD TABLE OF TKCHW.

FIELD-SYMBOLS: <FS_Z2A> TYPE TKCHW.

DATA: LV_TMP TYPE RKE2_VV130,
        LV_2OP_VALUE(6) TYPE C,
        LV_BEMOT TYPE BEMOT,
        LV_KSTAR TYPE KSTAR,
        LV_RACCT TYPE RACCT,
        LV_ACTIV TYPE ACTI1,
        LV_RFAREA TYPE FKBER,
        LV_APP_VAL TYPE RKE2_VV130,
        LV_KSTAR_TOTAL TYPE RKE2_VV130,
        LV_BEMOT_TOTAL TYPE RKE2_VV130,
        LV_RACCT_TOTAL TYPE RKE2_VV130.

DATA : BEGIN OF IT_SDI_WIP OCCURS 0,
        RBUKRS LIKE GLPCA-RBUKRS,
        ZUONR LIKE BSIS-ZUONR,
        REFDOCNR LIKE GLPCA-REFDOCNR,
        DMBTR LIKE BSIS-DMBTR,
        HSL LIKE GLPCA-HSL,
        DIFF LIKE BSIS-DMBTR,
        SELECTED,
END OF IT_SDI_WIP .

FIELD-SYMBOLS: <FS_SDI_WIP> LIKE LINE OF IT_SDI_WIP.

FIELD-SYMBOLS: <FS_GLPCA> TYPE GTY_GLPCA.

DATA: G_RACCT        TYPE GLPCA-RACCT,
      G_RHOART       TYPE GLPCA-RHOART,
      G_RSCOPE       TYPE SCOPE_CV,
      G_HKONT        TYPE BSIS-HKONT,
      G_OFF          TYPE I,
      G_LEN1         TYPE I,
      G_OFF2         TYPE I,
      G_LEN2         TYPE I,
      G_ORDER        TYPE DZUONR,
      G_LINE         TYPE DZUONR,
      G_DMBTR        TYPE BSIS-DMBTR,
      G_HSL          TYPE GLPCA-HSL,
      G_DIFF         TYPE BSIS-DMBTR,
      G_REFDOCNR     TYPE GLPCA-REFDOCNR.

DATA: GV_CE_TIMESTAMP_FROM TYPE RKE_HZSTMP.

CONSTANTS:
      GC_CE_TIMESTAMP_TO TYPE RKE_HZSTMP VALUE '9999999999999'.


INCLUDE YSE_2A_2OP_RECON_SEL.
