*----------------------------------------------------------------------*
***INCLUDE YSE_CS_OPR_WORKSHOP_RPT_PBO01 .
*----------------------------------------------------------------------*
*&---------------------------------------------------------------------*
*&      Module  STATUS_0100  OUTPUT
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
MODULE STATUS_0100 OUTPUT.
  SET PF-STATUS '100'.
  SET TITLEBAR '100'.

ENDMODULE.                 " STATUS_0100  OUTPUT
*&---------------------------------------------------------------------*
*&      Module  create_control  OUTPUT
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
MODULE CREATE_CONTROL OUTPUT.
  IF MY_CONTAINER IS INITIAL.
*create the container
    CREATE OBJECT MY_CONTAINER
      EXPORTING
          REPID           =  SY-REPID
          DYNNR           =  SY-DYNNR
          LIFETIME        =  CNTL_LIFETIME_DYNPRO
*          ratio           =  90.
          EXTENSION       =  5000.

*create the ALV control
    CREATE OBJECT MY_ALV
      EXPORTING
        I_PARENT = MY_CONTAINER.
*Set parameters regarding layout, etc.
    LS_VARIANT-REPORT = SY-CPROG.
    LS_LAYOUT-NO_TOOLBAR = ' '.
    LS_LAYOUT-ZEBRA = 'X'.
*create the fieldcatalog e.g. which fields to display
    PERFORM CREATE_FIELDCAT.
*Set sort parameters
*    perform set_sort_parm.

*     display the data in the ALV control
    MY_ALV->SET_TABLE_FOR_FIRST_DISPLAY(
                EXPORTING
                    I_SAVE        =  'A'
                    IS_VARIANT    =  LS_VARIANT
                    IS_LAYOUT     =  LS_LAYOUT
                CHANGING
                    IT_OUTTAB         =  IT_OUT[]
                    IT_FIELDCATALOG   =  LT_FIELDCAT
                    IT_SORT           =  LT_SORT
                     ).

  ENDIF.

ENDMODULE.                 " create_control  OUTPUT
*&---------------------------------------------------------------------*
*&      Form  create_fieldcat
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM CREATE_FIELDCAT.
  REFRESH LT_FIELDCAT.

  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'AUART'.
  LS_FIELDCAT-OUTPUTLEN = 6.
  LS_FIELDCAT-COLTEXT = 'Order type'(010).
  LS_FIELDCAT-FIX_COLUMN = 'X'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.

  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'VBELN'.
  LS_FIELDCAT-OUTPUTLEN = 10.
  LS_FIELDCAT-COLTEXT = 'Document num'(011).
  LS_FIELDCAT-FIX_COLUMN = 'X'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.

  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'POSNR'.
  LS_FIELDCAT-OUTPUTLEN = 8.
  LS_FIELDCAT-COLTEXT = 'Document item'(012).
  LS_FIELDCAT-FIX_COLUMN = 'X'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.

  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'VKORG'.
  LS_FIELDCAT-OUTPUTLEN = 6.
  LS_FIELDCAT-COLTEXT = 'Sales org.'(013).
  LS_FIELDCAT-FIX_COLUMN = 'X'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.

  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'VTWEG'.
  LS_FIELDCAT-OUTPUTLEN = 6.
  LS_FIELDCAT-COLTEXT = 'Dist. channel'(014).
  LS_FIELDCAT-FIX_COLUMN = 'X'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.

  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'VSBED'.
  LS_FIELDCAT-OUTPUTLEN = 6.
  LS_FIELDCAT-COLTEXT = 'ShipCond'(040).
  LS_FIELDCAT-FIX_COLUMN = 'X'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.

  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'WERKS'.
  LS_FIELDCAT-OUTPUTLEN = 6.
  LS_FIELDCAT-COLTEXT = 'Plant'(015).
  LS_FIELDCAT-FIX_COLUMN = 'X'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.

  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'WHTYPE'.
  LS_FIELDCAT-OUTPUTLEN = 4.
  LS_FIELDCAT-COLTEXT = 'Warehouse type'(032).
  LS_FIELDCAT-FIX_COLUMN = 'X'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.

  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'MATKL'.
  LS_FIELDCAT-OUTPUTLEN = 10.
  LS_FIELDCAT-COLTEXT = 'Material group'(016).
  LS_FIELDCAT-FIX_COLUMN = 'X'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.

  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'MATNR'.
  LS_FIELDCAT-OUTPUTLEN = 18.
  LS_FIELDCAT-COLTEXT = 'Material Number'(017).
  LS_FIELDCAT-FIX_COLUMN = 'X'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.

  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'PRODH'.
  LS_FIELDCAT-OUTPUTLEN = 20.
  LS_FIELDCAT-COLTEXT = 'PGC'(018).
  LS_FIELDCAT-FIX_COLUMN = 'X'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.

  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'LGORT'.
  LS_FIELDCAT-OUTPUTLEN = 10.
  LS_FIELDCAT-COLTEXT = 'Storage Location'(033).
  LS_FIELDCAT-FIX_COLUMN = 'X'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.

  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'STOCKPOL'.
  LS_FIELDCAT-OUTPUTLEN = 13.
  LS_FIELDCAT-COLTEXT = 'Stock policy'(019).
  LS_FIELDCAT-FIX_COLUMN = 'X'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.

  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'DISTRI_MODE'.
  LS_FIELDCAT-OUTPUTLEN = 13.
  LS_FIELDCAT-COLTEXT = 'Distribution mode'(020).
  LS_FIELDCAT-FIX_COLUMN = 'X'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.

  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'LIFNR'.
  LS_FIELDCAT-OUTPUTLEN = 13.
  LS_FIELDCAT-COLTEXT = 'Vendor'(022).
  LS_FIELDCAT-FIX_COLUMN = 'X'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.

  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'DTC_SFS'.
  LS_FIELDCAT-OUTPUTLEN = 13.
  LS_FIELDCAT-COLTEXT = 'DTC / SFS'(023).
  LS_FIELDCAT-FIX_COLUMN = 'X'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.


  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'EDATU'.
  LS_FIELDCAT-OUTPUTLEN = 13.
  LS_FIELDCAT-COLTEXT = 'Requested delivery date'(025).
  LS_FIELDCAT-FIX_COLUMN = 'X'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.

  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'WMENG'.
  LS_FIELDCAT-OUTPUTLEN = 13.
  LS_FIELDCAT-COLTEXT = 'Requested Qty'(026).
  LS_FIELDCAT-FIX_COLUMN = 'X'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.

  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'COUNTER'.
  LS_FIELDCAT-OUTPUTLEN = 13.
  LS_FIELDCAT-COLTEXT = 'Counter'(027).
  LS_FIELDCAT-FIX_COLUMN = 'X'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.

  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'BLOCK'.
  LS_FIELDCAT-OUTPUTLEN = 17.
  LS_FIELDCAT-COLTEXT = 'Document blocked'(028).
  LS_FIELDCAT-FIX_COLUMN = 'X'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.

  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'STPRS'.
  LS_FIELDCAT-OUTPUTLEN = 13.
  LS_FIELDCAT-COLTEXT = 'Standard cost'(031).
  LS_FIELDCAT-FIX_COLUMN = 'X'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.

  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'KUNNR'.
  LS_FIELDCAT-OUTPUTLEN = 10.
  LS_FIELDCAT-COLTEXT = 'Sold To'(034).
  LS_FIELDCAT-FIX_COLUMN = 'X'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.

  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'NAME1'.
  LS_FIELDCAT-OUTPUTLEN = 15.
  LS_FIELDCAT-COLTEXT = 'Sold To'(034).
  LS_FIELDCAT-FIX_COLUMN = 'X'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.

  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'VKBUR'.
  LS_FIELDCAT-OUTPUTLEN = 18.
  LS_FIELDCAT-COLTEXT = 'Sales Office'(035).
  LS_FIELDCAT-FIX_COLUMN = 'X'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.

  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'VKGRP'.
  LS_FIELDCAT-OUTPUTLEN = 18.
  LS_FIELDCAT-COLTEXT = 'Sales Group'(036).
  LS_FIELDCAT-FIX_COLUMN = 'X'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.

  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'BZTXT'.
  LS_FIELDCAT-OUTPUTLEN = 20.
  LS_FIELDCAT-COLTEXT = 'Sales District'(037).
  LS_FIELDCAT-FIX_COLUMN = 'X'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.

  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'LFIMG'.
  LS_FIELDCAT-OUTPUTLEN = 20.
  LS_FIELDCAT-COLTEXT = 'Act. quan. del.'(038).
  LS_FIELDCAT-FIX_COLUMN = 'X'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.

  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'LABST'.
  LS_FIELDCAT-OUTPUTLEN = 20.
  LS_FIELDCAT-COLTEXT = 'UU Stock'(039).
  LS_FIELDCAT-FIX_COLUMN = 'X'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.

  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'ALLOC'.
  LS_FIELDCAT-OUTPUTLEN = 20.
  LS_FIELDCAT-COLTEXT = 'All. stock'(041).
  LS_FIELDCAT-FIX_COLUMN = 'X'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.

  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'AVAIL'.
  LS_FIELDCAT-OUTPUTLEN = 20.
  LS_FIELDCAT-COLTEXT = 'Avai. stock'(042).
  LS_FIELDCAT-FIX_COLUMN = 'X'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.

  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'OPEN_PO'.
  LS_FIELDCAT-OUTPUTLEN = 20.
  LS_FIELDCAT-COLTEXT = 'Open PO'(043).
  LS_FIELDCAT-FIX_COLUMN = 'X'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.

*** Begin Mod-002 - Add "Customer Group 4" VBAK-KVGR4
  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'KVGR4'.
  LS_FIELDCAT-OUTPUTLEN = 16.
  LS_FIELDCAT-COLTEXT = 'CustGrp 4'(044).
  LS_FIELDCAT-FIX_COLUMN = 'X'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.
*** End Mod-002

*** Begin Mod-003 - Add "Created by" VBAK-ERNAM
  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'ERNAM'.
  LS_FIELDCAT-OUTPUTLEN = 16.
  LS_FIELDCAT-COLTEXT = 'SO Created by'(045).
  LS_FIELDCAT-FIX_COLUMN = 'X'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.
*** End Mod-002

* Begin of insert Mod-005
  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'PSTYV'.
  LS_FIELDCAT-OUTPUTLEN = 5.
  LS_FIELDCAT-COLTEXT = 'SD Item Category'(051).
  LS_FIELDCAT-FIX_COLUMN = 'X'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.
* End   of insert Mod-005

  "Mod-007 begin
  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'CMGST'.
  LS_FIELDCAT-OUTPUTLEN = 3.
  LS_FIELDCAT-COLTEXT = 'Credit block'(052).
  LS_FIELDCAT-FIX_COLUMN = 'X'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.

  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'KUNWE'.
  LS_FIELDCAT-OUTPUTLEN = 10.
  LS_FIELDCAT-COLTEXT = 'Ship to customer'(053).
  LS_FIELDCAT-FIX_COLUMN = 'X'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.

  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'AVAILABLE'.
  LS_FIELDCAT-OUTPUTLEN = 3.
  LS_FIELDCAT-COLTEXT = 'Availability'(054).
  LS_FIELDCAT-FIX_COLUMN = 'X'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.
  "Mod-007 end
ENDFORM.                    " create_fieldcat
