*----------------------------------------------------------------------*
***INCLUDE YSE_CS_OPR_WORKSHOP_RPT_PBO01 .
*----------------------------------------------------------------------*
*&---------------------------------------------------------------------*
*&      Module  STATUS_0100  OUTPUT
*&---------------------------------------------------------------------*
MODULE STATUS_0100 OUTPUT.

   SET PF-STATUS '100'.
   SET TITLEBAR '100'.

ENDMODULE.                 " STATUS_0100  OUTPUT

*&---------------------------------------------------------------------*
*&      Module  CREATE_CONTROL  OUTPUT
*&---------------------------------------------------------------------*
MODULE CREATE_CONTROL OUTPUT.

  IF MY_CONTAINER IS INITIAL.
*   Create the container
    CREATE OBJECT MY_CONTAINER
      EXPORTING
          REPID           =  SY-REPID
          DYNNR           =  SY-DYNNR
          LIFETIME        =  CNTL_LIFETIME_DYNPRO
*          RATIO           =  90.
          EXTENSION       =  5000.

*   Create the ALV control
    CREATE OBJECT MY_ALV
      EXPORTING
          I_PARENT  =  MY_CONTAINER.

*   Set parameters regarding layout, etc.
    LS_VARIANT-REPORT = SY-CPROG.
    LS_LAYOUT-NO_TOOLBAR = ' '.
    LS_LAYOUT-ZEBRA = 'X'.
*   Create the fieldcatalog e.g. which fields to display
    PERFORM CREATE_FIELDCAT.

*   Display the data in the ALV control
    MY_ALV->SET_TABLE_FOR_FIRST_DISPLAY(
                EXPORTING
                    I_SAVE        =  'A'
                    IS_VARIANT    =  LS_VARIANT
                    IS_LAYOUT     =  LS_LAYOUT
                CHANGING
                    IT_OUTTAB         =  IT_OUT[]
                    IT_FIELDCATALOG   =  LT_FIELDCAT
                    IT_SORT           =  LT_SORT
                     ).

   ENDIF.

ENDMODULE.                 " CREATE_CONTROL  OUTPUT

*&---------------------------------------------------------------------*
*&      Form  CREATE_FIELDCAT
*&---------------------------------------------------------------------*
FORM CREATE_FIELDCAT.

  REFRESH LT_FIELDCAT.

  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'AUART'.
  LS_FIELDCAT-OUTPUTLEN = 6.
  LS_FIELDCAT-COLTEXT = 'Order type'(010).
  LS_FIELDCAT-FIX_COLUMN = 'X'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.

  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'VBELN'.
  LS_FIELDCAT-OUTPUTLEN = 10.
  LS_FIELDCAT-COLTEXT = 'Document num'(011).
  LS_FIELDCAT-FIX_COLUMN = 'X'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.

  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'POSNR'.
  LS_FIELDCAT-OUTPUTLEN = 8.
  LS_FIELDCAT-COLTEXT = 'Document item'(012).
  LS_FIELDCAT-FIX_COLUMN = 'X'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.

  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'VKORG'.
  LS_FIELDCAT-OUTPUTLEN = 6.
  LS_FIELDCAT-COLTEXT = 'Sales org.'(013).
  LS_FIELDCAT-FIX_COLUMN = 'X'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.

  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'VTWEG'.
  LS_FIELDCAT-OUTPUTLEN = 6.
  LS_FIELDCAT-COLTEXT = 'Dist. channel'(014).
  LS_FIELDCAT-FIX_COLUMN = 'X'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.

  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'VSBED'.
  LS_FIELDCAT-OUTPUTLEN = 6.
  LS_FIELDCAT-COLTEXT = 'ShipCond'(040).
  LS_FIELDCAT-FIX_COLUMN = 'X'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.

  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'WERKS'.
  LS_FIELDCAT-OUTPUTLEN = 6.
  LS_FIELDCAT-COLTEXT = 'Plant'(015).
  LS_FIELDCAT-FIX_COLUMN = 'X'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.

  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'LGORT'.
  LS_FIELDCAT-OUTPUTLEN = 4.
  LS_FIELDCAT-COLTEXT = 'StLoc'(037).
  APPEND LS_FIELDCAT TO LT_FIELDCAT.

  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'PSTYV'.
  LS_FIELDCAT-OUTPUTLEN = 13.
  LS_FIELDCAT-COLTEXT = 'Item category'(033).
  LS_FIELDCAT-FIX_COLUMN = 'X'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.

  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'WHTYPE'.
  LS_FIELDCAT-OUTPUTLEN = 4.
  LS_FIELDCAT-COLTEXT = 'Warehouse type'(036).
  LS_FIELDCAT-FIX_COLUMN = 'X'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.

  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'MATKL'.
  LS_FIELDCAT-OUTPUTLEN = 10.
  LS_FIELDCAT-COLTEXT = 'Material group'(016).
  LS_FIELDCAT-FIX_COLUMN = 'X'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.

  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'MATNR'.
  LS_FIELDCAT-OUTPUTLEN = 18.
  LS_FIELDCAT-COLTEXT = 'Material Number'(017).
  LS_FIELDCAT-FIX_COLUMN = 'X'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.

  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'PRODH'.
  LS_FIELDCAT-OUTPUTLEN = 20.
  LS_FIELDCAT-COLTEXT = 'PGC'(018).
  LS_FIELDCAT-FIX_COLUMN = 'X'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.

  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'STOCKPOL'.
  LS_FIELDCAT-OUTPUTLEN = 13.
  LS_FIELDCAT-COLTEXT = 'Stock policy'(019).
  LS_FIELDCAT-FIX_COLUMN = 'X'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.

  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'DISTRI_MODE'.
  LS_FIELDCAT-OUTPUTLEN = 13.
  LS_FIELDCAT-COLTEXT = 'Distribution mode'(020).
  LS_FIELDCAT-FIX_COLUMN = 'X'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.

  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'LIFNR'.
  LS_FIELDCAT-OUTPUTLEN = 13.
  LS_FIELDCAT-COLTEXT = 'Vendor'(022).
  LS_FIELDCAT-FIX_COLUMN = 'X'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.

  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'DTC_SFS'.
  LS_FIELDCAT-OUTPUTLEN = 13.
  LS_FIELDCAT-COLTEXT = 'DTC / SFS'(023).
  LS_FIELDCAT-FIX_COLUMN = 'X'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.

  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'CMFRE'.
  LS_FIELDCAT-OUTPUTLEN = 13.
  LS_FIELDCAT-COLTEXT = 'Credit release date'(034).
  LS_FIELDCAT-FIX_COLUMN = 'X'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.

  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'DMFRE'.
  LS_FIELDCAT-OUTPUTLEN = 13.
  LS_FIELDCAT-COLTEXT = 'Delivery release date'(038).
  LS_FIELDCAT-FIX_COLUMN = 'X'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.

  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'EDATU'.
  LS_FIELDCAT-OUTPUTLEN = 13.
  LS_FIELDCAT-COLTEXT = 'Requested delivery date'(025).
  LS_FIELDCAT-FIX_COLUMN = 'X'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.

  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'WMENG'.
  LS_FIELDCAT-OUTPUTLEN = 13.
  LS_FIELDCAT-COLTEXT = 'Requested Qty'(026).
  LS_FIELDCAT-FIX_COLUMN = 'X'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.

  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'LAST_ISSUE'.
  LS_FIELDCAT-OUTPUTLEN = 13.
  LS_FIELDCAT-COLTEXT = 'Last issue date'(039).
  LS_FIELDCAT-FIX_COLUMN = 'X'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.

  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'FULLY_DEL'.
  LS_FIELDCAT-OUTPUTLEN = 13.
  LS_FIELDCAT-COLTEXT = 'Fully delivered at requested date'(035).
  LS_FIELDCAT-FIX_COLUMN = 'X'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.

  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'BLOCK'.
  LS_FIELDCAT-OUTPUTLEN = 17.
  LS_FIELDCAT-COLTEXT = 'Document blocked'(028).
  LS_FIELDCAT-FIX_COLUMN = 'X'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.

  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'BZIRK'.
  LS_FIELDCAT-OUTPUTLEN = 17.
  LS_FIELDCAT-COLTEXT = 'Sales District'(029).
  LS_FIELDCAT-FIX_COLUMN = 'X'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.

* Begin of Mod-0003 - Satya 14/08/2009
  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'KUNNR'.
  LS_FIELDCAT-OUTPUTLEN = 16.
  LS_FIELDCAT-COLTEXT = 'Sold-to party'(043).
  LS_FIELDCAT-FIX_COLUMN = 'X'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.

* Begin of MOD-003 Lakshmi 12/10/2010
  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'ERDAT'.
  LS_FIELDCAT-OUTPUTLEN = 16.
  LS_FIELDCAT-COLTEXT = 'Order Creation Date'(045).
  LS_FIELDCAT-FIX_COLUMN = 'X'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.
* End of MOD-003 Lakshmi 12/10/2010

  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'BSARK'.
  LS_FIELDCAT-OUTPUTLEN = 16.
  LS_FIELDCAT-COLTEXT = 'Customer PO type'(044).
  LS_FIELDCAT-FIX_COLUMN = 'X'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.
* End of Mod-0003 - Satya 14/08/2009

ENDFORM.                    " CREATE_FIELDCAT
